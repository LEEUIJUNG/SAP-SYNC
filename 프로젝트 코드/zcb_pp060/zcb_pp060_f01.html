<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=utf-8" />
<title>ZCB_PP060_F01</title>
<style type="text/css">
.code{ font-family:"Courier New", Courier, monospace; color:#000; font-size:14px; background-color:#F2F4F7 }
  .codeComment {font-family:"Courier New", Courier, monospace; color:#0000F0; font-size:14px; background-color:#F2F4F7 }
  .normalBold{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; font-weight:800 }
  .normalBoldLarge{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }
</style>
<style type="text/css">
  .normal{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px }
  .footer{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; text-align: center }
  h2{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }
  h3{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:14px; font-weight:800 }
  .outerTable{
   background-color:#E0E7ED;
   width:100%;
   border-top-width: thin;
   border-right-width: thin;
   border-right-width: thin;
   border-left-width: thin;
   border-top-style: solid;
   border-right-style: solid;
   border-bottom-style: solid;
   border-left-style: solid;
  }
  .innerTable{
   background-color:#F2F4F7;
   width:100%;
   border-top-width: thin;
   border-right-width: thin;
   border-bottom-width: thin;
   border-left-width: thin;
   border-top-style: solid;
   border-right-style: solid;
   border-bottom-style: solid;
   border-left-style: solid;
  }
</style>
</head>
<body>
<table class="outerTable">
  <tr class="normalBoldLarge">
     <td><h2>Code listing for: ZCB_PP060_F01</h2>
<h3> Description: SUB</h3></td>
   </tr>
  <tr>
     <td>
     <table class="innerTable">
       <tr>
          <td>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Include&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZCB_PP060_F01<br />
*&---------------------------------------------------------------------*<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;display_0100<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;SCR&nbsp;0100&nbsp;을&nbsp;호출한다.<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM display_0100 .<br />
&nbsp;&nbsp;CALL&nbsp;SCREEN&nbsp;0100.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;get_init_data<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;PLAF(생산계획),&nbsp;MARC(플랜트별&nbsp;자재&nbsp;정책),&nbsp;MARD(플랜트별&nbsp;자재&nbsp;현황)<br />
*&&nbsp;MRP를&nbsp;수행하기&nbsp;위한&nbsp;기준&nbsp;정보들을&nbsp;초기에&nbsp;읽어온다.<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM get_init_data .<br />
&nbsp;&nbsp;"&nbsp;MRP&nbsp;실행전&nbsp;빨간불<br />
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'ICON_CREATE'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;&nbsp;&nbsp;=&nbsp;'ICON_LED_RED'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Icon&nbsp;name&nbsp;&nbsp;(Name&nbsp;from&nbsp;INCLUDE&nbsp;&lt;ICON&gt;&nbsp;)<br />
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;=&nbsp;gv_mrp_on.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Icon&nbsp;(enter&nbsp;the&nbsp;screen&nbsp;field&nbsp;here)<br />
<br />
&nbsp;&nbsp;"&nbsp;PLAF(생산계획),&nbsp;년도&nbsp;주차&nbsp;순으로&nbsp;정렬.<br />
&nbsp;&nbsp;REFRESH:&nbsp;gt_plaf_leaf.<br />
<br />
&nbsp;&nbsp;SELECT<br />
&nbsp;&nbsp;&nbsp;&nbsp;a~plwrk,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;계획&nbsp;플랜트<br />
&nbsp;&nbsp;&nbsp;&nbsp;a~plnum,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;생산계획&nbsp;아이디<br />
&nbsp;&nbsp;&nbsp;&nbsp;a~pyear,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;계획년도<br />
&nbsp;&nbsp;&nbsp;&nbsp;a~pyeek,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;계획주차<br />
&nbsp;&nbsp;&nbsp;&nbsp;a~plmat,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;계획자재<br />
&nbsp;&nbsp;&nbsp;&nbsp;a~gsmng,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;계획수량<br />
&nbsp;&nbsp;&nbsp;&nbsp;a~meins,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;계획&nbsp;단위<br />
&nbsp;&nbsp;&nbsp;&nbsp;a~approval,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;승인&nbsp;여부<br />
&nbsp;&nbsp;&nbsp;&nbsp;b~maktx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;자재명<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;@gt_plaf_leaf<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;zcb_plaf&nbsp;AS&nbsp;a<br />
&nbsp;&nbsp;&nbsp;&nbsp;LEFT&nbsp;JOIN&nbsp;zcb_makt&nbsp;AS&nbsp;b<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;a~plmat&nbsp;=&nbsp;b~matnr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;b~spras&nbsp;=&nbsp;@sy-langu<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;a~gsmng&nbsp;&gt;&nbsp;0.<br />
<br />
<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;REFRESH:&nbsp;gt_plaf_leaf.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;e400(zcb_msg)&nbsp;WITH&nbsp;'PLAF'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;RETURN.<br />
&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SORT&nbsp;gt_plaf_leaf&nbsp;BY&nbsp;pyear&nbsp;pyeek.<br />
<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
&nbsp;&nbsp;"&nbsp;MARC(플랜트별&nbsp;자재&nbsp;정책)<br />
&nbsp;&nbsp;REFRESH:&nbsp;gt_marc.<br />
<br />
&nbsp;&nbsp;SELECT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matnr,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;자재&nbsp;아이디<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;werks,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;플랜트&nbsp;아이디<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;beskz,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;조달&nbsp;유형<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dismm,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;MRP&nbsp;유형<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgpro,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;저장위치&nbsp;아이디<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgfsb&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;외부&nbsp;조달시&nbsp;기본&nbsp;저장&nbsp;위치<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;zcb_marc<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;@gt_marc.<br />
<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;REFRESH:&nbsp;gt_marc.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;e400(zcb_msg)&nbsp;WITH&nbsp;'MARC'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;RETURN.<br />
&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SORT&nbsp;gt_marc&nbsp;BY&nbsp;matnr.<br />
<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;"&nbsp;MARD(플랜트별&nbsp;자재&nbsp;현황)<br />
&nbsp;&nbsp;REFRESH:&nbsp;gt_mard.<br />
<br />
&nbsp;&nbsp;SELECT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matnr,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;자재번호<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;werks,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;플랜트&nbsp;아이디<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgort,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;저장위치&nbsp;아이디<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;labst&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;재고&nbsp;수량<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;zcb_mard<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;@gt_mard.<br />
<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;REFRESH:&nbsp;gt_mard.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;e400(zcb_msg)&nbsp;WITH&nbsp;'MARD'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;RETURN.<br />
&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SORT&nbsp;gt_mard&nbsp;BY&nbsp;matnr.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;"&nbsp;MESSAGE&nbsp;'get_init_data&nbsp;실행&nbsp;성공'&nbsp;TYPE&nbsp;'S'.<br />
<br />
ENDFORM.<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;set_alv_0100<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;ALV&nbsp;GRID&nbsp;동적으로&nbsp;생성<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM set_alv_gird_0100 USING p_structure TYPE dd02l-tabname<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ps_variant&nbsp;TYPE&nbsp;disvariant<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p_save&nbsp;TYPE&nbsp;c<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ps_layo&nbsp;TYPE&nbsp;&nbsp;&nbsp;lvc_s_layo<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p_ccon&nbsp;&nbsp;TYPE&nbsp;scrfname<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;ct_outtab&nbsp;TYPE&nbsp;ANY&nbsp;TABLE<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ct_fieldcat&nbsp;TYPE&nbsp;lvc_t_fcat<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ct_filter&nbsp;&nbsp;TYPE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lvc_t_filt<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ct_sort&nbsp;&nbsp;&nbsp;TYPE&nbsp;lvc_t_sort<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;co_container&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;cl_gui_custom_container<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;co_alv_grid&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;&nbsp;cl_gui_alv_grid.<br />
&nbsp;&nbsp;call&nbsp;function&nbsp;<a&nbsp;href&nbsp;="zcb_pp_alv_create/zcb_pp_alv_create.html">'ZCB_PP_ALV_CREATE'</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iv_structure&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;p_structure<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is_variant&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ps_variant<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iv_save&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;p_save<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is_layout&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ps_layo<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iv_ccon&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;p_ccon<br />
&nbsp;&nbsp;&nbsp;&nbsp;CHANGING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ct_outtab&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ct_outtab<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ct_fieldcat&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ct_fieldcat<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ct_filter&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ct_filter<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ct_sort&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ct_sort<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;co_container&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;co_container<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;co_alv_grid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;co_alv_grid<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_grid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;program_error&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;invalid_parameter_combination&nbsp;=&nbsp;3<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;too_many_lines&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;4<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_container&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;5<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_alv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;6<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;7.<br />
<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;ALV&nbsp;설정&nbsp;중&nbsp;Error&nbsp;가&nbsp;발생하였습니다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;e411(zcb_msg).<br />
<br />
&nbsp;&nbsp;ENDIF.<br />
ENDFORM.<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;set_alv_0100<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;ALV&nbsp;TREE&nbsp;생성<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM set_alv_tree_0100 .<br />
   </div>
   <div class="codeComment">
*&nbsp;alv&nbsp;tree&nbsp;가&nbsp;생성되어&nbsp;있지&nbsp;않으면.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;IF&nbsp;go_alv_grid_tree&nbsp;IS&nbsp;INITIAL.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;DATA:&nbsp;lt_node_table&nbsp;TYPE&nbsp;gty_node_table,&nbsp;"트리&nbsp;값들&nbsp;관계&nbsp;넣어주기위해<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;events&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;cntl_simple_events,&nbsp;"더블클릭&nbsp;이벤트<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;event&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;cntl_simple_event.&nbsp;&nbsp;&nbsp;&nbsp;"더블클릭&nbsp;이벤트<br />
<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;tree&nbsp;를&nbsp;위한&nbsp;ccon&nbsp;obj&nbsp;생성<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;go_container_tree<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;container_name&nbsp;=&nbsp;'CCON_TREE'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Name&nbsp;of&nbsp;the&nbsp;Screen&nbsp;CustCtrl&nbsp;Name&nbsp;to&nbsp;Link&nbsp;Container&nbsp;To<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Tree&nbsp;Container&nbsp;설정에&nbsp;실패했습니다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;e396(zcb_msg).<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;alv&nbsp;tree&nbsp;obj&nbsp;생성<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;go_alv_grid_tree<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parent&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;go_container_tree&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Parent&nbsp;Container<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node_selection_mode&nbsp;=&nbsp;cl_gui_simple_tree=&gt;node_sel_mode_single.&nbsp;"싱글선택<br />
&nbsp;&nbsp;&nbsp;&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Alv&nbsp;Tree&nbsp;설정에&nbsp;실패했습니다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;e397(zcb_msg).<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
   </div>
   <div class="codeComment">
*노드&nbsp;생성<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;build_node_table&nbsp;USING&nbsp;lt_node_table.&nbsp;"트리에&nbsp;데이터&nbsp;넣어줌<br />
<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="codeComment">
*트리&nbsp;노드&nbsp;추가<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;go_alv_grid_tree-&gt;add_nodes<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;table_structure_name&nbsp;=&nbsp;'MTREESNODE'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node_table&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lt_node_table.&nbsp;"트리&nbsp;데이터&nbsp;들어가있는&nbsp;int<br />
<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Alv&nbsp;Tree&nbsp;설정에&nbsp;실패했습니다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;e397(zcb_msg).<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="codeComment">
*이벤트<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;gc_application..<br />
<br />
&nbsp;&nbsp;event-eventid&nbsp;=&nbsp;cl_gui_simple_tree=&gt;eventid_node_double_click.<br />
&nbsp;&nbsp;event-appl_event&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;event&nbsp;TO&nbsp;events.<br />
<br />
   </div>
   <div class="codeComment">
*트리&nbsp;이벤트&nbsp;등록<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;go_alv_grid_tree-&gt;set_registered_events<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;events&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;events<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cntl_error&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cntl_system_error&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;illegal_event_combination&nbsp;=&nbsp;3.<br />
<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Alv&nbsp;Tree&nbsp;설정에&nbsp;실패했습니다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;e397(zcb_msg).<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="codeComment">
*이벤트&nbsp;핸들러<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;gc_application-&gt;handle_node_double_click&nbsp;FOR&nbsp;go_alv_grid_tree.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;build_node_table<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;ALV&nbsp;TREE&nbsp;에&nbsp;넣을&nbsp;TAB&nbsp;만들기<br />
*&&nbsp;년도,&nbsp;월&nbsp;,주차&nbsp;구분<br />
*&&nbsp;주차에&nbsp;신호등&nbsp;아이콘&nbsp;넣기<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM build_node_table  USING node_table TYPE gty_node_table.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;중복&nbsp;제거된&nbsp;구조&nbsp;타입&nbsp;따로&nbsp;만들기<br />
   </div>
   <div class="code">
&nbsp;&nbsp;TYPES:&nbsp;BEGIN&nbsp;OF&nbsp;ty_node_key,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pyear&nbsp;TYPE&nbsp;zcb_pyear,&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;생산계획&nbsp;년도<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pyeek&nbsp;TYPE&nbsp;zcb_pyeek,&nbsp;&nbsp;&nbsp;"&nbsp;생산계획&nbsp;주차<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pdate&nbsp;TYPE&nbsp;scal-date,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;생산계획일자<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;ty_node_key.<br />
<br />
&nbsp;&nbsp;TYPES:&nbsp;ty_node_key_tab&nbsp;TYPE&nbsp;SORTED&nbsp;TABLE&nbsp;OF&nbsp;ty_node_key&nbsp;WITH&nbsp;UNIQUE&nbsp;KEY&nbsp;pyear&nbsp;pyeek.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;중복&nbsp;제거된&nbsp;키&nbsp;수집<br />
   </div>
   <div class="code">
&nbsp;&nbsp;DATA:&nbsp;lt_node_keys&nbsp;TYPE&nbsp;ty_node_key_tab,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_node_key&nbsp;&nbsp;TYPE&nbsp;ty_node_key.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;노드&nbsp;생성용&nbsp;변수<br />
   </div>
   <div class="code">
&nbsp;&nbsp;DATA:&nbsp;node&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;mtreesnode,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_key&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;char50,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_year_key&nbsp;TYPE&nbsp;char50.<br />
<br />
   </div>
   <div class="codeComment">
*--------<br />
*&nbsp;#오늘&nbsp;날짜&nbsp;기준&nbsp;주차&nbsp;계산<br />
   </div>
   <div class="code">
&nbsp;&nbsp;DATA:&nbsp;lv_date&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;sy-datum,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_week&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;scal-week,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_curr_year&nbsp;TYPE&nbsp;zcb_pyear,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_curr_week&nbsp;TYPE&nbsp;zcb_pyeek.<br />
<br />
&nbsp;&nbsp;lv_date&nbsp;=&nbsp;sy-datum.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'DATE_GET_WEEK'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;date&nbsp;=&nbsp;lv_date<br />
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;week&nbsp;=&nbsp;lv_week.<br />
<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;날짜&nbsp;기준&nbsp;주차를&nbsp;가져오는데&nbsp;실패했습니다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;i414(zcb_msg)&nbsp;DISPLAY&nbsp;LIKE&nbsp;'W'.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;lv_curr_year&nbsp;=&nbsp;lv_week(4).&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;앞&nbsp;4자리&nbsp;연도<br />
&nbsp;&nbsp;lv_curr_week&nbsp;=&nbsp;lv_week+4(2).&nbsp;&nbsp;"&nbsp;뒤&nbsp;2자리&nbsp;주차<br />
   </div>
   <div class="codeComment">
*--------<br />
<br />
*&nbsp;중복&nbsp;제거된&nbsp;연도&nbsp;+&nbsp;주차&nbsp;추출<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CLEAR:&nbsp;gs_plaf.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_plaf_leaf&nbsp;INTO&nbsp;gs_plaf.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;ls_node_key.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_node_key-pyear&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_plaf-pyear.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_node_key-pyeek&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_plaf-pyeek.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;lv_week_date&nbsp;TYPE&nbsp;scal-week.<br />
&nbsp;&nbsp;&nbsp;&nbsp;lv_week_date&nbsp;=&nbsp;|{&nbsp;gs_plaf-pyear&nbsp;}{&nbsp;gs_plaf-pyeek&nbsp;}|.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;주차&nbsp;시작(월요일)&nbsp;날짜&nbsp;구하기<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'WEEK_GET_FIRST_DAY'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;week&nbsp;=&nbsp;lv_week_date&nbsp;&nbsp;"&nbsp;202524&nbsp;이런&nbsp;주차&nbsp;형태<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;date&nbsp;=&nbsp;ls_node_key-pdate.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;날짜&nbsp;기준&nbsp;주차를&nbsp;가져오는데&nbsp;실패했습니다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;i414(zcb_msg)&nbsp;DISPLAY&nbsp;LIKE&nbsp;'W'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;INSERT&nbsp;ls_node_key&nbsp;INTO&nbsp;TABLE&nbsp;lt_node_keys.<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;ROOT&nbsp;노드&nbsp;생성<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CLEAR&nbsp;node.<br />
&nbsp;&nbsp;node-node_key&nbsp;=&nbsp;'ROOT'.<br />
&nbsp;&nbsp;node-isfolder&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;node-text&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'생산계획&nbsp;전체'.<br />
&nbsp;&nbsp;APPEND&nbsp;node&nbsp;TO&nbsp;node_table.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;트리&nbsp;계층&nbsp;생성<br />
   </div>
   <div class="code">
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;lt_node_keys&nbsp;INTO&nbsp;ls_node_key.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;연도&nbsp;노드<br />
&nbsp;&nbsp;&nbsp;&nbsp;lv_year_key&nbsp;=&nbsp;ls_node_key-pyear.<br />
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;node_table&nbsp;WITH&nbsp;KEY&nbsp;node_key&nbsp;=&nbsp;lv_year_key&nbsp;TRANSPORTING&nbsp;NO&nbsp;FIELDS.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;값이&nbsp;없으면&nbsp;최초&nbsp;입력임<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;node.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node-node_key&nbsp;&nbsp;=&nbsp;lv_year_key.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node-relatkey&nbsp;&nbsp;=&nbsp;'ROOT'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node-isfolder&nbsp;&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node-text&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;|{&nbsp;ls_node_key-pyear&nbsp;}년|.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node-expander&nbsp;&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;node&nbsp;TO&nbsp;node_table.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;주차&nbsp;노드<br />
&nbsp;&nbsp;&nbsp;&nbsp;lv_key&nbsp;=&nbsp;|{&nbsp;ls_node_key-pyear&nbsp;}_{&nbsp;ls_node_key-pyeek&nbsp;}|.<br />
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;node_table&nbsp;WITH&nbsp;KEY&nbsp;node_key&nbsp;=&nbsp;lv_key&nbsp;TRANSPORTING&nbsp;NO&nbsp;FIELDS.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;값이&nbsp;없으면&nbsp;최초&nbsp;입력임<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;node.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node-node_key&nbsp;&nbsp;=&nbsp;lv_key.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node-relatkey&nbsp;&nbsp;=&nbsp;lv_year_key.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node-isfolder&nbsp;&nbsp;=&nbsp;''.&nbsp;"&nbsp;Leaf<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node-text&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;|{&nbsp;ls_node_key-pyeek&nbsp;}주차&nbsp;:&nbsp;{&nbsp;ls_node_key-pdate&nbsp;}&nbsp;~&nbsp;|.<br />
<br />
   </div>
   <div class="codeComment">
*--------<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;신호등&nbsp;설정<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;ls_node_key-pyear&nbsp;&lt;&nbsp;lv_curr_year&nbsp;)&nbsp;OR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;ls_node_key-pyear&nbsp;=&nbsp;lv_curr_year&nbsp;AND&nbsp;ls_node_key-pyeek&nbsp;&lt;=&nbsp;lv_curr_week&nbsp;).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node-n_image&nbsp;=&nbsp;'@5B@'.&nbsp;"&nbsp;초록불&nbsp;(과거&nbsp;및&nbsp;이번주)&nbsp;-&nbsp;생성&nbsp;되어&nbsp;있음<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node-n_image&nbsp;=&nbsp;'@5C@'.&nbsp;"&nbsp;빨간불&nbsp;(다음주&nbsp;이후)&nbsp;-&nbsp;아직&nbsp;생성&nbsp;안됨<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
   </div>
   <div class="codeComment">
*--------<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;node&nbsp;TO&nbsp;node_table.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;alv_tree_double_click<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;ALV&nbsp;TREE&nbsp;더블클릭&nbsp;이밴트<br />
*&&nbsp;클릭한&nbsp;주차를&nbsp;기준으로&nbsp;MRP&nbsp;후보&nbsp;자재들을&nbsp;계산한다.<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM alv_tree_double_click  USING p_node_key TYPE lvc_nkey.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lt_parts&nbsp;TYPE&nbsp;STANDARD&nbsp;TABLE&nbsp;OF&nbsp;string&nbsp;WITH&nbsp;EMPTY&nbsp;KEY,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_year&nbsp;&nbsp;TYPE&nbsp;zcb_plaf-pyear,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_week&nbsp;&nbsp;TYPE&nbsp;zcb_plaf-pyeek.<br />
<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lv_curr_year&nbsp;TYPE&nbsp;zcb_pyear,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_curr_week&nbsp;TYPE&nbsp;zcb_pyeek,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_date&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;sy-datum,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_week_full&nbsp;TYPE&nbsp;scal-week.<br />
<br />
&nbsp;&nbsp;"&nbsp;주차&nbsp;구하기<br />
&nbsp;&nbsp;lv_date&nbsp;=&nbsp;sy-datum.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'DATE_GET_WEEK'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;date&nbsp;=&nbsp;lv_date<br />
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;week&nbsp;=&nbsp;lv_week_full.<br />
<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;날짜&nbsp;기준&nbsp;주차를&nbsp;가져오는데&nbsp;실패했습니다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;i414(zcb_msg)&nbsp;DISPLAY&nbsp;LIKE&nbsp;'W'.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;lv_curr_year&nbsp;=&nbsp;lv_week_full(4).<br />
&nbsp;&nbsp;lv_curr_week&nbsp;=&nbsp;lv_week_full+4(2).<br />
<br />
<br />
&nbsp;&nbsp;"&nbsp;노드&nbsp;키&nbsp;예:&nbsp;2025_19<br />
&nbsp;&nbsp;SPLIT&nbsp;p_node_key&nbsp;AT&nbsp;'_'&nbsp;INTO&nbsp;TABLE&nbsp;lt_parts.<br />
<br />
&nbsp;&nbsp;"&nbsp;주차&nbsp;노드가&nbsp;아닌&nbsp;경우&nbsp;종료<br />
&nbsp;&nbsp;IF&nbsp;lines(&nbsp;lt_parts&nbsp;)&nbsp;&lt;&gt;&nbsp;2.<br />
&nbsp;&nbsp;&nbsp;&nbsp;RETURN.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;lt_parts&nbsp;INDEX&nbsp;1&nbsp;INTO&nbsp;lv_year.<br />
<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;년도기준&nbsp;조회된&nbsp;값이&nbsp;없습니다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;i415(zcb_msg)&nbsp;DISPLAY&nbsp;LIKE&nbsp;'W'&nbsp;WITH&nbsp;'년도&nbsp;기준'.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;lt_parts&nbsp;INDEX&nbsp;2&nbsp;INTO&nbsp;lv_week.<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;주차&nbsp;기준&nbsp;조회된&nbsp;값이&nbsp;없습니다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;i415(zcb_msg)&nbsp;DISPLAY&nbsp;LIKE&nbsp;'W'&nbsp;WITH&nbsp;'주차&nbsp;기준'.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
&nbsp;&nbsp;"&nbsp;현재주차보다&nbsp;과거거나&nbsp;이번주면&nbsp;RETURN<br />
&nbsp;&nbsp;IF&nbsp;(&nbsp;lv_year&nbsp;&lt;&nbsp;lv_curr_year&nbsp;)&nbsp;OR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;lv_year&nbsp;=&nbsp;lv_curr_year&nbsp;AND&nbsp;lv_week&nbsp;&lt;=&nbsp;lv_curr_week&nbsp;).<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;지난&nbsp;주차는&nbsp;MRP&nbsp;를&nbsp;실행&nbsp;할&nbsp;수&nbsp;없습니다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;i415(zcb_msg)&nbsp;DISPLAY&nbsp;LIKE&nbsp;'W'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;RETURN.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
&nbsp;&nbsp;IF&nbsp;go_alv_grid_0110&nbsp;IS&nbsp;BOUND.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;모든&nbsp;화면&nbsp;초기화&nbsp;에러임으로<br />
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;clear_all.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;"&nbsp;해당&nbsp;주차에&nbsp;맞는&nbsp;데이터&nbsp;필터링<br />
&nbsp;&nbsp;REFRESH&nbsp;gt_plaf.<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_plaf.<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_plaf_leaf&nbsp;INTO&nbsp;gs_plaf<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;pyear&nbsp;=&nbsp;lv_year<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;pyeek&nbsp;=&nbsp;lv_week<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;approval&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;gs_plaf&nbsp;TO&nbsp;gt_plaf.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;"&nbsp;ALV2&nbsp;리프레시<br />
&nbsp;&nbsp;IF&nbsp;go_alv_grid1&nbsp;IS&nbsp;BOUND.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;alv_refresh_0100&nbsp;USING&nbsp;go_alv_grid1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;go_alv_grid2&nbsp;IS&nbsp;BOUND.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;만약&nbsp;다른&nbsp;주차를&nbsp;선택했을&nbsp;수도&nbsp;있음으로&nbsp;자재&nbsp;&nbsp;현황&nbsp;ALV&nbsp;GRID2&nbsp;초기화<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REFRESH:&nbsp;gt_mps_mrp.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REFRESH:&nbsp;gt_mps_mrp_group.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;alv_refresh_0100&nbsp;USING&nbsp;go_alv_grid2.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;SET_ALV_plaf_0100<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;PLAF&nbsp;ALV&nbsp;GRID&nbsp;LAYOUT&nbsp;과&nbsp;FCAT&nbsp;초기값&nbsp;설정.<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM set_alv_plaf_0100 USING pv_edit TYPE c.<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;gs_layo1,&nbsp;gs_variant1,&nbsp;gt_fcat1.<br />
<br />
&nbsp;&nbsp;gs_variant1-report&nbsp;=&nbsp;sy-cprog.<br />
&nbsp;&nbsp;gv_save1&nbsp;=&nbsp;'A'.<br />
&nbsp;&nbsp;gs_variant1-handle&nbsp;=&nbsp;'ALV1'.<br />
<br />
&nbsp;&nbsp;"&nbsp;ADD1&nbsp;----&nbsp;!<br />
&nbsp;&nbsp;"&nbsp;행추가는&nbsp;aLv&nbsp;에서&nbsp;막아야한다.<br />
&nbsp;&nbsp;gs_layo1-no_rowins&nbsp;=&nbsp;'X'.&nbsp;"&nbsp;행추가,&nbsp;삭제&nbsp;toolbar&nbsp;btn&nbsp;잠금<br />
&nbsp;&nbsp;"&nbsp;------------.<br />
<br />
&nbsp;&nbsp;gs_layo1-sel_mode&nbsp;=&nbsp;'A'.&nbsp;"&nbsp;여러줄&nbsp;선택가능<br />
&nbsp;&nbsp;gs_layo1-zebra&nbsp;=&nbsp;abap_on.&nbsp;"&nbsp;얼룩처리<br />
&nbsp;&nbsp;gs_layo1-grid_title&nbsp;=&nbsp;'생산계획'.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;gs_layo-cwidth_opt&nbsp;=&nbsp;abap_on.&nbsp;"&nbsp;열넓이&nbsp;최적화&nbsp;샐&nbsp;넓이가&nbsp;고정이&nbsp;되어버림&nbsp;최적으로<br />
*&nbsp;&nbsp;gs_layo-edit&nbsp;=&nbsp;''.&nbsp;"&nbsp;수정모드&nbsp;전체&nbsp;필드가&nbsp;수정&nbsp;가능하게&nbsp;되어짐<br />
   </div>
   <div class="code">
&nbsp;&nbsp;gs_layo1-excp_fname&nbsp;=&nbsp;'ICON'.&nbsp;"&nbsp;ICON&nbsp;필드를&nbsp;신호등으로&nbsp;사용<br />
&nbsp;&nbsp;gs_layo1-excp_led&nbsp;=&nbsp;'X'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;1개&nbsp;짜리&nbsp;신호등으로&nbsp;설정<br />
&nbsp;&nbsp;gs_layo1-ctab_fname&nbsp;=&nbsp;'ROWCOLOR'.&nbsp;"&nbsp;행&nbsp;색<br />
<br />
&nbsp;&nbsp;REFRESH&nbsp;gt_fcat1.<br />
<br />
&nbsp;&nbsp;"&nbsp;사용&nbsp;예정&nbsp;필드&nbsp;:&nbsp;계획&nbsp;플랜트,&nbsp;생산계획&nbsp;ID,&nbsp;계획년,&nbsp;계획주차,&nbsp;계획수량,&nbsp;단위,&nbsp;승인여부<br />
&nbsp;&nbsp;"&nbsp;안쓸&nbsp;필드들&nbsp;no&nbsp;out&nbsp;처리<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat1.<br />
&nbsp;&nbsp;gs_fcat1-fieldname&nbsp;=&nbsp;'LVORM'.<br />
&nbsp;&nbsp;gs_fcat1-no_out&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat1&nbsp;TO&nbsp;gt_fcat1.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat1.<br />
&nbsp;&nbsp;gs_fcat1-fieldname&nbsp;=&nbsp;'ERDAT'.<br />
&nbsp;&nbsp;gs_fcat1-no_out&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat1&nbsp;TO&nbsp;gt_fcat1.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat1.<br />
&nbsp;&nbsp;gs_fcat1-fieldname&nbsp;=&nbsp;'ERZET'.<br />
&nbsp;&nbsp;gs_fcat1-no_out&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat1&nbsp;TO&nbsp;gt_fcat1.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat1.<br />
&nbsp;&nbsp;gs_fcat1-fieldname&nbsp;=&nbsp;'ERNAM'.<br />
&nbsp;&nbsp;gs_fcat1-no_out&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat1&nbsp;TO&nbsp;gt_fcat1.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat1.<br />
&nbsp;&nbsp;gs_fcat1-fieldname&nbsp;=&nbsp;'AEDAT'.<br />
&nbsp;&nbsp;gs_fcat1-no_out&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat1&nbsp;TO&nbsp;gt_fcat1.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat1.<br />
&nbsp;&nbsp;gs_fcat1-fieldname&nbsp;=&nbsp;'AEZET'.<br />
&nbsp;&nbsp;gs_fcat1-no_out&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat1&nbsp;TO&nbsp;gt_fcat1.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat1.<br />
&nbsp;&nbsp;gs_fcat1-fieldname&nbsp;=&nbsp;'AENAM'.<br />
&nbsp;&nbsp;gs_fcat1-no_out&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat1&nbsp;TO&nbsp;gt_fcat1.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat1.<br />
&nbsp;&nbsp;gs_fcat1-fieldname&nbsp;=&nbsp;'SAPNR'.<br />
&nbsp;&nbsp;gs_fcat1-no_out&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat1&nbsp;TO&nbsp;gt_fcat1.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat1.<br />
&nbsp;&nbsp;gs_fcat1-fieldname&nbsp;=&nbsp;'APPROVER'.<br />
&nbsp;&nbsp;gs_fcat1-no_out&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat1&nbsp;TO&nbsp;gt_fcat1.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat1.<br />
&nbsp;&nbsp;gs_fcat1-fieldname&nbsp;=&nbsp;'APPROV_D'.<br />
&nbsp;&nbsp;gs_fcat1-no_out&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat1&nbsp;TO&nbsp;gt_fcat1.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat1.<br />
&nbsp;&nbsp;gs_fcat1-fieldname&nbsp;=&nbsp;'APPROV_T'.<br />
&nbsp;&nbsp;gs_fcat1-no_out&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat1&nbsp;TO&nbsp;gt_fcat1.<br />
<br />
&nbsp;&nbsp;"&nbsp;사용할&nbsp;필드<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat1.<br />
&nbsp;&nbsp;gs_fcat1-fieldname&nbsp;=&nbsp;'ICON'.<br />
&nbsp;&nbsp;gs_fcat1-coltext&nbsp;=&nbsp;'상태'.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;gs_fcat1-icon&nbsp;=&nbsp;'X'.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;gs_fcat1-outputlen&nbsp;&nbsp;=&nbsp;3.<br />
&nbsp;&nbsp;gs_fcat1-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat1&nbsp;TO&nbsp;gt_fcat1.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat1.<br />
&nbsp;&nbsp;gs_fcat1-fieldname&nbsp;=&nbsp;'PLWRK'.<br />
&nbsp;&nbsp;gs_fcat1-coltext&nbsp;=&nbsp;'플랜트'.<br />
&nbsp;&nbsp;gs_fcat1-outputlen&nbsp;&nbsp;=&nbsp;5.<br />
&nbsp;&nbsp;gs_fcat1-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat1&nbsp;TO&nbsp;gt_fcat1.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat1.<br />
&nbsp;&nbsp;gs_fcat1-fieldname&nbsp;=&nbsp;'PLNUM'.<br />
&nbsp;&nbsp;gs_fcat1-coltext&nbsp;=&nbsp;'계획&nbsp;ID'.<br />
&nbsp;&nbsp;gs_fcat1-outputlen&nbsp;&nbsp;=&nbsp;10.<br />
&nbsp;&nbsp;gs_fcat1-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'L'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat1&nbsp;TO&nbsp;gt_fcat1.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat1.<br />
&nbsp;&nbsp;gs_fcat1-fieldname&nbsp;=&nbsp;'PYEAR'.<br />
&nbsp;&nbsp;gs_fcat1-coltext&nbsp;=&nbsp;'연도'.<br />
&nbsp;&nbsp;gs_fcat1-outputlen&nbsp;&nbsp;=&nbsp;4.<br />
&nbsp;&nbsp;gs_fcat1-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat1&nbsp;TO&nbsp;gt_fcat1.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat1.<br />
&nbsp;&nbsp;gs_fcat1-fieldname&nbsp;=&nbsp;'PYEEK'.<br />
&nbsp;&nbsp;gs_fcat1-coltext&nbsp;=&nbsp;'주차'.<br />
&nbsp;&nbsp;gs_fcat1-outputlen&nbsp;&nbsp;=&nbsp;3.<br />
&nbsp;&nbsp;gs_fcat1-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat1&nbsp;TO&nbsp;gt_fcat1.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat1.<br />
&nbsp;&nbsp;gs_fcat1-fieldname&nbsp;=&nbsp;'PLMAT'.<br />
&nbsp;&nbsp;gs_fcat1-coltext&nbsp;=&nbsp;'자재번호'.<br />
&nbsp;&nbsp;gs_fcat1-outputlen&nbsp;&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;gs_fcat1-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat1&nbsp;TO&nbsp;gt_fcat1.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat1.<br />
&nbsp;&nbsp;gs_fcat1-fieldname&nbsp;=&nbsp;'MAKTX'.<br />
&nbsp;&nbsp;gs_fcat1-coltext&nbsp;=&nbsp;'자재설명'.<br />
&nbsp;&nbsp;gs_fcat1-outputlen&nbsp;&nbsp;=&nbsp;12.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;gs_fcat1-col_pos&nbsp;=&nbsp;8.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;gs_fcat1-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'L'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat1&nbsp;TO&nbsp;gt_fcat1.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat1.<br />
&nbsp;&nbsp;gs_fcat1-fieldname&nbsp;=&nbsp;'GSMNG'.<br />
&nbsp;&nbsp;gs_fcat1-coltext&nbsp;=&nbsp;'수량'.<br />
&nbsp;&nbsp;gs_fcat1-outputlen&nbsp;&nbsp;=&nbsp;8.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;gs_fcat1-edit&nbsp;=&nbsp;pv_edit.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;gs_fcat1-qfieldname&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;gs_fcat1-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'R'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat1&nbsp;TO&nbsp;gt_fcat1.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat1.<br />
&nbsp;&nbsp;gs_fcat1-fieldname&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;gs_fcat1-coltext&nbsp;=&nbsp;'단위'.<br />
&nbsp;&nbsp;gs_fcat1-outputlen&nbsp;&nbsp;=&nbsp;3.<br />
&nbsp;&nbsp;gs_fcat1-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat1&nbsp;TO&nbsp;gt_fcat1.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat1.<br />
&nbsp;&nbsp;gs_fcat1-fieldname&nbsp;=&nbsp;'APPROVAL'.<br />
&nbsp;&nbsp;gs_fcat1-coltext&nbsp;=&nbsp;'승인'.<br />
&nbsp;&nbsp;gs_fcat1-outputlen&nbsp;&nbsp;=&nbsp;3.<br />
&nbsp;&nbsp;gs_fcat1-checkbox&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;gs_fcat1-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat1&nbsp;TO&nbsp;gt_fcat1.<br />
<br />
<br />
ENDFORM.<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;set_alv_MDKP_0100<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;MRP&nbsp;Header&nbsp;LAYOUT&nbsp;과&nbsp;FCAT&nbsp;초기값&nbsp;설정.<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM set_alv_mdkp_0100 USING pv_edit TYPE c.<br />
&nbsp;&nbsp;CLEAR:&nbsp;gs_layo3,&nbsp;gs_variant3&nbsp;,gt_fcat3.<br />
<br />
&nbsp;&nbsp;gs_variant3-report&nbsp;=&nbsp;sy-cprog.<br />
&nbsp;&nbsp;gs_variant3-handle&nbsp;=&nbsp;'ALV3'.<br />
&nbsp;&nbsp;gv_save3&nbsp;=&nbsp;'A'.<br />
<br />
&nbsp;&nbsp;gs_layo3-sel_mode&nbsp;=&nbsp;'B'.&nbsp;"&nbsp;CELL&nbsp;단위&nbsp;선택가능<br />
&nbsp;&nbsp;gs_layo3-zebra&nbsp;=&nbsp;abap_on.&nbsp;"&nbsp;얼룩처리<br />
&nbsp;&nbsp;gs_layo3-grid_title&nbsp;=&nbsp;'MRP&nbsp;Header'.<br />
&nbsp;&nbsp;gs_layo3-no_rowins&nbsp;=&nbsp;'X'.&nbsp;"&nbsp;행추가,&nbsp;삭제&nbsp;toolbar&nbsp;btn&nbsp;잠금<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;gs_layo3-cwidth_opt&nbsp;=&nbsp;abap_on.&nbsp;"&nbsp;열넓이&nbsp;최적화&nbsp;샐&nbsp;넓이가&nbsp;고정이&nbsp;되어버림&nbsp;최적으로<br />
*&nbsp;&nbsp;gs_layo3-edit&nbsp;=&nbsp;''.&nbsp;"&nbsp;수정모드&nbsp;전체&nbsp;필드가&nbsp;수정&nbsp;가능하게&nbsp;되어짐<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;"&nbsp;사용&nbsp;안하는&nbsp;필드<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat3.<br />
&nbsp;&nbsp;gs_fcat3-fieldname&nbsp;=&nbsp;'LVORM'.<br />
&nbsp;&nbsp;gs_fcat3-no_out&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat3&nbsp;TO&nbsp;gt_fcat3.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat3.<br />
&nbsp;&nbsp;gs_fcat3-fieldname&nbsp;=&nbsp;'ERDAT'.<br />
&nbsp;&nbsp;gs_fcat3-no_out&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat3&nbsp;TO&nbsp;gt_fcat3.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat3.<br />
&nbsp;&nbsp;gs_fcat3-fieldname&nbsp;=&nbsp;'ERZET'.<br />
&nbsp;&nbsp;gs_fcat3-no_out&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat3&nbsp;TO&nbsp;gt_fcat3.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat3.<br />
&nbsp;&nbsp;gs_fcat3-fieldname&nbsp;=&nbsp;'ERNAM'.<br />
&nbsp;&nbsp;gs_fcat3-no_out&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat3&nbsp;TO&nbsp;gt_fcat3.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat3.<br />
&nbsp;&nbsp;gs_fcat3-fieldname&nbsp;=&nbsp;'AEDAT'.<br />
&nbsp;&nbsp;gs_fcat3-no_out&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat3&nbsp;TO&nbsp;gt_fcat3.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat3.<br />
&nbsp;&nbsp;gs_fcat3-fieldname&nbsp;=&nbsp;'AEZET'.<br />
&nbsp;&nbsp;gs_fcat3-no_out&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat3&nbsp;TO&nbsp;gt_fcat3.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat3.<br />
&nbsp;&nbsp;gs_fcat3-fieldname&nbsp;=&nbsp;'AENAM'.<br />
&nbsp;&nbsp;gs_fcat3-no_out&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat3&nbsp;TO&nbsp;gt_fcat3.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat3.<br />
&nbsp;&nbsp;gs_fcat3-fieldname&nbsp;=&nbsp;'APPROV_T'.<br />
&nbsp;&nbsp;gs_fcat3-no_out&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat3&nbsp;TO&nbsp;gt_fcat3.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat3.<br />
&nbsp;&nbsp;gs_fcat3-fieldname&nbsp;=&nbsp;'DTNUM'.<br />
&nbsp;&nbsp;gs_fcat3-no_out&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat3&nbsp;TO&nbsp;gt_fcat3.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat3.<br />
&nbsp;&nbsp;gs_fcat3-fieldname&nbsp;=&nbsp;'APPROVAL'.<br />
&nbsp;&nbsp;gs_fcat3-coltext&nbsp;=&nbsp;'승인'.<br />
&nbsp;&nbsp;gs_fcat3-outputlen&nbsp;&nbsp;=&nbsp;3.<br />
&nbsp;&nbsp;gs_fcat3-checkbox&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;gs_fcat3-no_out&nbsp;='X'.<br />
&nbsp;&nbsp;gs_fcat3-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat3&nbsp;TO&nbsp;gt_fcat3.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat3.<br />
&nbsp;&nbsp;gs_fcat3-fieldname&nbsp;=&nbsp;'APPROVER'.<br />
&nbsp;&nbsp;gs_fcat3-coltext&nbsp;=&nbsp;'승인자'.<br />
&nbsp;&nbsp;gs_fcat3-outputlen&nbsp;&nbsp;=&nbsp;5.<br />
&nbsp;&nbsp;gs_fcat3-no_out&nbsp;='X'.<br />
&nbsp;&nbsp;gs_fcat3-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat3&nbsp;TO&nbsp;gt_fcat3.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat3.<br />
&nbsp;&nbsp;gs_fcat3-fieldname&nbsp;=&nbsp;'APPROV_D'.<br />
&nbsp;&nbsp;gs_fcat3-coltext&nbsp;=&nbsp;'승인일자'.<br />
&nbsp;&nbsp;gs_fcat3-outputlen&nbsp;&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;gs_fcat3-no_out&nbsp;='X'.<br />
&nbsp;&nbsp;gs_fcat3-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat3&nbsp;TO&nbsp;gt_fcat3.<br />
<br />
&nbsp;&nbsp;"&nbsp;사용할&nbsp;필드<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat3.<br />
&nbsp;&nbsp;gs_fcat3-fieldname&nbsp;=&nbsp;'PLNUM'.<br />
&nbsp;&nbsp;gs_fcat3-coltext&nbsp;=&nbsp;'생산계획&nbsp;ID'.<br />
&nbsp;&nbsp;gs_fcat3-outputlen&nbsp;&nbsp;=&nbsp;10.<br />
&nbsp;&nbsp;gs_fcat3-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'L'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat3&nbsp;TO&nbsp;gt_fcat3.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat3.<br />
&nbsp;&nbsp;gs_fcat3-fieldname&nbsp;=&nbsp;'WERKS'.<br />
&nbsp;&nbsp;gs_fcat3-coltext&nbsp;=&nbsp;'플랜트'.<br />
&nbsp;&nbsp;gs_fcat3-outputlen&nbsp;&nbsp;=&nbsp;5.<br />
&nbsp;&nbsp;gs_fcat3-col_pos&nbsp;=&nbsp;1.<br />
&nbsp;&nbsp;gs_fcat3-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat3&nbsp;TO&nbsp;gt_fcat3.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat3.<br />
&nbsp;&nbsp;gs_fcat3-fieldname&nbsp;=&nbsp;'MATNR'.<br />
&nbsp;&nbsp;gs_fcat3-coltext&nbsp;=&nbsp;'자재번호'.<br />
&nbsp;&nbsp;gs_fcat3-outputlen&nbsp;&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;gs_fcat3-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat3&nbsp;TO&nbsp;gt_fcat3.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat3.<br />
&nbsp;&nbsp;gs_fcat3-fieldname&nbsp;=&nbsp;'MAKTX'.<br />
&nbsp;&nbsp;gs_fcat3-coltext&nbsp;=&nbsp;'자재설명'.<br />
&nbsp;&nbsp;gs_fcat3-outputlen&nbsp;&nbsp;=&nbsp;12.<br />
&nbsp;&nbsp;gs_fcat3-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'L'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat3&nbsp;TO&nbsp;gt_fcat3.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat3.<br />
&nbsp;&nbsp;gs_fcat3-fieldname&nbsp;=&nbsp;'GSMNG'.<br />
&nbsp;&nbsp;gs_fcat3-coltext&nbsp;=&nbsp;'수량'.<br />
&nbsp;&nbsp;gs_fcat3-outputlen&nbsp;&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;gs_fcat3-edit&nbsp;=&nbsp;pv_edit.<br />
&nbsp;&nbsp;gs_fcat3-qfieldname&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;gs_fcat3-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'R'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat3&nbsp;TO&nbsp;gt_fcat3.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat3.<br />
&nbsp;&nbsp;gs_fcat3-fieldname&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;gs_fcat3-coltext&nbsp;=&nbsp;'단위'.<br />
&nbsp;&nbsp;gs_fcat3-outputlen&nbsp;&nbsp;=&nbsp;3.<br />
&nbsp;&nbsp;gs_fcat3-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat3&nbsp;TO&nbsp;gt_fcat3.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat3.<br />
&nbsp;&nbsp;gs_fcat3-fieldname&nbsp;=&nbsp;'DSDAT'.<br />
&nbsp;&nbsp;gs_fcat3-coltext&nbsp;=&nbsp;'시작일'.<br />
&nbsp;&nbsp;gs_fcat3-outputlen&nbsp;&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;gs_fcat3-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;gs_fcat3-ref_table&nbsp;=&nbsp;'ZCB_MDKP'.<br />
&nbsp;&nbsp;gs_fcat3-ref_field&nbsp;=&nbsp;'DSDAT'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat3&nbsp;TO&nbsp;gt_fcat3.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat3.<br />
&nbsp;&nbsp;gs_fcat3-fieldname&nbsp;=&nbsp;'DEDAT'.<br />
&nbsp;&nbsp;gs_fcat3-coltext&nbsp;=&nbsp;'종료일'.<br />
&nbsp;&nbsp;gs_fcat3-outputlen&nbsp;&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;gs_fcat3-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;gs_fcat3-ref_table&nbsp;=&nbsp;'ZCB_MDKP'.<br />
&nbsp;&nbsp;gs_fcat3-ref_field&nbsp;=&nbsp;'DEDAT'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat3&nbsp;TO&nbsp;gt_fcat3.<br />
<br />
<br />
ENDFORM.<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;set_alv_MDKP_0100<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;MRP&nbsp;Header&nbsp;LAYOUT&nbsp;과&nbsp;FCAT&nbsp;초기값&nbsp;설정.<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM set_alv_mdtb_0100 USING pv_edit TYPE c.<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;gs_layo4,&nbsp;gs_variant4&nbsp;,&nbsp;gt_fcat4.<br />
<br />
&nbsp;&nbsp;gs_variant4-report&nbsp;=&nbsp;sy-cprog.<br />
&nbsp;&nbsp;gv_save4&nbsp;=&nbsp;'A'.<br />
&nbsp;&nbsp;gs_variant4-handle&nbsp;=&nbsp;'ALV4'.<br />
<br />
&nbsp;&nbsp;gs_layo4-no_rowins&nbsp;=&nbsp;'X'.&nbsp;"&nbsp;행추가,&nbsp;삭제&nbsp;toolbar&nbsp;btn&nbsp;잠금<br />
&nbsp;&nbsp;gs_layo4-sel_mode&nbsp;=&nbsp;'B'.&nbsp;"&nbsp;CELL&nbsp;단위&nbsp;선택가능<br />
&nbsp;&nbsp;gs_layo4-zebra&nbsp;=&nbsp;abap_on.&nbsp;"&nbsp;얼룩처리<br />
&nbsp;&nbsp;gs_layo4-grid_title&nbsp;=&nbsp;'MRP&nbsp;Item'.<br />
&nbsp;&nbsp;gs_layo4-info_fname&nbsp;=&nbsp;'ROWCOLOR'.&nbsp;"&nbsp;ROW&nbsp;색<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;gs_layo3-cwidth_opt&nbsp;=&nbsp;abap_on.&nbsp;"&nbsp;열넓이&nbsp;최적화&nbsp;샐&nbsp;넓이가&nbsp;고정이&nbsp;되어버림&nbsp;최적으로<br />
*&nbsp;&nbsp;gs_layo3-edit&nbsp;=&nbsp;''.&nbsp;"&nbsp;수정모드&nbsp;전체&nbsp;필드가&nbsp;수정&nbsp;가능하게&nbsp;되어짐<br />
<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;"&nbsp;사용&nbsp;안하는&nbsp;필드<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat4.<br />
&nbsp;&nbsp;gs_fcat4-fieldname&nbsp;=&nbsp;'LVORM'.<br />
&nbsp;&nbsp;gs_fcat4-no_out&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat4&nbsp;TO&nbsp;gt_fcat4.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat4.<br />
&nbsp;&nbsp;gs_fcat4-fieldname&nbsp;=&nbsp;'ERDAT'.<br />
&nbsp;&nbsp;gs_fcat4-no_out&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat4&nbsp;TO&nbsp;gt_fcat4.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat4.<br />
&nbsp;&nbsp;gs_fcat4-fieldname&nbsp;=&nbsp;'ERZET'.<br />
&nbsp;&nbsp;gs_fcat4-no_out&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat4&nbsp;TO&nbsp;gt_fcat4.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat4.<br />
&nbsp;&nbsp;gs_fcat4-fieldname&nbsp;=&nbsp;'ERNAM'.<br />
&nbsp;&nbsp;gs_fcat4-no_out&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat4&nbsp;TO&nbsp;gt_fcat4.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat4.<br />
&nbsp;&nbsp;gs_fcat4-fieldname&nbsp;=&nbsp;'AEDAT'.<br />
&nbsp;&nbsp;gs_fcat4-no_out&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat4&nbsp;TO&nbsp;gt_fcat4.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat4.<br />
&nbsp;&nbsp;gs_fcat4-fieldname&nbsp;=&nbsp;'AEZET'.<br />
&nbsp;&nbsp;gs_fcat4-no_out&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat4&nbsp;TO&nbsp;gt_fcat4.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat4.<br />
&nbsp;&nbsp;gs_fcat4-fieldname&nbsp;=&nbsp;'AENAM'.<br />
&nbsp;&nbsp;gs_fcat4-no_out&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat4&nbsp;TO&nbsp;gt_fcat4.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat4.<br />
&nbsp;&nbsp;gs_fcat4-fieldname&nbsp;=&nbsp;'REQCOMPLETE'.<br />
&nbsp;&nbsp;gs_fcat4-no_out&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat4&nbsp;TO&nbsp;gt_fcat4.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat4.<br />
&nbsp;&nbsp;gs_fcat4-fieldname&nbsp;=&nbsp;'DTNUM'.<br />
&nbsp;&nbsp;gs_fcat4-no_out&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat4&nbsp;TO&nbsp;gt_fcat4.<br />
<br />
&nbsp;&nbsp;"&nbsp;사용할&nbsp;필드<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat4.<br />
&nbsp;&nbsp;gs_fcat4-fieldname&nbsp;=&nbsp;'WERKS'.<br />
&nbsp;&nbsp;gs_fcat4-coltext&nbsp;=&nbsp;'플랜트'.<br />
&nbsp;&nbsp;gs_fcat4-outputlen&nbsp;&nbsp;=&nbsp;4.<br />
&nbsp;&nbsp;gs_fcat4-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat4&nbsp;TO&nbsp;gt_fcat4.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat4.<br />
&nbsp;&nbsp;gs_fcat4-fieldname&nbsp;=&nbsp;'MATNR'.<br />
&nbsp;&nbsp;gs_fcat4-coltext&nbsp;=&nbsp;'생산&nbsp;자재번호'.<br />
&nbsp;&nbsp;gs_fcat4-outputlen&nbsp;&nbsp;=&nbsp;10.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;gs_fcat4-col_pos&nbsp;=&nbsp;2.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;gs_fcat4-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat4&nbsp;TO&nbsp;gt_fcat4.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat4.<br />
&nbsp;&nbsp;gs_fcat4-fieldname&nbsp;=&nbsp;'MAKTX_TOP'.<br />
&nbsp;&nbsp;gs_fcat4-coltext&nbsp;=&nbsp;'생산자재설명'.<br />
&nbsp;&nbsp;gs_fcat4-outputlen&nbsp;&nbsp;=&nbsp;12.<br />
&nbsp;&nbsp;gs_fcat4-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'L'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat4&nbsp;TO&nbsp;gt_fcat4.<br />
<br />
&nbsp;CLEAR&nbsp;gs_fcat4.<br />
&nbsp;&nbsp;gs_fcat4-fieldname&nbsp;=&nbsp;'DTPOS'.<br />
&nbsp;&nbsp;gs_fcat4-coltext&nbsp;=&nbsp;'번호'.<br />
&nbsp;&nbsp;gs_fcat4-outputlen&nbsp;&nbsp;=&nbsp;4.<br />
&nbsp;&nbsp;gs_fcat4-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat4&nbsp;TO&nbsp;gt_fcat4.<br />
<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat4.<br />
&nbsp;&nbsp;gs_fcat4-fieldname&nbsp;=&nbsp;'IDNRK'.<br />
&nbsp;&nbsp;gs_fcat4-coltext&nbsp;=&nbsp;'필요&nbsp;자재번호'.<br />
&nbsp;&nbsp;gs_fcat4-outputlen&nbsp;&nbsp;=&nbsp;10.<br />
&nbsp;&nbsp;gs_fcat4-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat4&nbsp;TO&nbsp;gt_fcat4.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat4.<br />
&nbsp;&nbsp;gs_fcat4-fieldname&nbsp;=&nbsp;'MAKTX_BOT'.<br />
&nbsp;&nbsp;gs_fcat4-coltext&nbsp;=&nbsp;'필요자재설명'.<br />
&nbsp;&nbsp;gs_fcat4-outputlen&nbsp;&nbsp;=&nbsp;12.<br />
&nbsp;&nbsp;gs_fcat4-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'L'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat4&nbsp;TO&nbsp;gt_fcat4.<br />
<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat4.<br />
&nbsp;&nbsp;gs_fcat4-fieldname&nbsp;=&nbsp;'RQMNG'.<br />
&nbsp;&nbsp;gs_fcat4-coltext&nbsp;=&nbsp;'필요수량'.<br />
&nbsp;&nbsp;gs_fcat4-outputlen&nbsp;&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;gs_fcat4-qfieldname&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;gs_fcat4-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'R'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat4&nbsp;TO&nbsp;gt_fcat4.<br />
<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat4.<br />
&nbsp;&nbsp;gs_fcat4-fieldname&nbsp;=&nbsp;'KLABS'.<br />
&nbsp;&nbsp;gs_fcat4-coltext&nbsp;=&nbsp;'가용재고'.<br />
&nbsp;&nbsp;gs_fcat4-outputlen&nbsp;&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;gs_fcat4-qfieldname&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;gs_fcat4-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'R'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat4&nbsp;TO&nbsp;gt_fcat4.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat4.<br />
&nbsp;&nbsp;gs_fcat4-fieldname&nbsp;=&nbsp;'SQMNG'.<br />
&nbsp;&nbsp;gs_fcat4-coltext&nbsp;=&nbsp;'부족수량'.<br />
&nbsp;&nbsp;gs_fcat4-outputlen&nbsp;&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;gs_fcat4-qfieldname&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;gs_fcat4-edit&nbsp;=&nbsp;pv_edit.<br />
&nbsp;&nbsp;gs_fcat4-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'R'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat4&nbsp;TO&nbsp;gt_fcat4.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat4.<br />
&nbsp;&nbsp;gs_fcat4-fieldname&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;gs_fcat4-coltext&nbsp;=&nbsp;'단위'.<br />
&nbsp;&nbsp;gs_fcat4-outputlen&nbsp;&nbsp;=&nbsp;3.<br />
&nbsp;&nbsp;gs_fcat4-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat4&nbsp;TO&nbsp;gt_fcat4.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat4.<br />
&nbsp;&nbsp;gs_fcat4-fieldname&nbsp;=&nbsp;'BESKZ'.<br />
&nbsp;&nbsp;gs_fcat4-coltext&nbsp;=&nbsp;'유형'.<br />
&nbsp;&nbsp;gs_fcat4-outputlen&nbsp;&nbsp;=&nbsp;4.<br />
&nbsp;&nbsp;gs_fcat4-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat4&nbsp;TO&nbsp;gt_fcat4.<br />
<br />
<br />
ENDFORM.<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;SET_ALV_MRP_MPS_0100<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;MRP_MPS_CDS_VIEW&nbsp;ALV&nbsp;GRID&nbsp;LAYOUT&nbsp;과&nbsp;FCAT&nbsp;초기값&nbsp;설정.<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM set_alv_MRPMPS_0100.<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;gs_layo2,&nbsp;gs_variant2.<br />
<br />
&nbsp;&nbsp;gs_variant2-report&nbsp;=&nbsp;sy-cprog.<br />
&nbsp;&nbsp;gv_save2&nbsp;=&nbsp;'A'.<br />
&nbsp;&nbsp;gs_variant2-handle&nbsp;=&nbsp;'ALV2'.<br />
<br />
&nbsp;&nbsp;gs_layo2-no_rowins&nbsp;=&nbsp;'X'.&nbsp;"&nbsp;행추가,&nbsp;삭제&nbsp;toolbar&nbsp;btn&nbsp;잠금<br />
&nbsp;&nbsp;gs_layo2-sel_mode&nbsp;=&nbsp;'B'.&nbsp;"&nbsp;CELL&nbsp;단위&nbsp;선택가능<br />
&nbsp;&nbsp;gs_layo2-zebra&nbsp;=&nbsp;abap_on.&nbsp;"&nbsp;얼룩처리<br />
&nbsp;&nbsp;gs_layo2-grid_title&nbsp;=&nbsp;'자재소요량&nbsp;계산'.<br />
&nbsp;&nbsp;gs_layo2-info_fname&nbsp;=&nbsp;'ROWCOLOR'.&nbsp;"&nbsp;ROW&nbsp;색<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;gs_layo2-cwidth_opt&nbsp;=&nbsp;abap_on.&nbsp;"&nbsp;열넓이&nbsp;최적화&nbsp;샐&nbsp;넓이가&nbsp;고정이&nbsp;되어버림&nbsp;최적으로<br />
*&nbsp;&nbsp;gs_layo2-edit&nbsp;=&nbsp;''.&nbsp;"&nbsp;수정모드&nbsp;전체&nbsp;필드가&nbsp;수정&nbsp;가능하게&nbsp;되어짐<br />
<br />
<br />
*&nbsp;&nbsp;werks,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;플랜트<br />
*&nbsp;&nbsp;week,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;주차<br />
*&nbsp;&nbsp;MatnrTop,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;생산자재<br />
*&nbsp;&nbsp;PlanQty,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;생산수량&nbsp;(사용&nbsp;안함)<br />
*&nbsp;&nbsp;PlanUOM,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;생산단위&nbsp;(사용&nbsp;안함)<br />
*&nbsp;&nbsp;MatnrComponent,&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;BOM&nbsp;자재<br />
*&nbsp;&nbsp;ReqQty,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;생산에&nbsp;필요한&nbsp;자재&nbsp;량<br />
*&nbsp;&nbsp;CurrentStock,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;창고에&nbsp;보유한&nbsp;자재&nbsp;량<br />
*&nbsp;&nbsp;bomu&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;BOM&nbsp;단위<br />
*&nbsp;&nbsp;fresh&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;제품군<br />
*&nbsp;추가&nbsp;필드<br />
*&nbsp;&nbsp;ordergap&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;기간&nbsp;중&nbsp;발주&nbsp;일&nbsp;수<br />
*&nbsp;&nbsp;orderqty&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;발주&nbsp;당&nbsp;수량<br />
   </div>
   <div class="code">
&nbsp;&nbsp;REFRESH&nbsp;gt_fcat2.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat2.<br />
&nbsp;&nbsp;gs_fcat2-fieldname&nbsp;=&nbsp;'WERKS'.<br />
&nbsp;&nbsp;gs_fcat2-coltext&nbsp;=&nbsp;'플랜트'.<br />
&nbsp;&nbsp;gs_fcat2-outputlen&nbsp;&nbsp;=&nbsp;5.<br />
&nbsp;&nbsp;gs_fcat2-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat2&nbsp;TO&nbsp;gt_fcat2.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat2.<br />
&nbsp;&nbsp;gs_fcat2-fieldname&nbsp;=&nbsp;'WEEK'.<br />
&nbsp;&nbsp;gs_fcat2-coltext&nbsp;=&nbsp;'주차'.<br />
&nbsp;&nbsp;gs_fcat2-outputlen&nbsp;&nbsp;=&nbsp;3.<br />
&nbsp;&nbsp;gs_fcat2-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat2&nbsp;TO&nbsp;gt_fcat2.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat2.<br />
&nbsp;&nbsp;gs_fcat2-fieldname&nbsp;=&nbsp;'MATNRCOMPONENT'.<br />
&nbsp;&nbsp;gs_fcat2-coltext&nbsp;=&nbsp;'자재번호'.<br />
&nbsp;&nbsp;gs_fcat2-outputlen&nbsp;&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;gs_fcat2-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat2&nbsp;TO&nbsp;gt_fcat2.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat2.<br />
&nbsp;&nbsp;gs_fcat2-fieldname&nbsp;=&nbsp;'COMPONENT_DESC'.<br />
&nbsp;&nbsp;gs_fcat2-coltext&nbsp;=&nbsp;'자재설명'.<br />
&nbsp;&nbsp;gs_fcat2-outputlen&nbsp;&nbsp;=&nbsp;10.<br />
&nbsp;&nbsp;gs_fcat2-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'L'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat2&nbsp;TO&nbsp;gt_fcat2.<br />
<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat2.<br />
&nbsp;&nbsp;gs_fcat2-fieldname&nbsp;=&nbsp;'TOTALQTY'.<br />
&nbsp;&nbsp;gs_fcat2-coltext&nbsp;=&nbsp;'필요수량'.<br />
&nbsp;&nbsp;gs_fcat2-outputlen&nbsp;&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;gs_fcat2-qfieldname&nbsp;=&nbsp;'BOMU'.<br />
&nbsp;&nbsp;gs_fcat2-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'R'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat2&nbsp;TO&nbsp;gt_fcat2.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat2.<br />
&nbsp;&nbsp;gs_fcat2-fieldname&nbsp;=&nbsp;'CURRENTSTOCK'.<br />
&nbsp;&nbsp;gs_fcat2-coltext&nbsp;=&nbsp;'제고수량'.<br />
&nbsp;&nbsp;gs_fcat2-outputlen&nbsp;&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;gs_fcat2-qfieldname&nbsp;=&nbsp;'BOMU'.<br />
&nbsp;&nbsp;gs_fcat2-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'R'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat2&nbsp;TO&nbsp;gt_fcat2.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat2.<br />
&nbsp;&nbsp;gs_fcat2-fieldname&nbsp;=&nbsp;'BOMU'.<br />
&nbsp;&nbsp;gs_fcat2-coltext&nbsp;=&nbsp;'단위'.<br />
&nbsp;&nbsp;gs_fcat1-outputlen&nbsp;&nbsp;=&nbsp;3.<br />
&nbsp;&nbsp;gs_fcat2-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat2&nbsp;TO&nbsp;gt_fcat2.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat2.<br />
&nbsp;&nbsp;gs_fcat2-fieldname&nbsp;=&nbsp;'FRESH'.<br />
&nbsp;&nbsp;gs_fcat2-coltext&nbsp;=&nbsp;'제품군'.<br />
&nbsp;&nbsp;gs_fcat2-outputlen&nbsp;&nbsp;=&nbsp;4.<br />
&nbsp;&nbsp;gs_fcat2-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat2&nbsp;TO&nbsp;gt_fcat2.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat2.<br />
&nbsp;&nbsp;gs_fcat2-fieldname&nbsp;=&nbsp;'PROCUREMENTTYPE'.<br />
&nbsp;&nbsp;gs_fcat2-coltext&nbsp;=&nbsp;'조달유형'.<br />
&nbsp;&nbsp;gs_fcat2-outputlen&nbsp;&nbsp;=&nbsp;5.<br />
&nbsp;&nbsp;gs_fcat2-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat2&nbsp;TO&nbsp;gt_fcat2.<br />
<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat2.<br />
&nbsp;&nbsp;gs_fcat2-fieldname&nbsp;=&nbsp;'ORDERGAP'.<br />
&nbsp;&nbsp;gs_fcat2-coltext&nbsp;=&nbsp;'주기'.<br />
&nbsp;&nbsp;gs_fcat2-outputlen&nbsp;&nbsp;=&nbsp;3.<br />
&nbsp;&nbsp;gs_fcat2-col_pos&nbsp;=&nbsp;90.<br />
&nbsp;&nbsp;gs_fcat2-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat2&nbsp;TO&nbsp;gt_fcat2.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat2.<br />
&nbsp;&nbsp;gs_fcat2-fieldname&nbsp;=&nbsp;'ORDERQTY'.<br />
&nbsp;&nbsp;gs_fcat2-coltext&nbsp;=&nbsp;'발주&nbsp;당&nbsp;수량'.<br />
&nbsp;&nbsp;gs_fcat2-outputlen&nbsp;&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;gs_fcat2-col_pos&nbsp;=&nbsp;91.<br />
&nbsp;&nbsp;gs_fcat2-ref_field&nbsp;&nbsp;=&nbsp;'TOTALQTY'.&nbsp;&nbsp;&nbsp;"&nbsp;참조하는&nbsp;실제&nbsp;필드이름<br />
&nbsp;&nbsp;gs_fcat2-ref_table&nbsp;&nbsp;=&nbsp;'ZCBCDSMRPSGROUP'.&nbsp;&nbsp;"&nbsp;CDS&nbsp;View&nbsp;이름&nbsp;(또는&nbsp;구조&nbsp;이름)<br />
&nbsp;&nbsp;gs_fcat2-qfieldname&nbsp;=&nbsp;'BOMU'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;단위&nbsp;필드&nbsp;(중요!)<br />
&nbsp;&nbsp;gs_fcat2-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'R'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat2&nbsp;TO&nbsp;gt_fcat2.<br />
<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;set_alv_order_0110<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;MRP&nbsp;수행(&nbsp;생산요청,&nbsp;구매요청&nbsp;)&nbsp;관련&nbsp;ALV<br />
*&&nbsp;https://moon-7.tistory.com/58&nbsp;cell&nbsp;설정&nbsp;관련<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM set_alv_order_0110  USING    pv_edit TYPE c.<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;gs_layo5,&nbsp;gs_variant5&nbsp;,&nbsp;gt_fcat5.<br />
<br />
&nbsp;&nbsp;gs_variant5-report&nbsp;=&nbsp;sy-cprog.<br />
&nbsp;&nbsp;gv_save5&nbsp;=&nbsp;'A'.<br />
&nbsp;&nbsp;gs_variant5-handle&nbsp;=&nbsp;'ALV5'.<br />
<br />
&nbsp;&nbsp;gs_layo5-sel_mode&nbsp;=&nbsp;'B'.&nbsp;"&nbsp;CELL&nbsp;단위&nbsp;선택가능<br />
&nbsp;&nbsp;gs_layo5-zebra&nbsp;=&nbsp;abap_on.&nbsp;"&nbsp;얼룩처리<br />
&nbsp;&nbsp;gs_layo5-grid_title&nbsp;=&nbsp;'구매&nbsp;및&nbsp;생산&nbsp;요청'.<br />
&nbsp;&nbsp;gs_layo5-stylefname&nbsp;=&nbsp;'CELLTAB'.<br />
&nbsp;&nbsp;gs_layo5-info_fname&nbsp;=&nbsp;'ROWCOLOR'.&nbsp;"&nbsp;ROW&nbsp;색<br />
&nbsp;&nbsp;gs_layo5-no_rowins&nbsp;=&nbsp;'X'.&nbsp;"&nbsp;행추가,&nbsp;삭제&nbsp;toolbar&nbsp;btn&nbsp;잠금<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;gs_layo3-cwidth_opt&nbsp;=&nbsp;abap_on.&nbsp;"&nbsp;열넓이&nbsp;최적화&nbsp;샐&nbsp;넓이가&nbsp;고정이&nbsp;되어버림&nbsp;최적으로<br />
   </div>
   <div class="code">
&nbsp;&nbsp;gs_layo5-edit&nbsp;=&nbsp;''.&nbsp;"&nbsp;수정모드&nbsp;전체&nbsp;필드가&nbsp;수정&nbsp;가능하게&nbsp;되어짐<br />
<br />
&nbsp;&nbsp;"&nbsp;사용할&nbsp;필드<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat5.<br />
&nbsp;&nbsp;gs_fcat5-fieldname&nbsp;=&nbsp;'WERKS'.<br />
&nbsp;&nbsp;gs_fcat5-coltext&nbsp;=&nbsp;'플랜트'.<br />
&nbsp;&nbsp;gs_fcat5-outputlen&nbsp;&nbsp;=&nbsp;4.<br />
&nbsp;&nbsp;gs_fcat5-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat5&nbsp;TO&nbsp;gt_fcat5.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat5.<br />
&nbsp;&nbsp;gs_fcat5-fieldname&nbsp;=&nbsp;'CATEGORY'.<br />
&nbsp;&nbsp;gs_fcat5-coltext&nbsp;=&nbsp;'요청유형'.<br />
&nbsp;&nbsp;gs_fcat5-outputlen&nbsp;&nbsp;=&nbsp;6.<br />
&nbsp;&nbsp;gs_fcat5-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat5&nbsp;TO&nbsp;gt_fcat5.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat5.<br />
&nbsp;&nbsp;gs_fcat5-fieldname&nbsp;=&nbsp;'IDNRK'.<br />
&nbsp;&nbsp;gs_fcat5-coltext&nbsp;=&nbsp;'자재번호'.<br />
&nbsp;&nbsp;gs_fcat5-outputlen&nbsp;&nbsp;=&nbsp;6.<br />
&nbsp;&nbsp;gs_fcat5-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat5&nbsp;TO&nbsp;gt_fcat5.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat5.<br />
&nbsp;&nbsp;gs_fcat5-fieldname&nbsp;=&nbsp;'MAKTX'.<br />
&nbsp;&nbsp;gs_fcat5-coltext&nbsp;=&nbsp;'자재설명'.<br />
&nbsp;&nbsp;gs_fcat5-outputlen&nbsp;&nbsp;=&nbsp;10.<br />
&nbsp;&nbsp;gs_fcat5-col_pos&nbsp;=&nbsp;4.<br />
&nbsp;&nbsp;gs_fcat5-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'L'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat5&nbsp;TO&nbsp;gt_fcat5.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat5.<br />
&nbsp;&nbsp;gs_fcat5-fieldname&nbsp;=&nbsp;'TOTAL_QTY'.<br />
&nbsp;&nbsp;gs_fcat5-coltext&nbsp;=&nbsp;'필요수량'.<br />
&nbsp;&nbsp;gs_fcat5-outputlen&nbsp;&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;gs_fcat5-qfieldname&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;gs_fcat5-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'R'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat5&nbsp;TO&nbsp;gt_fcat5.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat5.<br />
&nbsp;&nbsp;gs_fcat5-fieldname&nbsp;=&nbsp;'SUM_WEEKDAYS'.<br />
&nbsp;&nbsp;gs_fcat5-coltext&nbsp;=&nbsp;'총&nbsp;입력수량'.<br />
&nbsp;&nbsp;gs_fcat5-outputlen&nbsp;&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;gs_fcat5-qfieldname&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;gs_fcat5-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'R'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat5&nbsp;TO&nbsp;gt_fcat5.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat5.<br />
&nbsp;&nbsp;gs_fcat5-fieldname&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;gs_fcat5-coltext&nbsp;=&nbsp;'단위'.<br />
&nbsp;&nbsp;gs_fcat5-outputlen&nbsp;&nbsp;=&nbsp;3.<br />
&nbsp;&nbsp;gs_fcat5-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat5&nbsp;TO&nbsp;gt_fcat5.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat5.<br />
&nbsp;&nbsp;gs_fcat5-fieldname&nbsp;=&nbsp;'WEEK'.<br />
&nbsp;&nbsp;gs_fcat5-coltext&nbsp;=&nbsp;'주차'.<br />
&nbsp;&nbsp;gs_fcat5-outputlen&nbsp;&nbsp;=&nbsp;3.<br />
&nbsp;&nbsp;gs_fcat5-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat5&nbsp;TO&nbsp;gt_fcat5.<br />
<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat5.<br />
&nbsp;&nbsp;gs_fcat5-fieldname&nbsp;=&nbsp;'MON'.<br />
&nbsp;&nbsp;gs_fcat5-coltext&nbsp;=&nbsp;'월요일'.<br />
&nbsp;&nbsp;gs_fcat5-outputlen&nbsp;&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;gs_fcat5-edit&nbsp;=&nbsp;pv_edit.<br />
&nbsp;&nbsp;gs_fcat5-qfieldname&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;gs_fcat5-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'R'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat5&nbsp;TO&nbsp;gt_fcat5.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat5.<br />
&nbsp;&nbsp;gs_fcat5-fieldname&nbsp;=&nbsp;'TUE'.<br />
&nbsp;&nbsp;gs_fcat5-coltext&nbsp;=&nbsp;'화요일'.<br />
&nbsp;&nbsp;gs_fcat5-outputlen&nbsp;&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;gs_fcat5-edit&nbsp;=&nbsp;pv_edit.<br />
&nbsp;&nbsp;gs_fcat5-qfieldname&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;gs_fcat5-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'R'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat5&nbsp;TO&nbsp;gt_fcat5.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat5.<br />
&nbsp;&nbsp;gs_fcat5-fieldname&nbsp;=&nbsp;'WED'.<br />
&nbsp;&nbsp;gs_fcat5-coltext&nbsp;=&nbsp;'수요일'.<br />
&nbsp;&nbsp;gs_fcat5-outputlen&nbsp;&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;gs_fcat5-edit&nbsp;=&nbsp;pv_edit.<br />
&nbsp;&nbsp;gs_fcat5-qfieldname&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;gs_fcat5-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'R'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat5&nbsp;TO&nbsp;gt_fcat5.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat5.<br />
&nbsp;&nbsp;gs_fcat5-fieldname&nbsp;=&nbsp;'THU'.<br />
&nbsp;&nbsp;gs_fcat5-coltext&nbsp;=&nbsp;'목요일'.<br />
&nbsp;&nbsp;gs_fcat5-outputlen&nbsp;&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;gs_fcat5-edit&nbsp;=&nbsp;pv_edit.<br />
&nbsp;&nbsp;gs_fcat5-qfieldname&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;gs_fcat5-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'R'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat5&nbsp;TO&nbsp;gt_fcat5.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat5.<br />
&nbsp;&nbsp;gs_fcat5-fieldname&nbsp;=&nbsp;'FRI'.<br />
&nbsp;&nbsp;gs_fcat5-coltext&nbsp;=&nbsp;'금요일'.<br />
&nbsp;&nbsp;gs_fcat5-outputlen&nbsp;&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;gs_fcat5-edit&nbsp;=&nbsp;pv_edit.<br />
&nbsp;&nbsp;gs_fcat5-qfieldname&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;gs_fcat5-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'R'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat5&nbsp;TO&nbsp;gt_fcat5.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat5.<br />
&nbsp;&nbsp;gs_fcat5-fieldname&nbsp;=&nbsp;'SAT'.<br />
&nbsp;&nbsp;gs_fcat5-coltext&nbsp;=&nbsp;'토요일'.<br />
&nbsp;&nbsp;gs_fcat5-outputlen&nbsp;&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;gs_fcat5-edit&nbsp;=&nbsp;pv_edit.<br />
&nbsp;&nbsp;gs_fcat5-qfieldname&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;gs_fcat5-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'R'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat5&nbsp;TO&nbsp;gt_fcat5.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat5.<br />
&nbsp;&nbsp;gs_fcat5-fieldname&nbsp;=&nbsp;'SUN'.<br />
&nbsp;&nbsp;gs_fcat5-coltext&nbsp;=&nbsp;'일요일'.<br />
&nbsp;&nbsp;gs_fcat5-outputlen&nbsp;&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;gs_fcat5-qfieldname&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;gs_fcat5-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'R'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat5&nbsp;TO&nbsp;gt_fcat5.<br />
<br />
<br />
<br />
<br />
<br />
&nbsp;&nbsp;"&nbsp;샐&nbsp;입력&nbsp;서식&nbsp;설정<br />
&nbsp;&nbsp;IF&nbsp;gv_flag_order&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;set_cell_style_order_0110_m2.<br />
<br />
&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;set_cell_style_order_0110_m1.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
ENDFORM.<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;set_alv_event_0100<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;ALV&nbsp;에&nbsp;이벤트&nbsp;핸들러&nbsp;등록<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM set_alv_event_0100  USING io_alv_grid TYPE REF TO cl_gui_alv_grid.<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;lcl_event_handler=&gt;on_toolbar&nbsp;FOR&nbsp;io_alv_grid.<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;lcl_event_handler=&gt;on_user_command&nbsp;FOR&nbsp;io_alv_grid.<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;lcl_event_handler=&gt;on_data_changed&nbsp;FOR&nbsp;io_alv_grid.<br />
<br />
&nbsp;&nbsp;io_alv_grid-&gt;register_edit_event(<br />
&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;i_event_id&nbsp;=&nbsp;cl_gui_alv_grid=&gt;mc_evt_enter<br />
).<br />
<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Alv&nbsp;Event&nbsp;등록에&nbsp;실패했습니다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;e398(zcb_msg).<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;set_alv_event_0100<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;ALV&nbsp;에&nbsp;이벤트&nbsp;핸들러&nbsp;등록<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM set_alv_event_0110  USING io_alv_grid TYPE REF TO cl_gui_alv_grid.<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;lcl_event_handler=&gt;on_toolbar&nbsp;FOR&nbsp;io_alv_grid.<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;lcl_event_handler=&gt;on_user_command&nbsp;FOR&nbsp;io_alv_grid.<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;lcl_event_handler=&gt;on_data_changed&nbsp;FOR&nbsp;io_alv_grid.<br />
<br />
&nbsp;&nbsp;io_alv_grid-&gt;register_edit_event(<br />
EXPORTING<br />
&nbsp;i_event_id&nbsp;=&nbsp;cl_gui_alv_grid=&gt;mc_evt_enter<br />
).<br />
<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Alv&nbsp;Event&nbsp;등록에&nbsp;실패했습니다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;e398(zcb_msg).<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;alv_refresh_0100<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;ALV&nbsp;Refresh&nbsp;초기화<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM alv_refresh_0100  USING po_alv_grid TYPE REF TO cl_gui_alv_grid.<br />
&nbsp;&nbsp;IF&nbsp;po_alv_grid&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;po_alv_grid-&gt;refresh_table_display(<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is_stable&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;With&nbsp;Stable&nbsp;Rows/Columns<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_soft_refresh&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'X'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Without&nbsp;Sort,&nbsp;Filter,&nbsp;etc.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;).<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;e404(zcb_msg).<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;alv_refresh_0100_filter<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;ALV&nbsp;Refresh&nbsp;초기화<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM alv_refresh_0100_filter  USING po_alv_grid TYPE REF TO cl_gui_alv_grid.<br />
&nbsp;&nbsp;IF&nbsp;po_alv_grid&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;po_alv_grid-&gt;refresh_table_display(<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is_stable&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;With&nbsp;Stable&nbsp;Rows/Columns<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_soft_refresh&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'X'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Without&nbsp;Sort,&nbsp;Filter,&nbsp;etc.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;).<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;e404(zcb_msg).<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;set_mps_mrp_alv<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;PLAF&nbsp;ALV&nbsp;에서&nbsp;전체&nbsp;데이터에&nbsp;대한&nbsp;자재&nbsp;소요량&nbsp;계산<br />
*&&nbsp;zcb_cds_mrpmps&nbsp;CDS&nbsp;VIEW&nbsp;를&nbsp;사용하여&nbsp;필요자재&nbsp;/&nbsp;보유자재&nbsp;정보를&nbsp;가져온다.<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM set_mps_mrp_alv .<br />
&nbsp;&nbsp;"&nbsp;몇&nbsp;주차&nbsp;인지&nbsp;받아오는&nbsp;변수<br />
&nbsp;&nbsp;DATA:&nbsp;lv_week&nbsp;TYPE&nbsp;zcb_pyeek.<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;gs_plaf.<br />
<br />
&nbsp;&nbsp;"&nbsp;첫&nbsp;번째&nbsp;행의&nbsp;주차를&nbsp;가져온다(&nbsp;gt_plaf&nbsp;가&nbsp;동일한&nbsp;주차임)<br />
&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_plaf&nbsp;INTO&nbsp;gs_plaf&nbsp;INDEX&nbsp;1.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;년도기준&nbsp;조회된&nbsp;값이&nbsp;없습니다.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;i405(zcb_msg)&nbsp;DISPLAY&nbsp;LIKE&nbsp;'W'&nbsp;WITH&nbsp;'생산계획&nbsp;INDEX&nbsp;1에'.<br />
*&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;lv_week&nbsp;=&nbsp;gs_plaf-pyeek.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
&nbsp;&nbsp;REFRESH:&nbsp;gt_mps_mrp_group.<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;&nbsp;week,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;주차<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;werks,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;플랜트<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matnrcomponent,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;생산자재<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;component_desc,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;생산자재명<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;totalqty,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;생산수량<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;currentstock,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;재고수량<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bomu,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;단위<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fresh,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;신선식품&nbsp;구분<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;procurementtype&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;MRP&nbsp;type&nbsp;구분&nbsp;(자채생산,&nbsp;외부조달)<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;zcb_cds_mrpmps_group<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;@gt_mps_mrp_group<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;week&nbsp;=&nbsp;@lv_week<br />
&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;totalqty&nbsp;&gt;&nbsp;0<br />
&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;procurementtype&nbsp;&lt;&gt;&nbsp;''.<br />
<br />
<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;e400(zcb_msg)&nbsp;WITH&nbsp;'필요자재&nbsp;계산'.<br />
<br />
&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SORT&nbsp;gt_mps_mrp_group&nbsp;BY&nbsp;week.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
&nbsp;&nbsp;"&nbsp;자재군&nbsp;FRESH&nbsp;의&nbsp;경우&nbsp;화면에&nbsp;선택된&nbsp;일자&nbsp;만큼&nbsp;주당&nbsp;발주를&nbsp;진행한다.<br />
&nbsp;&nbsp;"&nbsp;자재군&nbsp;FRESH&nbsp;의&nbsp;경우&nbsp;신선&nbsp;제품임으로&nbsp;기존의&nbsp;재고를&nbsp;무시하고&nbsp;발주를&nbsp;진행한다.<br />
&nbsp;&nbsp;"&nbsp;나머지&nbsp;일반&nbsp;자재군은&nbsp;MRP&nbsp;기간&nbsp;중&nbsp;1회만&nbsp;주문을&nbsp;진행한다.<br />
&nbsp;&nbsp;PERFORM&nbsp;calc_mrp_order_qty.<br />
<br />
&nbsp;&nbsp;"&nbsp;itab&nbsp;변경값&nbsp;적용을&nbsp;위한&nbsp;&nbsp;alv&nbsp;초기화<br />
&nbsp;&nbsp;PERFORM&nbsp;alv_refresh_0100&nbsp;USING&nbsp;go_alv_grid2.<br />
<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;MESSAGE&nbsp;'set_mps_mrp_alv'&nbsp;TYPE&nbsp;'S'.<br />
<br />
   </div>
   <div class="code">
ENDFORM.<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;calc_mrp_order_qty<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;설정된&nbsp;발주&nbsp;간격,&nbsp;안전재고량을&nbsp;반영하여&nbsp;부족&nbsp;수량을&nbsp;계산한다.<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM calc_mrp_order_qty .<br />
&nbsp;&nbsp;gv_check_date_sums&nbsp;=&nbsp;1.<br />
&nbsp;&nbsp;IF&nbsp;gv_check8&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;전체&nbsp;요일&nbsp;선택&nbsp;시&nbsp;→&nbsp;발주&nbsp;일수는&nbsp;무조건&nbsp;7일<br />
&nbsp;&nbsp;&nbsp;&nbsp;gv_check_date_sums&nbsp;=&nbsp;7.<br />
<br />
&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;개별&nbsp;요일&nbsp;체크&nbsp;수&nbsp;계산<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gv_check1&nbsp;=&nbsp;'X'.&nbsp;gv_check_date_sums&nbsp;+=&nbsp;1.&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gv_check2&nbsp;=&nbsp;'X'.&nbsp;gv_check_date_sums&nbsp;+=&nbsp;1.&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gv_check3&nbsp;=&nbsp;'X'.&nbsp;gv_check_date_sums&nbsp;+=&nbsp;1.&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gv_check4&nbsp;=&nbsp;'X'.&nbsp;gv_check_date_sums&nbsp;+=&nbsp;1.&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gv_check5&nbsp;=&nbsp;'X'.&nbsp;gv_check_date_sums&nbsp;+=&nbsp;1.&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gv_check6&nbsp;=&nbsp;'X'.&nbsp;gv_check_date_sums&nbsp;+=&nbsp;1.&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gv_check7&nbsp;=&nbsp;'X'.&nbsp;gv_check_date_sums&nbsp;+=&nbsp;1.&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;아무&nbsp;요일도&nbsp;채크&nbsp;안되어&nbsp;있으면.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;일반&nbsp;자재&nbsp;처럼&nbsp;MRP&nbsp;기간중&nbsp;1회&nbsp;발주&nbsp;적용<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gv_check_date_sums&nbsp;&gt;&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gv_check_date_sums&nbsp;-=&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_mps_mrp_group&nbsp;INTO&nbsp;gs_mps_mrp_group.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;신선품인&nbsp;경우&nbsp;(FRESH&nbsp;필드가&nbsp;'FRESH'일&nbsp;때)<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;RM100&nbsp;~&nbsp;RM102&nbsp;는&nbsp;살아&nbsp;있는&nbsp;닭임으로&nbsp;당일에&nbsp;모두&nbsp;도축이&nbsp;될&nbsp;예정이다.&nbsp;그럼으로&nbsp;재고&nbsp;수량을&nbsp;고려안한다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;신선식품&nbsp;중&nbsp;살아&nbsp;있는&nbsp;닭은&nbsp;남아&nbsp;있는&nbsp;재고를&nbsp;고려안하고&nbsp;그대로&nbsp;발주함.(나중에&nbsp;그냥&nbsp;수동으로&nbsp;생산오더&nbsp;진행해서&nbsp;재고를&nbsp;반재품&nbsp;전환)<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;신선식품&nbsp;중&nbsp;반제품&nbsp;(ex&nbsp;닭다리살)&nbsp;같은&nbsp;경우는&nbsp;재고를&nbsp;고려<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;부족&nbsp;수량&nbsp;계산&nbsp;=&nbsp;필요량&nbsp;-&nbsp;현재고<br />
&nbsp;&nbsp;&nbsp;&nbsp;DATA(lv_gap_qty)&nbsp;=&nbsp;gs_mps_mrp_group-totalqty&nbsp;-&nbsp;gs_mps_mrp_group-currentstock.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;lv_gap_qty&nbsp;&lt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_gap_qty&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;신석&nbsp;식품일&nbsp;경우<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_mps_mrp_group-fresh&nbsp;=&nbsp;'FRESH'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;발주&nbsp;일&nbsp;수&nbsp;설정&nbsp;(선택된&nbsp;요일&nbsp;수)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_mps_mrp_group-ordergap&nbsp;=&nbsp;gv_check_date_sums.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;하루&nbsp;단위&nbsp;발주&nbsp;수량&nbsp;=&nbsp;주간&nbsp;필요량&nbsp;/&nbsp;발주일수<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gv_check_date_sums&nbsp;&gt;&nbsp;0.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_mps_mrp_group-orderqty&nbsp;=&nbsp;gs_mps_mrp_group-totalqty&nbsp;/&nbsp;gv_check_date_sums.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_mps_mrp_group-orderqty&nbsp;=&nbsp;lv_gap_qty&nbsp;/&nbsp;gv_check_date_sums.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_mps_mrp_group-orderqty&nbsp;=&nbsp;0.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_mps_mrp_group-orderqty&nbsp;=&nbsp;lv_gap_qty.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;일반&nbsp;자재인&nbsp;경우<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_mps_mrp_group-ordergap&nbsp;=&nbsp;1.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;부족&nbsp;수량&nbsp;계산&nbsp;=&nbsp;필요량&nbsp;-&nbsp;현재고<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA(lv_gap_qty)&nbsp;=&nbsp;gs_mps_mrp_group-totalqty&nbsp;-&nbsp;gs_mps_mrp_group-currentstock.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;lv_gap_qty&nbsp;&lt;&nbsp;0.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_gap_qty&nbsp;=&nbsp;0.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;발주&nbsp;수량&nbsp;=&nbsp;부족분&nbsp;/&nbsp;발주주기&nbsp;(기본&nbsp;1회)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_mps_mrp_group-ordergap&nbsp;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_mps_mrp_group-orderqty&nbsp;=&nbsp;lv_gap_qty&nbsp;/&nbsp;gs_mps_mrp_group-ordergap.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_mps_mrp_group-orderqty&nbsp;=&nbsp;lv_gap_qty.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;재고&nbsp;현황&nbsp;대비&nbsp;경고&nbsp;색&nbsp;청구<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_mps_mrp_group-currentstock&nbsp;-&nbsp;gs_mps_mrp_group-totalqty&nbsp;&lt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;재고&nbsp;수량이&nbsp;필요수량&nbsp;이하일&nbsp;경우<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;자재&nbsp;부족&nbsp;빨간&nbsp;줄<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_mps_mrp_group-rowcolor&nbsp;=&nbsp;gc_color_red1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;gs_mps_mrp_group-currentstock&nbsp;&lt;&nbsp;gs_mps_mrp_group-totalqty&nbsp;*&nbsp;2.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;재고&nbsp;수량이&nbsp;피ㄹ요수량의&nbsp;&nbsp;2배&nbsp;이하&nbsp;~&nbsp;필요수량&nbsp;사이일&nbsp;경우<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;자재&nbsp;부족&nbsp;경고노랑&nbsp;줄<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_mps_mrp_group-rowcolor&nbsp;=&nbsp;gc_color_yellow2.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;gt_mps_mrp_group&nbsp;FROM&nbsp;gs_mps_mrp_group.<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;set_alv_container_0100<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;Split&nbsp;and&nbsp;Docking&nbsp;Container<br />
*&&nbsp;화면을&nbsp;4분할&nbsp;한다.<br />
*&&nbsp;Docking&nbsp;Container를&nbsp;적용하여&nbsp;화면의&nbsp;크기를&nbsp;수동으로&nbsp;설정&nbsp;가능하게&nbsp;한다.<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM set_alv_container_0100 .<br />
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;go_custom_cont<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;container_name&nbsp;=&nbsp;'CCON'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Name&nbsp;of&nbsp;the&nbsp;Screen&nbsp;CustCtrl&nbsp;Name&nbsp;to&nbsp;Link&nbsp;Container&nbsp;To<br />
<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Custom&nbsp;Container&nbsp;설정중&nbsp;Error가&nbsp;발생하였습니다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;e409(zcb_msg).<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
&nbsp;&nbsp;"&nbsp;먼저&nbsp;전체&nbsp;화면을&nbsp;좌우로&nbsp;분할&nbsp;(2개&nbsp;열)<br />
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;go_split<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parent&nbsp;&nbsp;=&nbsp;go_custom_cont<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rows&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;1개의&nbsp;가로(행)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;columns&nbsp;=&nbsp;2.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;2개의&nbsp;세로(열)&nbsp;-&nbsp;좌우&nbsp;분할<br />
<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Split&nbsp;Container&nbsp;설정&nbsp;중&nbsp;Error&nbsp;가&nbsp;발생하였습니다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;e410(zcb_msg).<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;go_split-&gt;set_column_mode<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mode&nbsp;=&nbsp;cl_gui_splitter_container=&gt;mode_relative.<br />
   </div>
   <div class="codeComment">
*<br />
   </div>
   <div class="code">
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Split&nbsp;Container&nbsp;설정&nbsp;중&nbsp;Error&nbsp;가&nbsp;발생하였습니다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;e410(zcb_msg).<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
&nbsp;&nbsp;"&nbsp;좌측&nbsp;컨테이너&nbsp;가져오기<br />
&nbsp;&nbsp;go_split-&gt;get_container(<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;column&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RECEIVING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;container&nbsp;=&nbsp;go_left_cont&nbsp;).<br />
<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Split&nbsp;Container&nbsp;설정&nbsp;중&nbsp;Error&nbsp;가&nbsp;발생하였습니다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;e410(zcb_msg).<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
&nbsp;&nbsp;"&nbsp;우측&nbsp;컨테이너&nbsp;가져오기<br />
&nbsp;&nbsp;go_split-&gt;get_container(<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;column&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2<br />
&nbsp;&nbsp;&nbsp;&nbsp;RECEIVING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;container&nbsp;=&nbsp;go_right_cont&nbsp;).<br />
<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Split&nbsp;Container&nbsp;설정&nbsp;중&nbsp;Error&nbsp;가&nbsp;발생하였습니다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;e410(zcb_msg).<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
&nbsp;&nbsp;"&nbsp;좌측&nbsp;너비&nbsp;설정&nbsp;%<br />
&nbsp;&nbsp;go_split-&gt;set_column_width(<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;id&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;width&nbsp;=&nbsp;70&nbsp;).<br />
<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Split&nbsp;Container&nbsp;설정&nbsp;중&nbsp;Error&nbsp;가&nbsp;발생하였습니다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;e410(zcb_msg).<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
&nbsp;&nbsp;"&nbsp;좌측&nbsp;컨테이너를&nbsp;상하로&nbsp;다시&nbsp;분할<br />
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;go_left_split<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parent&nbsp;&nbsp;=&nbsp;go_left_cont<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rows&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;2개의&nbsp;가로(행)&nbsp;-&nbsp;상하&nbsp;분할<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;columns&nbsp;=&nbsp;1.<br />
<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Split&nbsp;Container&nbsp;설정&nbsp;중&nbsp;Error&nbsp;가&nbsp;발생하였습니다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;e410(zcb_msg).<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
&nbsp;&nbsp;"&nbsp;좌측&nbsp;컨테이너&nbsp;높이&nbsp;설정<br />
&nbsp;&nbsp;go_left_split-&gt;set_row_height(<br />
&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;id&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;첫&nbsp;번째&nbsp;행&nbsp;(상단&nbsp;컨테이너)<br />
&nbsp;&nbsp;&nbsp;&nbsp;height&nbsp;=&nbsp;40&nbsp;&nbsp;&nbsp;"&nbsp;높이&nbsp;비율&nbsp;(%&nbsp;단위&nbsp;아님,&nbsp;내부&nbsp;기준&nbsp;값)<br />
&nbsp;&nbsp;&nbsp;&nbsp;).&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;1개의&nbsp;세로(열)<br />
<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Split&nbsp;Container&nbsp;설정&nbsp;중&nbsp;Error&nbsp;가&nbsp;발생하였습니다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;e410(zcb_msg).<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
&nbsp;&nbsp;"&nbsp;좌측&nbsp;상단&nbsp;컨테이너<br />
&nbsp;&nbsp;go_left_split-&gt;get_container(<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;column&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;RECEIVING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;container&nbsp;=&nbsp;go_container1&nbsp;).<br />
<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Split&nbsp;Container&nbsp;설정&nbsp;중&nbsp;Error&nbsp;가&nbsp;발생하였습니다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;e410(zcb_msg).<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
&nbsp;&nbsp;"&nbsp;좌측&nbsp;하단&nbsp;컨테이너<br />
&nbsp;&nbsp;go_left_split-&gt;get_container(<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;column&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;RECEIVING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;container&nbsp;=&nbsp;go_container2&nbsp;).<br />
<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Split&nbsp;Container&nbsp;설정&nbsp;중&nbsp;Error&nbsp;가&nbsp;발생하였습니다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;e410(zcb_msg).<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
&nbsp;&nbsp;"&nbsp;우측&nbsp;컨테이너를&nbsp;상하로&nbsp;다시&nbsp;분할<br />
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;go_right_split<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parent&nbsp;&nbsp;=&nbsp;go_right_cont<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rows&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;2개의&nbsp;가로(행)&nbsp;-&nbsp;상하&nbsp;분할<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;columns&nbsp;=&nbsp;1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;1개의&nbsp;세로(열)<br />
<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Split&nbsp;Container&nbsp;설정&nbsp;중&nbsp;Error&nbsp;가&nbsp;발생하였습니다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;e410(zcb_msg).<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
&nbsp;&nbsp;"&nbsp;우측&nbsp;컨테이너&nbsp;높이&nbsp;설정<br />
&nbsp;&nbsp;go_right_split-&gt;set_row_height(<br />
&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;id&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;첫&nbsp;번째&nbsp;행&nbsp;(상단&nbsp;컨테이너)<br />
&nbsp;&nbsp;&nbsp;&nbsp;height&nbsp;=&nbsp;40&nbsp;&nbsp;&nbsp;"&nbsp;높이&nbsp;비율&nbsp;(%&nbsp;단위&nbsp;아님,&nbsp;내부&nbsp;기준&nbsp;값)<br />
&nbsp;&nbsp;&nbsp;&nbsp;).<br />
<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Split&nbsp;Container&nbsp;설정&nbsp;중&nbsp;Error&nbsp;가&nbsp;발생하였습니다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;e410(zcb_msg).<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
&nbsp;&nbsp;"&nbsp;우측&nbsp;상단&nbsp;컨테이너<br />
&nbsp;&nbsp;go_right_split-&gt;get_container(<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;column&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;RECEIVING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;container&nbsp;=&nbsp;go_container3&nbsp;).<br />
<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Split&nbsp;Container&nbsp;설정&nbsp;중&nbsp;Error&nbsp;가&nbsp;발생하였습니다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;e410(zcb_msg).<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
&nbsp;&nbsp;"&nbsp;우측&nbsp;하단&nbsp;컨테이너<br />
&nbsp;&nbsp;go_right_split-&gt;get_container(<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;column&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;RECEIVING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;container&nbsp;=&nbsp;go_container4&nbsp;).<br />
<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Split&nbsp;Container&nbsp;설정&nbsp;중&nbsp;Error&nbsp;가&nbsp;발생하였습니다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;e410(zcb_msg).<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;set_alv_grid_0100<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;ALV&nbsp;를&nbsp;설정한다.<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM set_alv_grid_0100 USING p_structure TYPE dd02l-tabname<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ps_variant&nbsp;TYPE&nbsp;disvariant<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p_save&nbsp;TYPE&nbsp;c<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ps_layo&nbsp;TYPE&nbsp;&nbsp;&nbsp;lvc_s_layo<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;ct_outtab&nbsp;TYPE&nbsp;ANY&nbsp;TABLE<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ct_fieldcat&nbsp;TYPE&nbsp;lvc_t_fcat<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ct_filter&nbsp;&nbsp;TYPE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lvc_t_filt<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ct_sort&nbsp;&nbsp;&nbsp;TYPE&nbsp;lvc_t_sort<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;co_container&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;cl_gui_container<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;co_alv_grid&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;&nbsp;cl_gui_alv_grid.<br />
<br />
&nbsp;&nbsp;"&nbsp;컨테이너에&nbsp;ALV&nbsp;그리드&nbsp;생성<br />
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;co_alv_grid<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_appl_events&nbsp;=&nbsp;'X'&nbsp;"&nbsp;이벤트&nbsp;작동시&nbsp;화면&nbsp;pbo&nbsp;실행<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_parent&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;co_container.<br />
<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;ALV&nbsp;설정&nbsp;중&nbsp;Error&nbsp;가&nbsp;발생하였습니다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;e411(zcb_msg).<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;"&nbsp;ALV&nbsp;에&nbsp;값을&nbsp;설정한다.<br />
&nbsp;&nbsp;co_alv_grid-&gt;set_table_for_first_display(<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_buffer_active&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;'X'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Buffering&nbsp;Active<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_bypassing_buffer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;'X'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Switch&nbsp;Off&nbsp;Buffer<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_structure_name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;p_structure&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Internal&nbsp;Output&nbsp;Table&nbsp;Structure&nbsp;Name<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is_variant&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;ps_variant&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Layout<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_save&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;p_save&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Save&nbsp;Layout<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is_layout&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;ps_layo&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Layout<br />
&nbsp;&nbsp;&nbsp;&nbsp;CHANGING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it_outtab&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;ct_outtab&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Output&nbsp;Table<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it_fieldcatalog&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;ct_fieldcat&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Field&nbsp;Catalog<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it_sort&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;ct_sort&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Sort&nbsp;Criteria<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it_filter&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;ct_filter&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Filter&nbsp;Criteria<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;).<br />
<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;ALV&nbsp;설정&nbsp;중&nbsp;Error&nbsp;가&nbsp;발생하였습니다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;e411(zcb_msg).<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
ENDFORM.<br />
<br />
FORM set_alv_grid_0110 USING p_structure TYPE dd02l-tabname<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ps_variant&nbsp;TYPE&nbsp;disvariant<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p_save&nbsp;TYPE&nbsp;c<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ps_layo&nbsp;TYPE&nbsp;&nbsp;&nbsp;lvc_s_layo<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;ct_outtab&nbsp;TYPE&nbsp;ANY&nbsp;TABLE<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ct_fieldcat&nbsp;TYPE&nbsp;lvc_t_fcat<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ct_filter&nbsp;&nbsp;TYPE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lvc_t_filt<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ct_sort&nbsp;&nbsp;&nbsp;TYPE&nbsp;lvc_t_sort<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;co_container&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;cl_gui_custom_container<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;co_alv_grid&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;&nbsp;cl_gui_alv_grid.<br />
<br />
<br />
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;co_container<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;container_name&nbsp;=&nbsp;'CCON2'.<br />
<br />
&nbsp;&nbsp;"&nbsp;컨테이너에&nbsp;ALV&nbsp;그리드&nbsp;생성<br />
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;co_alv_grid<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_parent&nbsp;=&nbsp;co_container.<br />
<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;ALV&nbsp;설정&nbsp;중&nbsp;Error&nbsp;가&nbsp;발생하였습니다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;e411(zcb_msg).<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;"&nbsp;ALV&nbsp;에&nbsp;값을&nbsp;설정한다.<br />
&nbsp;&nbsp;co_alv_grid-&gt;set_table_for_first_display(<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_buffer_active&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;'X'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Buffering&nbsp;Active<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_bypassing_buffer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;'X'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Switch&nbsp;Off&nbsp;Buffer<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_structure_name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;p_structure&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Internal&nbsp;Output&nbsp;Table&nbsp;Structure&nbsp;Name<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is_variant&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;ps_variant&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Layout<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_save&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;p_save&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Save&nbsp;Layout<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is_layout&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;ps_layo&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Layout<br />
&nbsp;&nbsp;&nbsp;&nbsp;CHANGING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it_outtab&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;ct_outtab&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Output&nbsp;Table<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it_fieldcatalog&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;ct_fieldcat&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Field&nbsp;Catalog<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it_sort&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;ct_sort&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Sort&nbsp;Criteria<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it_filter&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;ct_filter&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Filter&nbsp;Criteria<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;).<br />
<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;ALV&nbsp;설정&nbsp;중&nbsp;Error&nbsp;가&nbsp;발생하였습니다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;e411(zcb_msg).<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;set_mps_header<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;MRP&nbsp;Header&nbsp;ITAB&nbsp;설정<br />
*&nbsp;주차를&nbsp;기준으로&nbsp;날짜를&nbsp;계산함<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM set_mrp_header.<br />
<br />
&nbsp;&nbsp;REFRESH&nbsp;gt_mdkp.<br />
&nbsp;&nbsp;CLEAR:&nbsp;gs_plaf,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_mdkp.<br />
<br />
&nbsp;&nbsp;"&nbsp;MRP&nbsp;수행&nbsp;일자&nbsp;등록을&nbsp;위한&nbsp;지역&nbsp;변수<br />
&nbsp;&nbsp;DATA:&nbsp;lv_week&nbsp;TYPE&nbsp;scal-week,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_date&nbsp;TYPE&nbsp;scal-date.<br />
<br />
&nbsp;&nbsp;"&nbsp;순서&nbsp;기록을&nbsp;위한&nbsp;변수&nbsp;(&nbsp;노출은&nbsp;안됨&nbsp;)<br />
&nbsp;&nbsp;DATA:&nbsp;lv_number&nbsp;TYPE&nbsp;i&nbsp;VALUE&nbsp;1.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_plaf&nbsp;INTO&nbsp;gs_plaf.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_plaf-rowcolor&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_mdkp-dtnum&nbsp;=&nbsp;lv_number.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;임시&nbsp;아이디<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_mdkp-werks&nbsp;=&nbsp;gs_plaf-plwrk.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;플랜트<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_mdkp-plnum&nbsp;=&nbsp;gs_plaf-plnum.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;행번호<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_mdkp-matnr&nbsp;=&nbsp;gs_plaf-plmat.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;자재번호<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_mdkp-gsmng&nbsp;=&nbsp;ceil(&nbsp;gs_plaf-gsmng&nbsp;*&nbsp;(&nbsp;(&nbsp;100&nbsp;+&nbsp;&nbsp;gv_input1&nbsp;)&nbsp;/&nbsp;100&nbsp;)&nbsp;).&nbsp;"&nbsp;설정한&nbsp;안전&nbsp;재고율을&nbsp;반영한다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_mdkp-meins&nbsp;=&nbsp;gs_plaf-meins.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;단위<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_mdkp-maktx&nbsp;=&nbsp;gs_plaf-maktx.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;한글명<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;MRP&nbsp;수행일&nbsp;자를&nbsp;계산하기&nbsp;위한&nbsp;함수<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;년도+주차를&nbsp;사용하여&nbsp;일자를&nbsp;계산함.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_week&nbsp;=&nbsp;|{&nbsp;gs_plaf-pyear&nbsp;}{&nbsp;gs_plaf-pyeek&nbsp;ALPHA&nbsp;=&nbsp;OUT&nbsp;}|.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'WEEK_GET_FIRST_DAY'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;week&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lv_week&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Week&nbsp;for&nbsp;which&nbsp;the&nbsp;date&nbsp;is&nbsp;to&nbsp;be&nbsp;determined<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;date&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lv_date&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Date&nbsp;of&nbsp;the&nbsp;first&nbsp;day&nbsp;of&nbsp;the&nbsp;week<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;week_invalid&nbsp;=&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Week&nbsp;was&nbsp;incorrectly&nbsp;specified<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;주차&nbsp;기준으로&nbsp;날자를&nbsp;가져오는데&nbsp;실패했습니다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;e412(zcb_msg).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_mdkp-dsdat&nbsp;=&nbsp;lv_date.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_mdkp-dedat&nbsp;=&nbsp;lv_date&nbsp;+&nbsp;6.<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;gs_mdkp&nbsp;TO&nbsp;gt_mdkp.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_number&nbsp;+=&nbsp;1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;"&nbsp;alv&nbsp;초기화로<br />
&nbsp;&nbsp;PERFORM&nbsp;alv_refresh_0100&nbsp;USING&nbsp;go_alv_grid3.<br />
<br />
<br />
ENDFORM.<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;set_mrp_item<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;MRP&nbsp;Header(gt_mdkp)&nbsp;기준으로&nbsp;MRP&nbsp;Item(gt_mps_mrp)을&nbsp;계산한다.<br />
*&&nbsp;BOM&nbsp;구조(ZCB_STPO/STKO)를&nbsp;통해&nbsp;부품&nbsp;요구량을&nbsp;계산하고<br />
*&&nbsp;현재&nbsp;재고(ZCB_MARD),&nbsp;조달&nbsp;방식(ZCB_MARC),&nbsp;FRESH&nbsp;여부&nbsp;등을&nbsp;반영한다.<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM set_mrp_item.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;"&nbsp;우선&nbsp;역&nbsp;bom&nbsp;의&nbsp;경우&nbsp;최대&nbsp;생산량을&nbsp;기준으로&nbsp;닭을&nbsp;구매&nbsp;요청을함<br />
*&nbsp;&nbsp;"&nbsp;아이탬에는&nbsp;수요에&nbsp;맞게만&nbsp;입고된다고&nbsp;입력함.<br />
*&nbsp;&nbsp;"&nbsp;나머지&nbsp;추가분이나.&nbsp;MRP&nbsp;에&nbsp;없는&nbsp;나머지&nbsp;반제품&nbsp;들은&nbsp;생산실적에서&nbsp;입고처리를&nbsp;시킴.<br />
*&nbsp;&nbsp;"&nbsp;해체&nbsp;기준&nbsp;생닭은&nbsp;가장&nbsp;많은&nbsp;닭을&nbsp;요구하는&nbsp;제품&nbsp;기준으로&nbsp;그&nbsp;제품&nbsp;mrp&nbsp;아이탬에&nbsp;기록한다.<br />
*&nbsp;&nbsp;"&nbsp;이때&nbsp;반제품&nbsp;생산용&nbsp;살아&nbsp;있는&nbsp;닭도&nbsp;안전재고율&nbsp;고려.<br />
*&nbsp;&nbsp;"&nbsp;반제품들은&nbsp;생산요청을&nbsp;함,&nbsp;나머지&nbsp;원재료들은&nbsp;구매요청을&nbsp;실시.<br />
*&nbsp;&nbsp;"&nbsp;지금&nbsp;고민인게&nbsp;FRESH&nbsp;제품들은&nbsp;주&nbsp;7일&nbsp;생산을&nbsp;하려함.&nbsp;&nbsp;FRESH&nbsp;필드를&nbsp;아이탬에&nbsp;추가해서&nbsp;이거&nbsp;기준으로&nbsp;구매&nbsp;문서,&nbsp;생산요청을&nbsp;발행하자<br />
*&nbsp;&nbsp;"&nbsp;주&nbsp;1회&nbsp;주문&nbsp;요청일&nbsp;경우&nbsp;월요일에&nbsp;주문&nbsp;요청이&nbsp;들어감<br />
*&nbsp;&nbsp;"&nbsp;만약&nbsp;역&nbsp;BOM&nbsp;자재를&nbsp;공통으로&nbsp;사용하는&nbsp;다른&nbsp;재품있을&nbsp;경우<br />
*&nbsp;&nbsp;"<br />
*<br />
*&nbsp;&nbsp;"&nbsp;이러면&nbsp;고민&nbsp;사항이&nbsp;크게&nbsp;2가지가&nbsp;있음<br />
*&nbsp;&nbsp;"&nbsp;1.&nbsp;살아있는&nbsp;닭도&nbsp;원자재&nbsp;처럼&nbsp;유통기한&nbsp;10일&nbsp;자재로&nbsp;취급<br />
*&nbsp;&nbsp;"&nbsp;2.&nbsp;생산&nbsp;계획만큼&nbsp;닭을&nbsp;바로&nbsp;컨베이너&nbsp;밸트에&nbsp;넣고<br />
*&nbsp;&nbsp;"&nbsp;&nbsp;&nbsp;&nbsp;그래도&nbsp;남으면&nbsp;그냥&nbsp;닭&nbsp;신선식품에&nbsp;나머지&nbsp;수량만큼&nbsp;그냥&nbsp;수동으로&nbsp;생산오더&nbsp;발생<br />
*&nbsp;&nbsp;"&nbsp;3.&nbsp;유통기한&nbsp;임박&nbsp;자재&nbsp;너겟&nbsp;처리가&nbsp;문재&nbsp;닭이&nbsp;총&nbsp;3&nbsp;사이즈가&nbsp;있음<br />
*&nbsp;&nbsp;"&nbsp;&nbsp;&nbsp;&nbsp;그냥&nbsp;생닭&nbsp;포장&nbsp;재품&nbsp;남으면&nbsp;호수&nbsp;(3개&nbsp;있음)&nbsp;와&nbsp;포장&nbsp;상태&nbsp;고려안하고,<br />
*&nbsp;&nbsp;"&nbsp;&nbsp;&nbsp;&nbsp;그냥&nbsp;무개를&nbsp;전부다&nbsp;+&nbsp;하여&nbsp;유통기한&nbsp;임박&nbsp;자재로&nbsp;전환하여&nbsp;생산&nbsp;투입.<br />
*<br />
   </div>
   <div class="code">
&nbsp;&nbsp;DATA:&nbsp;BEGIN&nbsp;OF&nbsp;ls_mrp_calc,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dtnum&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zcb_dtnum,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;임시&nbsp;MRP&nbsp;아이디<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;werks&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zcb_werks_d,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;플랜트<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matnrtop&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zcb_matnr,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;생산자재<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;planqty&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zcb_gsmng,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;생산수량<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;planuom&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zcb_meins,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;단위<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matnrcomponent&nbsp;&nbsp;TYPE&nbsp;zcb_stpo-idnrk,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;BOM투입자재<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bom_menge&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zcb_stpo-menge,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;BOM투입수량<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matnr_menge&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zcb_stpo-menge,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;BOM단위<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;currentstock&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zcb_mard-labst,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;현&nbsp;재고<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bomu&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zcb_stpo-meins,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;재고&nbsp;단위<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fresh&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zcb_marc-ofreq,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;신석식품&nbsp;구분<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;procurementtype&nbsp;TYPE&nbsp;zcb_marc-beskz,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;MRP&nbsp;타입&nbsp;구분<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;requqty&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;p&nbsp;LENGTH&nbsp;13&nbsp;DECIMALS&nbsp;3,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;총&nbsp;투입&nbsp;필요&nbsp;수량<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shortage_qty&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;p&nbsp;LENGTH&nbsp;13&nbsp;DECIMALS&nbsp;3,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;부족수량<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;ls_mrp_calc.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lt_mrp_calc&nbsp;LIKE&nbsp;TABLE&nbsp;OF&nbsp;ls_mrp_calc,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_mdkp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LIKE&nbsp;gs_mdkp.<br />
<br />
&nbsp;&nbsp;"&nbsp;MRP&nbsp;Header&nbsp;기준으로&nbsp;반복<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_mdkp&nbsp;INTO&nbsp;ls_mdkp.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@ls_mdkp-werks&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AS&nbsp;werks,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@ls_mdkp-matnr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AS&nbsp;matnrtop,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@ls_mdkp-gsmng&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AS&nbsp;planqty,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@ls_mdkp-meins&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AS&nbsp;planuom,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c~idnrk&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AS&nbsp;matnrcomponent,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c~menge&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AS&nbsp;bom_menge,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d~labst&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AS&nbsp;currentstock,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c~meins&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AS&nbsp;bomu,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b~menge&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AS&nbsp;matnr_menge,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e~ofreq&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AS&nbsp;fresh,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e~beskz&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AS&nbsp;procurementtype<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;@ls_mrp_calc<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;zcb_stko&nbsp;AS&nbsp;b<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INNER&nbsp;JOIN&nbsp;zcb_stpo&nbsp;AS&nbsp;c&nbsp;ON&nbsp;c~stlnr&nbsp;=&nbsp;b~stlnr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;c~lvorm&nbsp;=&nbsp;''<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;c~datuv&nbsp;&lt;=&nbsp;@sy-datum<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;c~datub&nbsp;&gt;=&nbsp;@sy-datum<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEFT&nbsp;OUTER&nbsp;JOIN&nbsp;zcb_mard&nbsp;AS&nbsp;d&nbsp;ON&nbsp;d~matnr&nbsp;=&nbsp;c~idnrk&nbsp;AND&nbsp;d~werks&nbsp;=&nbsp;@ls_mdkp-werks<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEFT&nbsp;OUTER&nbsp;JOIN&nbsp;zcb_marc&nbsp;AS&nbsp;e&nbsp;ON&nbsp;e~matnr&nbsp;=&nbsp;c~idnrk&nbsp;AND&nbsp;e~werks&nbsp;=&nbsp;@ls_mdkp-werks<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;b~mantr&nbsp;=&nbsp;@ls_mdkp-matnr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;b~werks&nbsp;=&nbsp;@ls_mdkp-werks<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;b~lvorm&nbsp;=&nbsp;''<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;b~datuv&nbsp;&lt;=&nbsp;@sy-datum<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;b~datub&nbsp;&gt;=&nbsp;@sy-datum.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;e400(zcb_msg)&nbsp;WITH&nbsp;'STPO&nbsp;STKO'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_mrp_calc-dtnum&nbsp;=&nbsp;ls_mdkp-dtnum.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;필요&nbsp;수량&nbsp;계산<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;EA&nbsp;,&nbsp;KG&nbsp;등&nbsp;단위&nbsp;환산<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;ls_mrp_calc-bomu&nbsp;=&nbsp;'EA'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_mrp_calc-requqty&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ceil(&nbsp;ls_mdkp-gsmng&nbsp;*&nbsp;ls_mrp_calc-bom_menge&nbsp;).&nbsp;"&nbsp;생산수량&nbsp;*&nbsp;&nbsp;BOM당&nbsp;투입&nbsp;량<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_mrp_calc-requqty&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ceil(&nbsp;(&nbsp;ls_mdkp-gsmng&nbsp;*&nbsp;ls_mrp_calc-bom_menge&nbsp;)&nbsp;/&nbsp;ls_mrp_calc-matnr_menge&nbsp;).&nbsp;"&nbsp;(생산수량&nbsp;*&nbsp;BOM당&nbsp;투입&nbsp;량&nbsp;)&nbsp;/&nbsp;bom&nbsp;단위<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_mrp_calc-shortage_qty&nbsp;=&nbsp;ls_mrp_calc-requqty&nbsp;-&nbsp;ls_mrp_calc-currentstock.&nbsp;"&nbsp;부족분&nbsp;계산&nbsp;:&nbsp;총&nbsp;필요수량&nbsp;-&nbsp;재고수량<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;ls_mrp_calc-shortage_qty&nbsp;&lt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_mrp_calc-shortage_qty&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_mrp_calc&nbsp;TO&nbsp;lt_mrp_calc.<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDSELECT.<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;gt_mps_mrp.<br />
<br />
&nbsp;&nbsp;"&nbsp;MPS&nbsp;로&nbsp;필요한&nbsp;BOM&nbsp;수량&nbsp;및&nbsp;자재&nbsp;현황&nbsp;TAB&nbsp;에&nbsp;값&nbsp;넣기<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;lt_mrp_calc&nbsp;INTO&nbsp;ls_mrp_calc.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;gs_mps_mrp.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_mps_mrp-dtnum&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_mrp_calc-dtnum.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_mps_mrp-werks&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_mrp_calc-werks.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_mps_mrp-matnrtop&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_mrp_calc-matnrtop.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_mps_mrp-planqty&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_mrp_calc-planqty.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_mps_mrp-planuom&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_mrp_calc-planuom.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_mps_mrp-matnrcomponent&nbsp;&nbsp;=&nbsp;ls_mrp_calc-matnrcomponent.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;gs_mps_mrp-reqqty&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_mrp_calc-requqty&nbsp;*&nbsp;(&nbsp;(&nbsp;100&nbsp;+&nbsp;&nbsp;gv_input1&nbsp;)&nbsp;/&nbsp;100&nbsp;).<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;gs_mps_mrp-reqqty&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_mrp_calc-requqty.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_mps_mrp-currentstock&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_mrp_calc-currentstock.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_mps_mrp-bomu&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_mrp_calc-bomu.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_mps_mrp-fresh&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_mrp_calc-fresh.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_mps_mrp-procurementtype&nbsp;=&nbsp;ls_mrp_calc-procurementtype.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;gs_mps_mrp&nbsp;TO&nbsp;gt_mps_mrp.<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
<br />
&nbsp;&nbsp;PERFORM&nbsp;set_mdtb_alv.<br />
<br />
<br />
ENDFORM.<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;set_mdtb_alv<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;MRP&nbsp;ITEM&nbsp;ALV&nbsp;설정<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM set_mdtb_alv .<br />
<br />
&nbsp;&nbsp;"&nbsp;자재군&nbsp;FRESH&nbsp;의&nbsp;경우&nbsp;화면에&nbsp;선택된&nbsp;일자&nbsp;만큼&nbsp;주당&nbsp;발주를&nbsp;진행한다.<br />
&nbsp;&nbsp;"&nbsp;자재군&nbsp;FRESH&nbsp;의&nbsp;경우&nbsp;신선&nbsp;제품임으로&nbsp;기존의&nbsp;재고를&nbsp;무시하고&nbsp;발주를&nbsp;진행한다.<br />
&nbsp;&nbsp;"&nbsp;나머지&nbsp;일반&nbsp;자재군은&nbsp;MRP&nbsp;기간&nbsp;중&nbsp;1회만&nbsp;주문을&nbsp;진행한다.<br />
&nbsp;&nbsp;PERFORM&nbsp;calc_mdtb_order_qty.<br />
&nbsp;&nbsp;"&nbsp;itab&nbsp;변경값&nbsp;적용을&nbsp;위한&nbsp;&nbsp;alv&nbsp;초기화<br />
&nbsp;&nbsp;PERFORM&nbsp;alv_refresh_0100&nbsp;USING&nbsp;go_alv_grid4.<br />
<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;MESSAGE&nbsp;'set_mps_mrp_alv'&nbsp;TYPE&nbsp;'S'.<br />
<br />
   </div>
   <div class="code">
ENDFORM.<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;calc_mrp_order_qty<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;MRP&nbsp;자재&nbsp;계획&nbsp;계산<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM calc_mdtb_order_qty .<br />
<br />
&nbsp;&nbsp;"&nbsp;생산계획&nbsp;기준&nbsp;MRP&nbsp;수량&nbsp;계산<br />
&nbsp;&nbsp;"&nbsp;주간&nbsp;발주간격과,&nbsp;안전재고량을&nbsp;반영한다.<br />
&nbsp;&nbsp;PERFORM&nbsp;calc_mrp_order_qty.<br />
<br />
&nbsp;&nbsp;"&nbsp;자재&nbsp;소비량&nbsp;기준&nbsp;비중으로&nbsp;보유재고&nbsp;할당<br />
&nbsp;&nbsp;DATA:&nbsp;lv_ratio&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;p&nbsp;LENGTH&nbsp;13&nbsp;DECIMALS&nbsp;6,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_allocated&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;p&nbsp;LENGTH&nbsp;13&nbsp;DECIMALS&nbsp;3,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_gap_qty&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;p&nbsp;LENGTH&nbsp;13&nbsp;DECIMALS&nbsp;3,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_ordergap&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;n&nbsp;LENGTH&nbsp;2,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_weight_per_unit&nbsp;&nbsp;&nbsp;TYPE&nbsp;p&nbsp;LENGTH&nbsp;5&nbsp;DECIMALS&nbsp;2,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_yield_per_chicken&nbsp;TYPE&nbsp;p&nbsp;LENGTH&nbsp;5&nbsp;DECIMALS&nbsp;2,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_chicken_qty&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;p&nbsp;LENGTH&nbsp;13&nbsp;DECIMALS&nbsp;3,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_max_orderqty&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;p&nbsp;LENGTH&nbsp;13&nbsp;DECIMALS&nbsp;3&nbsp;VALUE&nbsp;0,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_bom_number&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zcb_stpo-stlnr,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_prev_dtnum&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zcb_dtnum,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_posnr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;i,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_temp_weight&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;p&nbsp;LENGTH&nbsp;13&nbsp;DECIMALS&nbsp;3,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_max_weight&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;p&nbsp;LENGTH&nbsp;13&nbsp;DECIMALS&nbsp;3,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_top_component&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zcb_matnr,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_top_werks&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zcb_werks_d.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;ls_group&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LIKE&nbsp;LINE&nbsp;OF&nbsp;gt_mps_mrp_group,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_mps&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LIKE&nbsp;LINE&nbsp;OF&nbsp;gt_mps_mrp,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_bom_target&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LIKE&nbsp;LINE&nbsp;OF&nbsp;gt_mps_mrp,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_top&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LIKE&nbsp;LINE&nbsp;OF&nbsp;gt_mps_mrp,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_stko&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zcb_stko,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_mdtd_for_chicken&nbsp;LIKE&nbsp;gs_mdtb,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_tmp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LIKE&nbsp;gs_mdtb.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lt_halb_range&nbsp;&nbsp;TYPE&nbsp;RANGE&nbsp;OF&nbsp;zcb_matnr,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_halb_range&nbsp;&nbsp;LIKE&nbsp;LINE&nbsp;OF&nbsp;lt_halb_range,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt_bom_targets&nbsp;LIKE&nbsp;TABLE&nbsp;OF&nbsp;gs_mps_mrp,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt_group&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LIKE&nbsp;TABLE&nbsp;OF&nbsp;gs_mps_mrp_group,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_group_temp&nbsp;&nbsp;LIKE&nbsp;LINE&nbsp;OF&nbsp;gt_mps_mrp_group,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt_group2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LIKE&nbsp;TABLE&nbsp;OF&nbsp;gs_mps_mrp_group.<br />
<br />
   </div>
   <div class="codeComment">
*--------------------------------------------------<br />
*&nbsp;발주량&nbsp;기준으로&nbsp;자재&nbsp;보유량&nbsp;할당<br />
*&nbsp;MPS&nbsp;로&nbsp;필요한&nbsp;BOM&nbsp;수량&nbsp;및&nbsp;자재&nbsp;현황&nbsp;기준으로<br />
*--------------------------------------------------<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CLEAR&nbsp;lt_group.<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_mps_mrp&nbsp;INTO&nbsp;ls_mps.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;기존에&nbsp;존재하는&nbsp;자재가&nbsp;있는지&nbsp;확인함.<br />
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;lt_group&nbsp;INTO&nbsp;ls_group_temp<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;KEY&nbsp;werks&nbsp;=&nbsp;ls_mps-werks&nbsp;matnrcomponent&nbsp;=&nbsp;ls_mps-matnrcomponent&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;이미&nbsp;자재가&nbsp;존재함으로<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;수요량&nbsp;및&nbsp;재고를&nbsp;누적&nbsp;집계한다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_group_temp-totalqty&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+=&nbsp;ls_mps-reqqty.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_group_temp-currentstock&nbsp;+=&nbsp;ls_mps-currentstock.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;lt_group&nbsp;FROM&nbsp;ls_group_temp&nbsp;TRANSPORTING&nbsp;totalqty&nbsp;currentstock<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;werks&nbsp;=&nbsp;ls_mps-werks&nbsp;AND&nbsp;matnrcomponent&nbsp;=&nbsp;ls_mps-matnrcomponent.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;처음&nbsp;으로&nbsp;검색되었음으로&nbsp;기준&nbsp;값으로&nbsp;ITAB에&nbsp;추가한다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;ls_group_temp.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_group_temp-werks&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_mps-werks.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_group_temp-week&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_mps-week.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_group_temp-matnrcomponent&nbsp;=&nbsp;ls_mps-matnrcomponent.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_group_temp-totalqty&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_mps-reqqty.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_group_temp-currentstock&nbsp;&nbsp;&nbsp;=&nbsp;ls_mps-currentstock.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_group_temp-bomu&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_mps-bomu.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_group_temp-fresh&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_mps-fresh.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_group_temp-procurementtype&nbsp;=&nbsp;ls_mps-procurementtype.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_group_temp&nbsp;TO&nbsp;lt_group.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;ENDLOOP.<br />
&nbsp;&nbsp;"&nbsp;우선&nbsp;임시로&nbsp;복사한다.<br />
&nbsp;&nbsp;"&nbsp;주문&nbsp;수량&nbsp;조절을&nbsp;위한&nbsp;TMP&nbsp;ITAB<br />
&nbsp;&nbsp;lt_group2&nbsp;=&nbsp;lt_group.<br />
<br />
&nbsp;&nbsp;"&nbsp;보유재고&nbsp;기준으로&nbsp;자재&nbsp;주문&nbsp;수량을&nbsp;조절한다.<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_mps_mrp&nbsp;INTO&nbsp;gs_mps_mrp&nbsp;WHERE&nbsp;dtnum&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;lt_group2&nbsp;INTO&nbsp;ls_group<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;KEY&nbsp;werks&nbsp;=&nbsp;gs_mps_mrp-werks<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matnrcomponent&nbsp;=&nbsp;gs_mps_mrp-matnrcomponent.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0&nbsp;OR&nbsp;ls_group-totalqty&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;필요&nbsp;수량이&nbsp;없으면&nbsp;스킵<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;발주&nbsp;간격을&nbsp;반영한다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;lv_ordergap&nbsp;=&nbsp;gs_mps_mrp-ordergap.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;lv_ordergap&nbsp;IS&nbsp;INITIAL&nbsp;OR&nbsp;lv_ordergap&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_ordergap&nbsp;=&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;자재별&nbsp;수요량&nbsp;비율을&nbsp;계산한다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;lv_ratio&nbsp;=&nbsp;gs_mps_mrp-reqqty&nbsp;/&nbsp;ls_group-totalqty.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;신선재품은(생닭)은&nbsp;재고를&nbsp;가지지&nbsp;않음으로&nbsp;재고&nbsp;미보유&nbsp;취급한다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;ls_group-fresh&nbsp;=&nbsp;'FRESH'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_allocated&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;보유재고에서&nbsp;비율반큼&nbsp;배분한다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_allocated&nbsp;=&nbsp;lv_ratio&nbsp;*&nbsp;ls_group-currentstock.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;부족&nbsp;수량을&nbsp;계산한다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;lv_gap_qty&nbsp;=&nbsp;gs_mps_mrp-reqqty&nbsp;-&nbsp;lv_allocated.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;lv_gap_qty&nbsp;&lt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_gap_qty&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;신선재품은&nbsp;설정한&nbsp;발주간격&nbsp;일&nbsp;수를&nbsp;적용한다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;일반자재는&nbsp;월요일만&nbsp;발주를&nbsp;함으로&nbsp;발주&nbsp;간격을&nbsp;1로&nbsp;한다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;ls_group-fresh&nbsp;=&nbsp;'FRESH'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_mps_mrp-ordergap&nbsp;=&nbsp;lv_ordergap.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_mps_mrp-orderqty&nbsp;=&nbsp;gs_mps_mrp-reqqty&nbsp;/&nbsp;lv_ordergap.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_mps_mrp-ordergap&nbsp;=&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_mps_mrp-orderqty&nbsp;=&nbsp;lv_gap_qty.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_mps_mrp-currentstock&nbsp;=&nbsp;lv_allocated.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;gt_mps_mrp&nbsp;FROM&nbsp;gs_mps_mrp.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
   </div>
   <div class="codeComment">
*--------------------------------------------------<br />
*&nbsp;역BOM&nbsp;대상&nbsp;HALB&nbsp;자재&nbsp;수요&nbsp;집계<br />
*&nbsp;각&nbsp;반제품별&nbsp;필요&nbsp;자재수량을&nbsp;계산<br />
*--------------------------------------------------<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SELECT&nbsp;matnr<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;TABLE&nbsp;@DATA(lt_halb_matnr)<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;zcb_mara<br />
&nbsp;&nbsp;&nbsp;WHERE&nbsp;mtart&nbsp;=&nbsp;'HALB'.<br />
<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;MARA&nbsp;DB에서&nbsp;조회가&nbsp;실패했습니다&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;i400(zcb_msg)&nbsp;DISPLAY&nbsp;LIKE&nbsp;'W'&nbsp;WITH&nbsp;'MARA'.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;"&nbsp;반제품들의&nbsp;목록을&nbsp;range&nbsp;변수에&nbsp;저장한다.<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;lt_halb_matnr&nbsp;INTO&nbsp;DATA(lv_matnr).<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;ls_halb_range.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_halb_range-sign&nbsp;=&nbsp;'I'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_halb_range-option&nbsp;=&nbsp;'EQ'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_halb_range-low&nbsp;=&nbsp;lv_matnr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_halb_range&nbsp;TO&nbsp;lt_halb_range.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;HALB&nbsp;자재(반제품)에&nbsp;대한&nbsp;수요를&nbsp;계산한다.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_mps_mrp&nbsp;INTO&nbsp;ls_mps<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;matnrcomponent&nbsp;IN&nbsp;lt_halb_range<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;orderqty&nbsp;&gt;&nbsp;0.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;MRP&nbsp;대상&nbsp;자재중&nbsp;반제품이&nbsp;존재하는지&nbsp;채크&nbsp;한다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_mdkp&nbsp;INTO&nbsp;gs_mdkp<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;KEY&nbsp;matnr&nbsp;=&nbsp;ls_mps-matnrtop&nbsp;werks&nbsp;=&nbsp;ls_mps-werks.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;반제품이&nbsp;없으면&nbsp;스킵<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;MRP&nbsp;자재의&nbsp;원재료중&nbsp;반제품을&nbsp;찾는다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;lt_bom_targets&nbsp;INTO&nbsp;ls_bom_target<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;KEY&nbsp;matnrcomponent&nbsp;=&nbsp;ls_mps-matnrcomponent<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;werks&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_mps-werks.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;찾은&nbsp;반제품을&nbsp;누적해서<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;어떤&nbsp;반제품이&nbsp;얼마나&nbsp;필요한지&nbsp;계산한다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_bom_target-reqqty&nbsp;&nbsp;&nbsp;+=&nbsp;ls_mps-reqqty.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_bom_target-orderqty&nbsp;+=&nbsp;ls_mps-orderqty.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;lt_bom_targets&nbsp;FROM&nbsp;ls_bom_target&nbsp;INDEX&nbsp;sy-tabix.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;ls_bom_target.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_bom_target-matnrcomponent&nbsp;=&nbsp;ls_mps-matnrcomponent.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_bom_target-werks&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_mps-werks.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_bom_target-reqqty&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_mps-reqqty.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_bom_target-orderqty&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_mps-orderqty.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_bom_target&nbsp;TO&nbsp;lt_bom_targets.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
   </div>
   <div class="codeComment">
*--------------------------------------------------<br />
*&nbsp;플랜트별&nbsp;최대&nbsp;HALB&nbsp;수요&nbsp;추출&nbsp;(닭&nbsp;마릿수&nbsp;기준)<br />
*&nbsp;구매요청을&nbsp;진행하기&nbsp;위해&nbsp;닭이&nbsp;몇마리가&nbsp;필요한지&nbsp;계산한다.<br />
*&nbsp;가장&nbsp;많이&nbsp;필요한&nbsp;반제품&nbsp;기준으로&nbsp;필요&nbsp;닭&nbsp;마릿수를&nbsp;계산한다.<br />
*--------------------------------------------------<br />
   </div>
   <div class="code">
&nbsp;&nbsp;DATA&nbsp;:&nbsp;lt_max_targets&nbsp;&nbsp;LIKE&nbsp;TABLE&nbsp;OF&nbsp;gs_mps_mrp,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_max_target&nbsp;&nbsp;&nbsp;LIKE&nbsp;gs_mps_mrp,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_temp_chicken&nbsp;TYPE&nbsp;p&nbsp;LENGTH&nbsp;13&nbsp;DECIMALS&nbsp;3.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;lt_max_targets.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;lt_bom_targets&nbsp;INTO&nbsp;ls_bom_target.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;bom&nbsp;번호&nbsp;결정&nbsp;(공장별)&nbsp;-&nbsp;역&nbsp;BOM&nbsp;의&nbsp;BOM&nbsp;번호이다.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;lv_bom_number&nbsp;=&nbsp;COND&nbsp;#(&nbsp;WHEN&nbsp;ls_bom_target-werks&nbsp;=&nbsp;'1000'&nbsp;THEN&nbsp;'B0001'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;ls_bom_target-werks&nbsp;=&nbsp;'2000'&nbsp;THEN&nbsp;'B0015'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE&nbsp;''&nbsp;).<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;닭&nbsp;1마리당&nbsp;반제품이&nbsp;얼마나&nbsp;나오나&nbsp;부위별&nbsp;생산량을&nbsp;가져온다.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;menge&nbsp;INTO&nbsp;lv_weight_per_unit<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;zcb_stpo<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;stlnr&nbsp;=&nbsp;lv_bom_number<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;idnrk&nbsp;=&nbsp;ls_bom_target-matnrcomponent<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;lvorm&nbsp;=&nbsp;''<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;datuv&nbsp;&lt;=&nbsp;sy-datum&nbsp;AND&nbsp;datub&nbsp;&gt;=&nbsp;sy-datum.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;STPO&nbsp;DB에서&nbsp;조회가&nbsp;실패했습니다&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;i400(zcb_msg)&nbsp;DISPLAY&nbsp;LIKE&nbsp;'W'&nbsp;WITH&nbsp;'STPO'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;lv_weight_per_unit&nbsp;IS&nbsp;INITIAL&nbsp;OR&nbsp;lv_weight_per_unit&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;반제품이&nbsp;닭의&nbsp;구성&nbsp;부위가&nbsp;아니면&nbsp;스킵<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;반제품&nbsp;-&gt;&nbsp;수요량&nbsp;/&nbsp;부위&nbsp;생산량&nbsp;=&nbsp;필요한&nbsp;닭&nbsp;수<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;lv_temp_chicken&nbsp;=&nbsp;ls_bom_target-orderqty&nbsp;/&nbsp;lv_weight_per_unit.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;플랜트별&nbsp;최대&nbsp;수요만&nbsp;유지<br />
*&nbsp;가장&nbsp;많은&nbsp;수요만큼&nbsp;닭을&nbsp;주문하면<br />
*&nbsp;나머지&nbsp;부품들의&nbsp;수요도&nbsp;충족&nbsp;가능하다<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;lt_max_targets&nbsp;INTO&nbsp;ls_max_target<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;KEY&nbsp;werks&nbsp;=&nbsp;ls_bom_target-werks.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;lv_temp_chicken&nbsp;&gt;&nbsp;ls_max_target-orderqty.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_bom_target-orderqty&nbsp;=&nbsp;lv_temp_chicken.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;lt_max_targets&nbsp;FROM&nbsp;ls_bom_target&nbsp;INDEX&nbsp;sy-tabix.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_bom_target-orderqty&nbsp;=&nbsp;lv_temp_chicken.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_bom_target&nbsp;TO&nbsp;lt_max_targets.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
   </div>
   <div class="codeComment">
*--------------------------------------------------<br />
*&nbsp;닭&nbsp;1마리당&nbsp;전체&nbsp;HALB&nbsp;생산량&nbsp;(생산&nbsp;수율)&nbsp;조회<br />
*&nbsp;닭&nbsp;한마리당&nbsp;반제품이&nbsp;총&nbsp;얼마&nbsp;나오는지&nbsp;조회&nbsp;(&nbsp;총&nbsp;역&nbsp;bom&nbsp;무게&nbsp;합)<br />
*--------------------------------------------------<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SELECT&nbsp;SUM(&nbsp;stpo~menge&nbsp;)<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;@lv_yield_per_chicken<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;zcb_stpo&nbsp;AS&nbsp;stpo<br />
&nbsp;&nbsp;&nbsp;INNER&nbsp;JOIN&nbsp;zcb_mara&nbsp;AS&nbsp;mara&nbsp;ON&nbsp;mara~matnr&nbsp;=&nbsp;stpo~idnrk<br />
&nbsp;&nbsp;&nbsp;WHERE&nbsp;stpo~stlnr&nbsp;=&nbsp;@lv_bom_number<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;stpo~lvorm&nbsp;=&nbsp;''<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;stpo~datuv&nbsp;&lt;=&nbsp;@sy-datum&nbsp;AND&nbsp;stpo~datub&nbsp;&gt;=&nbsp;@sy-datum<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;mara~mtart&nbsp;=&nbsp;'HALB'.<br />
<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;MARA&nbsp;STPO&nbsp;DB에서&nbsp;조회가&nbsp;실패했습니다&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;i400(zcb_msg)&nbsp;DISPLAY&nbsp;LIKE&nbsp;'W'&nbsp;WITH&nbsp;'MARA&nbsp;STPO'.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;IF&nbsp;lv_yield_per_chicken&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;lv_yield_per_chicken&nbsp;=&nbsp;'1'.&nbsp;"&nbsp;fallback&nbsp;기본&nbsp;수율&nbsp;,&nbsp;닭&nbsp;해체시&nbsp;1kg&nbsp;분의&nbsp;반제품&nbsp;생성<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="codeComment">
*--------------------------------------------------<br />
*&nbsp;최종&nbsp;생닭&nbsp;수요&nbsp;MRP&nbsp;라인&nbsp;추가<br />
*--------------------------------------------------<br />
   </div>
   <div class="code">
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;lt_max_targets&nbsp;INTO&nbsp;ls_top.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;공장별&nbsp;bom&nbsp;번호&nbsp;결정<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;lv_bom_number&nbsp;=&nbsp;COND&nbsp;#(&nbsp;WHEN&nbsp;ls_top-werks&nbsp;=&nbsp;'1000'&nbsp;THEN&nbsp;'B0001'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;ls_top-werks&nbsp;=&nbsp;'2000'&nbsp;THEN&nbsp;'B0015'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE&nbsp;''&nbsp;).<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;원재료&nbsp;투입량&nbsp;조회<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;menge&nbsp;INTO&nbsp;lv_weight_per_unit<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;zcb_stpo<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;stlnr&nbsp;=&nbsp;lv_bom_number<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;idnrk&nbsp;=&nbsp;ls_top-matnrcomponent<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;lvorm&nbsp;=&nbsp;''<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;datuv&nbsp;&lt;=&nbsp;sy-datum<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;datub&nbsp;&gt;=&nbsp;sy-datum.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;STPO&nbsp;DB에서&nbsp;조회가&nbsp;실패했습니다&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;i400(zcb_msg)&nbsp;DISPLAY&nbsp;LIKE&nbsp;'W'&nbsp;WITH&nbsp;'STPO'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;생닭&nbsp;수요&nbsp;계산<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;lv_chicken_qty&nbsp;=&nbsp;ls_top-orderqty.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;생닭&nbsp;구매요청&nbsp;mrp&nbsp;라인&nbsp;추가&nbsp;(외부구매&nbsp;/&nbsp;자체생산)<br />
*&nbsp;왜&nbsp;두&nbsp;개를&nbsp;추가하나???<br />
*&nbsp;역&nbsp;BOM&nbsp;자재가&nbsp;부족하다&nbsp;-&gt;&nbsp;그럼&nbsp;생산을&nbsp;해야&nbsp;자재가&nbsp;만들어진다<br />
*&nbsp;그럼&nbsp;생산을&nbsp;위해서&nbsp;생닭을&nbsp;주문해야&nbsp;한다.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;gs_mps_mrp.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_mps_mrp-werks&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_top-werks.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_mps_mrp-week&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_top-week.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_mps_mrp-matnrtop&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'RM102'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_mps_mrp-planqty&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lv_chicken_qty&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_mps_mrp-planuom&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'EA'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_mps_mrp-matnrcomponent&nbsp;&nbsp;=&nbsp;'RM102'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_mps_mrp-reqqty&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lv_chicken_qty.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_mps_mrp-currentstock&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_mps_mrp-bomu&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'EA'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_mps_mrp-fresh&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'FRESH'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_mps_mrp-ordergap&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gv_check_date_sums.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_mps_mrp-orderqty&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ceil(&nbsp;lv_chicken_qty&nbsp;/&nbsp;gv_check_date_sums&nbsp;).<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;외부구매<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;gs_mps_mrp-procurementtype&nbsp;=&nbsp;'F'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;gs_mps_mrp&nbsp;TO&nbsp;gt_mps_mrp.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;자체생산<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;gs_mps_mrp-procurementtype&nbsp;=&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;gs_mps_mrp&nbsp;TO&nbsp;gt_mps_mrp.<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
<br />
<br />
   </div>
   <div class="codeComment">
*--------------------------------------------------<br />
*&nbsp;MRP&nbsp;Item&nbsp;작성<br />
*&nbsp;위에&nbsp;계산한&nbsp;값을&nbsp;반영하여&nbsp;MRP&nbsp;ITEM&nbsp;을&nbsp;작성한다.<br />
*--------------------------------------------------<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CLEAR:&nbsp;lv_prev_dtnum,&nbsp;lv_posnr.<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;gv_butn_green,&nbsp;gv_butn_yellow,&nbsp;gv_butn_red.&nbsp;"&nbsp;toolbar에&nbsp;mrp&nbsp;상태&nbsp;값&nbsp;표시&nbsp;변수<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lv_max_dtpos&nbsp;TYPE&nbsp;i.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_mps_mrp&nbsp;INTO&nbsp;gs_mps_mrp.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;gs_mdtb.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_mps_mrp-dtnum&nbsp;&lt;&gt;&nbsp;lv_prev_dtnum.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_posnr&nbsp;=&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_prev_dtnum&nbsp;=&nbsp;gs_mps_mrp-dtnum.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_posnr&nbsp;+=&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_mps_mrp-matnrtop&nbsp;=&nbsp;gs_mps_mrp-matnrcomponent.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_mdtb&nbsp;INTO&nbsp;ls_mdtd_for_chicken&nbsp;WITH&nbsp;KEY&nbsp;werks&nbsp;=&nbsp;gs_mps_mrp-werks&nbsp;beskz&nbsp;=&nbsp;'E'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_max_dtpos&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_mdtb&nbsp;INTO&nbsp;ls_tmp&nbsp;WHERE&nbsp;dtnum&nbsp;=&nbsp;ls_mdtd_for_chicken-dtnum.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;ls_tmp-dtpos&nbsp;&gt;&nbsp;lv_max_dtpos.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_max_dtpos&nbsp;=&nbsp;ls_tmp-dtpos.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_mdtb-werks&nbsp;=&nbsp;gs_mps_mrp-werks.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_mdtb-dtnum&nbsp;=&nbsp;ls_mdtd_for_chicken-dtnum.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_mdtb-dtpos&nbsp;=&nbsp;lv_max_dtpos&nbsp;+&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_mdtb-werks&nbsp;=&nbsp;gs_mps_mrp-werks.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_mdtb-dtnum&nbsp;=&nbsp;gs_mps_mrp-dtnum.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_mdtb-dtpos&nbsp;=&nbsp;lv_posnr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_mdtb-matnr&nbsp;=&nbsp;gs_mps_mrp-matnrtop.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_mdtb-idnrk&nbsp;=&nbsp;gs_mps_mrp-matnrcomponent.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_mdtb-rqmng&nbsp;=&nbsp;gs_mps_mrp-reqqty.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_mdtb-klabs&nbsp;=&nbsp;gs_mps_mrp-currentstock.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_mdtb-sqmng&nbsp;=&nbsp;ceil(&nbsp;COND&nbsp;#(&nbsp;WHEN&nbsp;gs_mps_mrp-reqqty&nbsp;-&nbsp;gs_mps_mrp-currentstock&nbsp;&lt;=&nbsp;0&nbsp;THEN&nbsp;0<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE&nbsp;gs_mps_mrp-reqqty&nbsp;-&nbsp;gs_mps_mrp-currentstock&nbsp;)&nbsp;).<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_mdtb-meins&nbsp;=&nbsp;gs_mps_mrp-bomu.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_mdtb-beskz&nbsp;=&nbsp;gs_mps_mrp-procurementtype.<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_mdkp&nbsp;INTO&nbsp;DATA(ls_wa)&nbsp;WITH&nbsp;KEY&nbsp;&nbsp;matnr&nbsp;=&nbsp;gs_mdtb-matnr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_mdtb-maktx_top&nbsp;=&nbsp;ls_wa-maktx.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_mps_mrp_group&nbsp;INTO&nbsp;DATA(ls_wa2)&nbsp;WITH&nbsp;KEY&nbsp;matnrcomponent&nbsp;=&nbsp;gs_mdtb-idnrk.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_mdtb-maktx_bot&nbsp;=&nbsp;ls_wa2-component_desc.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;색경고는&nbsp;다음과&nbsp;같다<br />
*&nbsp;빨강&nbsp;-&gt;&nbsp;필요자재&nbsp;&lt;&nbsp;재고자재&nbsp;&nbsp;&nbsp;(&nbsp;당장&nbsp;부족)<br />
*&nbsp;노랑&nbsp;-&gt;&nbsp;재고자재&nbsp;&lt;&nbsp;2&nbsp;*&nbsp;필요자재&nbsp;(&nbsp;부족경구&nbsp;)<br />
*&nbsp;초록&nbsp;-&gt;&nbsp;전체&nbsp;자재&nbsp;(&nbsp;모든&nbsp;자재&nbsp;)<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;재고&nbsp;현황&nbsp;대비&nbsp;경고&nbsp;색&nbsp;청구<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_mdtb-klabs&nbsp;-&nbsp;gs_mdtb-rqmng&nbsp;&lt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;자재&nbsp;부족&nbsp;빨간&nbsp;줄<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_mdtb-rowcolor&nbsp;=&nbsp;gc_color_red1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gv_butn_red&nbsp;+=&nbsp;1.&nbsp;"&nbsp;toolbar&nbsp;부족에&nbsp;카운트<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;gs_mdtb-klabs&nbsp;/&nbsp;gs_mdtb-rqmng&nbsp;&lt;&nbsp;2.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;자재&nbsp;부족&nbsp;경고노랑&nbsp;줄<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_mdtb-rowcolor&nbsp;=&nbsp;gc_color_yellow2.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gv_butn_yellow&nbsp;+=&nbsp;1.&nbsp;"&nbsp;toolbar&nbsp;경고에&nbsp;카운트<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;gv_butn_green&nbsp;+=&nbsp;1.&nbsp;"&nbsp;toolbar&nbsp;전체에&nbsp;카운트<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;gs_mdtb&nbsp;TO&nbsp;gt_mdtb.<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
<br />
ENDFORM.<br />
<br />
<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;CLEAR_ALL<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;화면의&nbsp;모든&nbsp;요소&nbsp;초기화<br />
*&&nbsp;REFRESH&nbsp;버튼을&nbsp;누르거나&nbsp;,&nbsp;모든&nbsp;화면을&nbsp;초기화&nbsp;해야할떄&nbsp;사용<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM clear_all .<br />
&nbsp;&nbsp;gv_flag_alv1&nbsp;=&nbsp;''.<br />
&nbsp;&nbsp;gv_flag_alv2&nbsp;=&nbsp;''.<br />
&nbsp;&nbsp;gv_flag_alv3&nbsp;=&nbsp;''.<br />
&nbsp;&nbsp;gv_flag_alv4&nbsp;=&nbsp;''.<br />
&nbsp;&nbsp;gv_flag_order&nbsp;=&nbsp;''.<br />
<br />
&nbsp;&nbsp;"&nbsp;MRP&nbsp;초기화<br />
&nbsp;&nbsp;REFRESH:&nbsp;gt_plaf.<br />
&nbsp;&nbsp;REFRESH:&nbsp;gt_mdkp.<br />
&nbsp;&nbsp;REFRESH:&nbsp;gt_mdtb.<br />
&nbsp;&nbsp;REFRESH:&nbsp;gt_mps_mrp.<br />
&nbsp;&nbsp;REFRESH:&nbsp;gt_mps_mrp_group.<br />
&nbsp;&nbsp;REFRESH:&nbsp;gt_order_qty.<br />
&nbsp;&nbsp;REFRESH:&nbsp;gt_order_split.<br />
<br />
&nbsp;&nbsp;PERFORM&nbsp;set_alv_plaf_0100&nbsp;USING&nbsp;'X'.<br />
&nbsp;&nbsp;PERFORM&nbsp;reset_alv_fcat_0100&nbsp;USING&nbsp;go_alv_grid1&nbsp;gt_fcat1.<br />
&nbsp;&nbsp;PERFORM&nbsp;alv_refresh_0100&nbsp;USING&nbsp;go_alv_grid1.<br />
<br />
&nbsp;&nbsp;PERFORM&nbsp;set_alv_mdkp_0100&nbsp;USING&nbsp;'X'.<br />
&nbsp;&nbsp;PERFORM&nbsp;reset_alv_fcat_0100&nbsp;USING&nbsp;go_alv_grid3&nbsp;gt_fcat3.<br />
&nbsp;&nbsp;PERFORM&nbsp;alv_refresh_0100&nbsp;USING&nbsp;go_alv_grid1.<br />
<br />
&nbsp;&nbsp;PERFORM&nbsp;set_alv_mdtb_0100&nbsp;USING&nbsp;'X'.<br />
&nbsp;&nbsp;PERFORM&nbsp;reset_alv_fcat_0100&nbsp;USING&nbsp;go_alv_grid4&nbsp;gt_fcat4.<br />
<br />
&nbsp;&nbsp;PERFORM&nbsp;set_alv_order_0110&nbsp;USING&nbsp;'X'.<br />
&nbsp;&nbsp;PERFORM&nbsp;reset_alv_fcat_0100&nbsp;USING&nbsp;go_alv_grid_0110&nbsp;gt_fcat5.<br />
<br />
&nbsp;&nbsp;PERFORM&nbsp;alv_refresh_0100&nbsp;USING&nbsp;go_alv_grid1.<br />
&nbsp;&nbsp;PERFORM&nbsp;alv_refresh_0100&nbsp;USING&nbsp;go_alv_grid2.<br />
&nbsp;&nbsp;PERFORM&nbsp;alv_refresh_0100&nbsp;USING&nbsp;go_alv_grid3.<br />
&nbsp;&nbsp;PERFORM&nbsp;alv_refresh_0100&nbsp;USING&nbsp;go_alv_grid4.<br />
<br />
&nbsp;&nbsp;"&nbsp;SPLIT&nbsp;ALV&nbsp;화면&nbsp;넓이&nbsp;조절<br />
&nbsp;&nbsp;go_split-&gt;set_column_width(<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;id&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;width&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;60<br />
&nbsp;&nbsp;).<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Split&nbsp;Conatiner&nbsp;넓이&nbsp;조절에&nbsp;실패했습니다.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;e416(zcb_msg).<br />
*&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="code">
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;set_plaf_icon_0100<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;PLAF에&nbsp;상태&nbsp;아이콘&nbsp;넣기<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM set_plaf_icon_0100 .<br />
&nbsp;&nbsp;"&nbsp;MRP&nbsp;Header에&nbsp;이미&nbsp;생산계획이&nbsp;실행되어&nbsp;있나&nbsp;아이콘&nbsp;추가<br />
&nbsp;&nbsp;CLEAR:&nbsp;gs_mdkp,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_plaf.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lt_mdkp&nbsp;LIKE&nbsp;gt_mdkp.<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;plnum<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;lt_mdkp<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;zcb_mdkp<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FOR&nbsp;ALL&nbsp;ENTRIES&nbsp;IN&nbsp;gt_plaf<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;plnum&nbsp;=&nbsp;gt_plaf-plnum.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;CHECK&nbsp;sy-subrc&nbsp;=&nbsp;0.<br />
<br />
*&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;MDKP&nbsp;DB에서&nbsp;조회가&nbsp;실패했습니다&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;i400(zcb_msg)&nbsp;DISPLAY&nbsp;LIKE&nbsp;'W'&nbsp;WITH&nbsp;'MDKP'.<br />
*&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SORT&nbsp;lt_mdkp&nbsp;BY&nbsp;plnum&nbsp;ASCENDING.<br />
<br />
<br />
&nbsp;&nbsp;"&nbsp;이미&nbsp;해당&nbsp;생산계획기준<br />
&nbsp;&nbsp;"&nbsp;해당&nbsp;자재의&nbsp;MRP&nbsp;계획이&nbsp;생성되어&nbsp;있을&nbsp;경우<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_plaf&nbsp;INTO&nbsp;gs_plaf.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;lt_mdkp&nbsp;INTO&nbsp;gs_mdkp&nbsp;WITH&nbsp;KEY&nbsp;plnum&nbsp;=&nbsp;gs_plaf-plnum&nbsp;.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;값이&nbsp;있으면&nbsp;초록불<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_plaf-icon&nbsp;=&nbsp;3.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;값이&nbsp;없으면&nbsp;빨간불<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_plaf-icon&nbsp;=&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;gt_plaf&nbsp;FROM&nbsp;gs_plaf.<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;set_plaf_list<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;PLAF&nbsp;에서&nbsp;선택된&nbsp;리스트&nbsp;가져온다<br />
*&&nbsp;가져온&nbsp;정보로&nbsp;MRPMPS&nbsp;에서&nbsp;값을&nbsp;가져오고,&nbsp;PLAF&nbsp;선택&nbsp;행에&nbsp;색을&nbsp;넣는다.<br />
*&&nbsp;MRP&nbsp;대상으로&nbsp;확정이된&nbsp;자재들의&nbsp;ROW에&nbsp;색을&nbsp;넣는다.<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM get_plaf_list .<br />
&nbsp;&nbsp;REFRESH:&nbsp;gt_rows,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_color.<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;gs_row,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_color.<br />
<br />
&nbsp;&nbsp;"선택된&nbsp;행의&nbsp;정보를&nbsp;가지고&nbsp;온다.<br />
&nbsp;&nbsp;go_alv_grid1-&gt;get_selected_rows(<br />
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;et_index_rows&nbsp;=&nbsp;gt_rows&nbsp;).<br />
<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;선택된&nbsp;행을&nbsp;가져오는대&nbsp;실패했습니다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;i417(zcb_msg)&nbsp;DISPLAY&nbsp;LIKE&nbsp;'W'.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;gs_plaf.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_rows&nbsp;INTO&nbsp;gs_row.<br />
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_plaf&nbsp;INTO&nbsp;gs_plaf&nbsp;INDEX&nbsp;gs_row-index.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;검색&nbsp;조건이&nbsp;있으면&nbsp;노랑&nbsp;색을&nbsp;넣는다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_color-fname&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;''.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;전체&nbsp;행&nbsp;색칠<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_color-color-col&nbsp;&nbsp;=&nbsp;3.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;3&nbsp;=&nbsp;노랑<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_color-color-int&nbsp;&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_color-color-inv&nbsp;&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;gs_color&nbsp;TO&nbsp;gt_color.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_plaf-rowcolor&nbsp;=&nbsp;gt_color.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;선택되지&nbsp;않은&nbsp;ROW&nbsp;의&nbsp;경우&nbsp;색을&nbsp;없엔다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;gs_plaf-rowcolor.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;gt_plaf&nbsp;FROM&nbsp;gs_plaf&nbsp;INDEX&nbsp;gs_row-index.<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;reset_plaf_list<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;행색&nbsp;삭제<br />
*&&nbsp;MRP&nbsp;대상으로&nbsp;선택된&nbsp;ROW&nbsp;를&nbsp;해제한다.<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM reset_plaf_list .<br />
&nbsp;&nbsp;REFRESH:&nbsp;gt_color.<br />
&nbsp;&nbsp;CLEAR:&nbsp;gs_color.<br />
&nbsp;&nbsp;CLEAR:&nbsp;gs_plaf.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_plaf&nbsp;INTO&nbsp;gs_plaf.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;gs_plaf-rowcolor.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;gt_plaf&nbsp;FROM&nbsp;gs_plaf&nbsp;INDEX&nbsp;sy-tabix.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;reset_alv_fcat_0100<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;ALV&nbsp;FCAT&nbsp;수정&nbsp;반영<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM reset_alv_fcat_0100  USING  po_alv_grid1 TYPE REF TO cl_gui_alv_grid<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat&nbsp;TYPE&nbsp;lvc_t_fcat.<br />
<br />
&nbsp;&nbsp;IF&nbsp;po_alv_grid1&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;po_alv_grid1-&gt;set_frontend_fieldcatalog(<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it_fieldcatalog&nbsp;=&nbsp;pt_fcat<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;).<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;ALV&nbsp;FCAT&nbsp;설정에&nbsp;실패하였습니다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;i399(zcb_msg)&nbsp;DISPLAY&nbsp;LIKE&nbsp;'W'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
<br />
&nbsp;&nbsp;ENDIF.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;collect_mrp_order_qty<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;MRP&nbsp;수량&nbsp;집계<br />
*&&nbsp;자재를&nbsp;주문하기&nbsp;위하여&nbsp;자재별로&nbsp;누적&nbsp;주문&nbsp;수량을&nbsp;합산한다.<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM collect_mrp_order_qty  USING    pt_mdtb LIKE gt_mdtb<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;ct_order_qty&nbsp;LIKE&nbsp;gt_order_qty.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;ct_order_qty.<br />
<br />
&nbsp;&nbsp;"&nbsp;MRP&nbsp;ITEM&nbsp;을&nbsp;기준으로&nbsp;자재별&nbsp;합산을&nbsp;진행하겠다.<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;pt_mdtb&nbsp;INTO&nbsp;DATA(ls_mdtb).<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;생산&nbsp;수량이&nbsp;0보다&nbsp;작거나&nbsp;같으면&nbsp;스킵<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;ls_mdtb-sqmng&nbsp;&lt;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;gs_order_qty.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_order_qty-werks&nbsp;=&nbsp;ls_mdtb-werks.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_order_qty-idnrk&nbsp;=&nbsp;ls_mdtb-idnrk.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_order_qty-beskz&nbsp;=&nbsp;ls_mdtb-beskz.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;기존에&nbsp;있는지&nbsp;확인<br />
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;ct_order_qty&nbsp;INTO&nbsp;DATA(ls_found)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;KEY&nbsp;werks&nbsp;=&nbsp;gs_order_qty-werks<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;idnrk&nbsp;=&nbsp;gs_order_qty-idnrk<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;beskz&nbsp;=&nbsp;gs_order_qty-beskz.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;기존&nbsp;있으면&nbsp;수량&nbsp;누적<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_found-sqmng&nbsp;+=&nbsp;ls_mdtb-sqmng.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;ct_order_qty&nbsp;FROM&nbsp;ls_found<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TRANSPORTING&nbsp;sqmng<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;werks&nbsp;=&nbsp;ls_found-werks<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;idnrk&nbsp;=&nbsp;ls_found-idnrk<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;beskz&nbsp;=&nbsp;ls_found-beskz.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;기존에&nbsp;없으면&nbsp;신규&nbsp;추가<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_order_qty-sqmng&nbsp;=&nbsp;ls_mdtb-sqmng.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_order_qty-meins&nbsp;=&nbsp;ls_mdtb-meins.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;gs_order_qty&nbsp;TO&nbsp;ct_order_qty.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;split_order_by_day<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;요일별&nbsp;분배<br />
*&&nbsp;설정된&nbsp;발주&nbsp;간격에&nbsp;맞추기&nbsp;위해&nbsp;요일별로&nbsp;구매&nbsp;및&nbsp;생산&nbsp;수량을&nbsp;나눠서&nbsp;계산한다.<br />
*&&nbsp;ex)&nbsp;월,화&nbsp;선택&nbsp;-&gt;&nbsp;월:&nbsp;50,&nbsp;화:&nbsp;50&nbsp;,&nbsp;수&nbsp;~&nbsp;일&nbsp;:&nbsp;0.<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM split_order_by_day  USING    pt_order_qty LIKE gt_order_qty<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;ct_order_split&nbsp;LIKE&nbsp;gt_order_split.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;pt_order_qty&nbsp;INTO&nbsp;gs_order_qty.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;gs_order_split.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;계산이된&nbsp;자재별&nbsp;MRP&nbsp;수행&nbsp;ITAB&nbsp;에서&nbsp;자재명을&nbsp;가져온다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_mps_mrp_group&nbsp;INTO&nbsp;DATA(ls_group)&nbsp;WITH&nbsp;KEY&nbsp;matnrcomponent&nbsp;=&nbsp;gs_order_qty-idnrk.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;필요자재명&nbsp;조회된&nbsp;값이&nbsp;없습니다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;e405(zcb_msg)&nbsp;WITH&nbsp;'필요자재명'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_order_split-maktx&nbsp;=&nbsp;ls_group-component_desc.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_order_split-werks&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_order_qty-werks.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_order_split-idnrk&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_order_qty-idnrk.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_order_split-total_qty&nbsp;=&nbsp;gs_order_qty-sqmng.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_order_split-meins&nbsp;=&nbsp;gs_order_qty-meins.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;유형&nbsp;구분<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;F&nbsp;:&nbsp;구매요청,&nbsp;E&nbsp;:&nbsp;생산요청<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_order_qty-beskz&nbsp;=&nbsp;'F'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_order_split-category&nbsp;=&nbsp;'구매요청'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;gs_order_qty-beskz&nbsp;=&nbsp;'E'&nbsp;AND&nbsp;gs_order_qty-idnrk&nbsp;CP&nbsp;'*RM1*'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;생산요청의&nbsp;경우&nbsp;원자재중&nbsp;신선&nbsp;식품은&nbsp;RM~&nbsp;으로&nbsp;시작을한다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;그럼으로&nbsp;RM&nbsp;제품을&nbsp;생산해달라고&nbsp;요청할&nbsp;경우&nbsp;역&nbsp;BOM&nbsp;레시피에&nbsp;따라&nbsp;생산을&nbsp;요청한다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_order_split-category&nbsp;=&nbsp;'생산요청'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_order_split-rowcolor&nbsp;=&nbsp;gc_color_green1.&nbsp;"&nbsp;초록줄&nbsp;표시<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE.&nbsp;"&nbsp;해당되지&nbsp;않으면&nbsp;스킵<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;RM&nbsp;포함&nbsp;자재&nbsp;(생산요청):&nbsp;월~일&nbsp;분배<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_order_split-idnrk&nbsp;CP&nbsp;'*RM1*'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;RM1&nbsp;제품일&nbsp;경우&nbsp;살아있는&nbsp;닭이다.&nbsp;그럼으로&nbsp;닭을&nbsp;공장에서&nbsp;키우지&nbsp;않음으로,&nbsp;당일에&nbsp;모두&nbsp;도축을한다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;그럼으로&nbsp;선택된&nbsp;구매요청&nbsp;요일에&nbsp;따라.&nbsp;닭의&nbsp;구매요청이&nbsp;진행된다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;요일&nbsp;개수&nbsp;계산<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA(lv_day_count)&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gv_check8&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_day_count&nbsp;=&nbsp;7.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gv_check1&nbsp;=&nbsp;'X'.&nbsp;lv_day_count&nbsp;+=&nbsp;1.&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gv_check2&nbsp;=&nbsp;'X'.&nbsp;lv_day_count&nbsp;+=&nbsp;1.&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gv_check3&nbsp;=&nbsp;'X'.&nbsp;lv_day_count&nbsp;+=&nbsp;1.&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gv_check4&nbsp;=&nbsp;'X'.&nbsp;lv_day_count&nbsp;+=&nbsp;1.&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gv_check5&nbsp;=&nbsp;'X'.&nbsp;lv_day_count&nbsp;+=&nbsp;1.&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gv_check6&nbsp;=&nbsp;'X'.&nbsp;lv_day_count&nbsp;+=&nbsp;1.&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gv_check7&nbsp;=&nbsp;'X'.&nbsp;lv_day_count&nbsp;+=&nbsp;1.&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA(lv_unit_qty)&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;lv_day_count&nbsp;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;발주는&nbsp;1/&nbsp;N&nbsp;구매요청일&nbsp;수&nbsp;로&nbsp;계산을&nbsp;한다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_unit_qty&nbsp;=&nbsp;gs_order_qty-sqmng&nbsp;/&nbsp;lv_day_count.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;요일별&nbsp;분배<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gv_check8&nbsp;=&nbsp;'X'&nbsp;OR&nbsp;gv_check1&nbsp;=&nbsp;'X'.&nbsp;gs_order_split-mon&nbsp;=&nbsp;lv_unit_qty.&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gv_check8&nbsp;=&nbsp;'X'&nbsp;OR&nbsp;gv_check2&nbsp;=&nbsp;'X'.&nbsp;gs_order_split-tue&nbsp;=&nbsp;lv_unit_qty.&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gv_check8&nbsp;=&nbsp;'X'&nbsp;OR&nbsp;gv_check3&nbsp;=&nbsp;'X'.&nbsp;gs_order_split-wed&nbsp;=&nbsp;lv_unit_qty.&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gv_check8&nbsp;=&nbsp;'X'&nbsp;OR&nbsp;gv_check4&nbsp;=&nbsp;'X'.&nbsp;gs_order_split-thu&nbsp;=&nbsp;lv_unit_qty.&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gv_check8&nbsp;=&nbsp;'X'&nbsp;OR&nbsp;gv_check5&nbsp;=&nbsp;'X'.&nbsp;gs_order_split-fri&nbsp;=&nbsp;lv_unit_qty.&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gv_check8&nbsp;=&nbsp;'X'&nbsp;OR&nbsp;gv_check6&nbsp;=&nbsp;'X'.&nbsp;gs_order_split-sat&nbsp;=&nbsp;lv_unit_qty.&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gv_check8&nbsp;=&nbsp;'X'&nbsp;OR&nbsp;gv_check7&nbsp;=&nbsp;'X'.&nbsp;gs_order_split-sun&nbsp;=&nbsp;lv_unit_qty.&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;RM&nbsp;아닌&nbsp;자재는&nbsp;무조건&nbsp;첫주의&nbsp;월요일에&nbsp;발주가&nbsp;이루어진다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;MRP&nbsp;기준은&nbsp;월요일에&nbsp;구매를&nbsp;요청하는&nbsp;것임으로.&nbsp;다른&nbsp;요일에&nbsp;구매요청을&nbsp;원할경우&nbsp;수동&nbsp;발주를&nbsp;진행한다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_order_split-mon&nbsp;=&nbsp;gs_order_qty-sqmng.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;전체&nbsp;요일&nbsp;구매수량&nbsp;합<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_order_split-sum_weekdays&nbsp;=<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_order_split-mon&nbsp;+&nbsp;gs_order_split-tue&nbsp;+&nbsp;gs_order_split-wed&nbsp;+<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_order_split-thu&nbsp;+&nbsp;gs_order_split-fri&nbsp;+&nbsp;gs_order_split-sat&nbsp;+&nbsp;gs_order_split-sun.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;주차&nbsp;추가<br />
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_plaf&nbsp;INTO&nbsp;gs_plaf&nbsp;INDEX&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CHECK&nbsp;sy-subrc&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_order_split-week&nbsp;=&nbsp;gs_plaf-pyeek.<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;gs_order_split&nbsp;TO&nbsp;ct_order_split.<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
<br />
ENDFORM.<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;set_cell_style_order_0110<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;제품군에&nbsp;따른&nbsp;ALV&nbsp;입력&nbsp;필드&nbsp;활성화(확정전)<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM set_cell_style_order_0110_m1.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lt_celltab&nbsp;TYPE&nbsp;lvc_t_styl,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_cell&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;lvc_s_styl.<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;gs_order_split.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_order_split&nbsp;INTO&nbsp;gs_order_split.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;REFRESH:&nbsp;lt_celltab.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;ls_cell.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;원재료코드(IDNRK)가&nbsp;RM1로&nbsp;시작하지&nbsp;않는&nbsp;경우:&nbsp;월요일만&nbsp;입력&nbsp;가능<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;MRP&nbsp;상&nbsp;주문은&nbsp;신선제품이&nbsp;아닐경우&nbsp;월요일만&nbsp;구매를&nbsp;요청한다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_order_split-idnrk&nbsp;CP&nbsp;'RM1*'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;RM1&nbsp;자재는&nbsp;월~일&nbsp;수정&nbsp;가능&nbsp;(아무것도&nbsp;잠금&nbsp;안함)<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;ls_cell.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_cell-style&nbsp;=&nbsp;cl_gui_alv_grid=&gt;mc_style_enabled.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_cell-fieldname&nbsp;=&nbsp;'FRI'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_cell&nbsp;TO&nbsp;lt_celltab.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;ls_cell.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_cell-style&nbsp;=&nbsp;cl_gui_alv_grid=&gt;mc_style_enabled.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_cell-fieldname&nbsp;=&nbsp;'MON'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_cell&nbsp;TO&nbsp;lt_celltab.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;ls_cell.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_cell-style&nbsp;=&nbsp;cl_gui_alv_grid=&gt;mc_style_enabled.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_cell-fieldname&nbsp;=&nbsp;'SAT'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_cell&nbsp;TO&nbsp;lt_celltab.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;ls_cell.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_cell-style&nbsp;=&nbsp;cl_gui_alv_grid=&gt;mc_style_enabled.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_cell-fieldname&nbsp;=&nbsp;'SUN'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_cell&nbsp;TO&nbsp;lt_celltab.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;ls_cell.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_cell-style&nbsp;=&nbsp;cl_gui_alv_grid=&gt;mc_style_enabled.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_cell-fieldname&nbsp;=&nbsp;'THU'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_cell&nbsp;TO&nbsp;lt_celltab.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;ls_cell.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_cell-style&nbsp;=&nbsp;cl_gui_alv_grid=&gt;mc_style_enabled.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_cell-fieldname&nbsp;=&nbsp;'TUE'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_cell&nbsp;TO&nbsp;lt_celltab.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;ls_cell.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_cell-style&nbsp;=&nbsp;cl_gui_alv_grid=&gt;mc_style_enabled.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_cell-fieldname&nbsp;=&nbsp;'WED'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_cell&nbsp;TO&nbsp;lt_celltab.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;RM1이&nbsp;아닌&nbsp;경우:&nbsp;TUE~SUN&nbsp;셀&nbsp;잠금<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;cell&nbsp;table&nbsp;은&nbsp;sorted&nbsp;table&nbsp;이라&nbsp;edit&nbsp;필드가&nbsp;다&nbsp;있어야하고<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;심지어&nbsp;필드도&nbsp;알파벳&nbsp;정렬&nbsp;순으로&nbsp;적어줘야한다.<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;ls_cell.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_cell-style&nbsp;=&nbsp;cl_gui_alv_grid=&gt;mc_style_disabled.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_cell-fieldname&nbsp;=&nbsp;'FRI'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_cell&nbsp;TO&nbsp;lt_celltab.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;ls_cell.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_cell-style&nbsp;=&nbsp;cl_gui_alv_grid=&gt;mc_style_enabled.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_cell-fieldname&nbsp;=&nbsp;'MON'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_cell&nbsp;TO&nbsp;lt_celltab.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;ls_cell.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_cell-style&nbsp;=&nbsp;cl_gui_alv_grid=&gt;mc_style_disabled.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_cell-fieldname&nbsp;=&nbsp;'SAT'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_cell&nbsp;TO&nbsp;lt_celltab.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;ls_cell.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_cell-style&nbsp;=&nbsp;cl_gui_alv_grid=&gt;mc_style_disabled.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_cell-fieldname&nbsp;=&nbsp;'SUN'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_cell&nbsp;TO&nbsp;lt_celltab.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;ls_cell.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_cell-style&nbsp;=&nbsp;cl_gui_alv_grid=&gt;mc_style_disabled.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_cell-fieldname&nbsp;=&nbsp;'THU'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_cell&nbsp;TO&nbsp;lt_celltab.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;ls_cell.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_cell-style&nbsp;=&nbsp;cl_gui_alv_grid=&gt;mc_style_disabled.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_cell-fieldname&nbsp;=&nbsp;'TUE'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_cell&nbsp;TO&nbsp;lt_celltab.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;ls_cell.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_cell-style&nbsp;=&nbsp;cl_gui_alv_grid=&gt;mc_style_disabled.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_cell-fieldname&nbsp;=&nbsp;'WED'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_cell&nbsp;TO&nbsp;lt_celltab.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;스타일&nbsp;적용<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_order_split-celltab&nbsp;=&nbsp;lt_celltab.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;gt_order_split&nbsp;FROM&nbsp;gs_order_split.<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;set_cell_style_order_0110<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;제품군에&nbsp;따른&nbsp;ALV&nbsp;입력&nbsp;필드&nbsp;활성화(확정후)<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM set_cell_style_order_0110_m2.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lt_celltab&nbsp;TYPE&nbsp;lvc_t_styl,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_cell&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;lvc_s_styl.<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;gs_order_split.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_order_split&nbsp;INTO&nbsp;gs_order_split.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;REFRESH:&nbsp;lt_celltab.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;ls_cell.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;원재료코드(IDNRK)가&nbsp;RM1로&nbsp;시작하지&nbsp;않는&nbsp;경우:&nbsp;월요일만&nbsp;입력&nbsp;가능<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_order_split-idnrk&nbsp;CP&nbsp;'RM1*'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;RM1&nbsp;자재는&nbsp;월~일&nbsp;수정&nbsp;가능&nbsp;(아무것도&nbsp;잠금&nbsp;안함)<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;ls_cell.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_cell-style&nbsp;=&nbsp;cl_gui_alv_grid=&gt;mc_style_disabled.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_cell-fieldname&nbsp;=&nbsp;'FRI'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_cell&nbsp;TO&nbsp;lt_celltab.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;ls_cell.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_cell-style&nbsp;=&nbsp;cl_gui_alv_grid=&gt;mc_style_disabled.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_cell-fieldname&nbsp;=&nbsp;'MON'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_cell&nbsp;TO&nbsp;lt_celltab.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;ls_cell.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_cell-style&nbsp;=&nbsp;cl_gui_alv_grid=&gt;mc_style_disabled.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_cell-fieldname&nbsp;=&nbsp;'SAT'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_cell&nbsp;TO&nbsp;lt_celltab.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;ls_cell.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_cell-style&nbsp;=&nbsp;cl_gui_alv_grid=&gt;mc_style_disabled.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_cell-fieldname&nbsp;=&nbsp;'SUN'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_cell&nbsp;TO&nbsp;lt_celltab.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;ls_cell.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_cell-style&nbsp;=&nbsp;cl_gui_alv_grid=&gt;mc_style_disabled.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_cell-fieldname&nbsp;=&nbsp;'THU'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_cell&nbsp;TO&nbsp;lt_celltab.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;ls_cell.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_cell-style&nbsp;=&nbsp;cl_gui_alv_grid=&gt;mc_style_disabled.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_cell-fieldname&nbsp;=&nbsp;'TUE'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_cell&nbsp;TO&nbsp;lt_celltab.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;ls_cell.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_cell-style&nbsp;=&nbsp;cl_gui_alv_grid=&gt;mc_style_disabled.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_cell-fieldname&nbsp;=&nbsp;'WED'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_cell&nbsp;TO&nbsp;lt_celltab.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;RM1이&nbsp;아닌&nbsp;경우:&nbsp;TUE~SUN&nbsp;셀&nbsp;잠금<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;cell&nbsp;table&nbsp;은&nbsp;sorted&nbsp;table&nbsp;이라&nbsp;edit&nbsp;필드가&nbsp;다&nbsp;있어야하고<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;심지어&nbsp;필드도&nbsp;알파벳&nbsp;정렬&nbsp;순으로&nbsp;적어줘야한다.<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;ls_cell.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_cell-style&nbsp;=&nbsp;cl_gui_alv_grid=&gt;mc_style_disabled.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_cell-fieldname&nbsp;=&nbsp;'FRI'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_cell&nbsp;TO&nbsp;lt_celltab.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;ls_cell.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_cell-style&nbsp;=&nbsp;cl_gui_alv_grid=&gt;mc_style_disabled.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_cell-fieldname&nbsp;=&nbsp;'MON'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_cell&nbsp;TO&nbsp;lt_celltab.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;ls_cell.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_cell-style&nbsp;=&nbsp;cl_gui_alv_grid=&gt;mc_style_disabled.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_cell-fieldname&nbsp;=&nbsp;'SAT'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_cell&nbsp;TO&nbsp;lt_celltab.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;ls_cell.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_cell-style&nbsp;=&nbsp;cl_gui_alv_grid=&gt;mc_style_disabled.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_cell-fieldname&nbsp;=&nbsp;'SUN'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_cell&nbsp;TO&nbsp;lt_celltab.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;ls_cell.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_cell-style&nbsp;=&nbsp;cl_gui_alv_grid=&gt;mc_style_disabled.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_cell-fieldname&nbsp;=&nbsp;'THU'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_cell&nbsp;TO&nbsp;lt_celltab.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;ls_cell.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_cell-style&nbsp;=&nbsp;cl_gui_alv_grid=&gt;mc_style_disabled.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_cell-fieldname&nbsp;=&nbsp;'TUE'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_cell&nbsp;TO&nbsp;lt_celltab.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;ls_cell.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_cell-style&nbsp;=&nbsp;cl_gui_alv_grid=&gt;mc_style_disabled.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_cell-fieldname&nbsp;=&nbsp;'WED'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_cell&nbsp;TO&nbsp;lt_celltab.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;스타일&nbsp;적용<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_order_split-celltab&nbsp;=&nbsp;lt_celltab.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;gt_order_split&nbsp;FROM&nbsp;gs_order_split.<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;MRP_TO_DB<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;MDKP&nbsp;MDTB&nbsp;를&nbsp;DB&nbsp;에&nbsp;저장<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM mrp_to_db .<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lt_mdkp_tmp&nbsp;&nbsp;LIKE&nbsp;gt_mdkp,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_mdkp_tmp&nbsp;&nbsp;LIKE&nbsp;LINE&nbsp;OF&nbsp;lt_mdkp_tmp,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_new_dtnum&nbsp;TYPE&nbsp;zcb_dtnum,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_old_dtnum&nbsp;TYPE&nbsp;zcb_dtnum.<br />
<br />
&nbsp;&nbsp;"&nbsp;복사본&nbsp;만듬<br />
&nbsp;&nbsp;lt_mdkp_tmp&nbsp;=&nbsp;gt_mdkp.<br />
<br />
&nbsp;&nbsp;"&nbsp;헤더&nbsp;돌면서&nbsp;하나씩&nbsp;처리<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;lt_mdkp_tmp&nbsp;INTO&nbsp;ls_mdkp_tmp.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;lv_old_dtnum&nbsp;=&nbsp;ls_mdkp_tmp-dtnum.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;넘버레인지&nbsp;발행<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'NUMBER_GET_NEXT'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nr_range_nr&nbsp;=&nbsp;'01'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;object&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'ZCB_DTNUM'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;quantity&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;number&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lv_new_dtnum<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;e004(zcb_msg).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;lv_new_dtnum&nbsp;=&nbsp;|MRP{&nbsp;lv_new_dtnum&nbsp;}|.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;헤더에&nbsp;새&nbsp;번호&nbsp;적용<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_mdkp_tmp-dtnum&nbsp;=&nbsp;lv_new_dtnum.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;아이템에도&nbsp;새&nbsp;번호&nbsp;적용<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;신문법&nbsp;적용해봄<br />
&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_mdtb&nbsp;ASSIGNING&nbsp;FIELD-SYMBOL(&lt;ls_mdtb&gt;)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;dtnum&nbsp;=&nbsp;lv_old_dtnum.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;ls_mdtb&gt;-dtnum&nbsp;=&nbsp;lv_new_dtnum.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;gt_mdkp에도&nbsp;반영<br />
&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;gt_mdkp&nbsp;FROM&nbsp;ls_mdkp_tmp&nbsp;TRANSPORTING&nbsp;dtnum<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;dtnum&nbsp;=&nbsp;lv_old_dtnum.<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
   </div>
   <div class="codeComment">
*--------------------------------------------------<br />
*&nbsp;DB에&nbsp;저장<br />
*--------------------------------------------------<br />
   </div>
   <div class="code">
&nbsp;&nbsp;DATA:&nbsp;ls_mdkp_my&nbsp;LIKE&nbsp;LINE&nbsp;OF&nbsp;gt_mdkp,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_mdkp&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zcb_mdkp,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_mdtb_my&nbsp;LIKE&nbsp;LINE&nbsp;OF&nbsp;gt_mdtb,&nbsp;&nbsp;"&nbsp;내가&nbsp;임의로&nbsp;만든&nbsp;itab<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_mdtb&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zcb_mdtb.<br />
<br />
<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_mdkp&nbsp;INTO&nbsp;ls_mdkp_my.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_mdkp-dtnum&nbsp;=&nbsp;ls_mdkp_my-dtnum.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_mdkp-plnum&nbsp;=&nbsp;ls_mdkp_my-plnum.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_mdkp-matnr&nbsp;=&nbsp;ls_mdkp_my-matnr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_mdkp-gsmng&nbsp;=&nbsp;ls_mdkp_my-gsmng.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_mdkp-meins&nbsp;=&nbsp;ls_mdkp_my-meins.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_mdkp-dsdat&nbsp;=&nbsp;ls_mdkp_my-dsdat.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_mdkp-dedat&nbsp;=&nbsp;ls_mdkp_my-dedat.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_mdkp-werks&nbsp;=&nbsp;ls_mdkp_my-werks.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_mdkp-approval&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_mdkp-approver&nbsp;=&nbsp;sy-uname.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_mdkp-approv_d&nbsp;=&nbsp;sy-datum.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_mdkp-approv_t&nbsp;=&nbsp;sy-uzeit.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;헤더&nbsp;타임스탬프&nbsp;생성<br />
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;set_timestamp&nbsp;USING&nbsp;'C'&nbsp;CHANGING&nbsp;ls_mdkp.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;INSERT&nbsp;zcb_mdkp&nbsp;FROM&nbsp;ls_mdkp.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;e403(zcb_msg)&nbsp;WITH&nbsp;'MDKP'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ROLLBACK&nbsp;WORK.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;DATA(lv_dtos)&nbsp;=&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_mdtb&nbsp;INTO&nbsp;ls_mdtb_my&nbsp;WHERE&nbsp;dtnum&nbsp;=&nbsp;ls_mdkp-dtnum.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;ls_mdtb_my-sqmng&nbsp;&nbsp;&lt;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_mdtb-dtnum&nbsp;&nbsp;=&nbsp;ls_mdtb_my-dtnum.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_mdtb-dtpos&nbsp;&nbsp;=&nbsp;lv_dtos.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_mdtb-matnr&nbsp;&nbsp;=&nbsp;ls_mdtb_my-matnr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_mdtb-idnrk&nbsp;&nbsp;=&nbsp;ls_mdtb_my-idnrk.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_mdtb-rqmng&nbsp;&nbsp;=&nbsp;ls_mdtb_my-rqmng.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_mdtb-klabs&nbsp;&nbsp;=&nbsp;ls_mdtb_my-klabs.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_mdtb-sqmng&nbsp;&nbsp;=&nbsp;ls_mdtb_my-sqmng.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_mdtb-meins&nbsp;&nbsp;=&nbsp;ls_mdtb_my-meins.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_mdtb-klabs&nbsp;&nbsp;=&nbsp;ls_mdtb_my-klabs.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_mdtb-reqcomplete&nbsp;&nbsp;=&nbsp;ls_mdtb_my-reqcomplete.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_mdtb-beskz&nbsp;&nbsp;=&nbsp;ls_mdtb_my-beskz.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;아이템&nbsp;타임스탬프&nbsp;생성<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;set_timestamp&nbsp;USING&nbsp;'C'&nbsp;CHANGING&nbsp;ls_mdtb.<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INSERT&nbsp;zcb_mdtb&nbsp;FROM&nbsp;ls_mdtb.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;e403(zcb_msg)&nbsp;WITH&nbsp;'MDTB'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ROLLBACK&nbsp;WORK.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_dtos&nbsp;+=&nbsp;1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;"&nbsp;다&nbsp;성공하면&nbsp;커밋<br />
&nbsp;&nbsp;COMMIT&nbsp;WORK.<br />
<br />
<br />
&nbsp;&nbsp;"&nbsp;MRP&nbsp;생성완료&nbsp;초록불<br />
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'ICON_CREATE'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;&nbsp;&nbsp;=&nbsp;'ICON_LED_GREEN'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Icon&nbsp;name&nbsp;&nbsp;(Name&nbsp;from&nbsp;INCLUDE&nbsp;&lt;ICON&gt;&nbsp;)<br />
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;=&nbsp;gv_mrp_on.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Icon&nbsp;(enter&nbsp;the&nbsp;screen&nbsp;field&nbsp;here)<br />
<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;MRP&nbsp;ICON&nbsp;변경에&nbsp;실패하였습니다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;e418(zcb_msg)&nbsp;WITH&nbsp;'MRP'.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;"&nbsp;화면에&nbsp;MRP&nbsp;상태&nbsp;색을&nbsp;빨강&nbsp;-&gt;&nbsp;초록으로&nbsp;변경&nbsp;반영한다.<br />
&nbsp;&nbsp;cl_gui_cfw=&gt;flush(&nbsp;).<br />
<br />
<br />
&nbsp;&nbsp;"&nbsp;MRP가&nbsp;생성되었습니다.&nbsp;자재&nbsp;주문을&nbsp;진행해주세요.<br />
&nbsp;&nbsp;MESSAGE&nbsp;i419(zcb_msg).<br />
<br />
ENDFORM.<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;set_timestamp<br />
*&---------------------------------------------------------------------*<br />
*$&nbsp;DB&nbsp;저장을&nbsp;위한&nbsp;타임스탬프&nbsp;생성<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM set_timestamp USING i_mode TYPE c<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;cs_record.<br />
<br />
&nbsp;&nbsp;call&nbsp;function&nbsp;<a&nbsp;href&nbsp;="zcb_pp_time_stamp/zcb_pp_time_stamp.html">'ZCB_PP_TIME_STAMP'</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_mode&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;i_mode<br />
&nbsp;&nbsp;&nbsp;&nbsp;CHANGING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cs_record&nbsp;=&nbsp;cs_record<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1.<br />
<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;타임스탬프&nbsp;설정&nbsp;중&nbsp;오류가&nbsp;발생했습니다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;e032(zcb_msg).<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;CHECK_PLAF_ROW<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;ALV1&nbsp;선택&nbsp;행에&nbsp;대한&nbsp;검증<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM check_plaf_row .<br />
&nbsp;&nbsp;"&nbsp;ALV에서&nbsp;선택한&nbsp;행&nbsp;인덱스&nbsp;가져오기<br />
&nbsp;&nbsp;DATA:&nbsp;lt_index_rows&nbsp;TYPE&nbsp;lvc_t_row,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_index&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;sy-tabix,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_index_row&nbsp;&nbsp;TYPE&nbsp;lvc_s_row.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;go_alv_grid1-&gt;get_selected_rows(<br />
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;et_index_rows&nbsp;=&nbsp;lt_index_rows&nbsp;).<br />
<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;선택된&nbsp;행을&nbsp;가져오는대&nbsp;실패했습니다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;i417(zcb_msg)&nbsp;DISPLAY&nbsp;LIKE&nbsp;'W'.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;"MRP&nbsp;를&nbsp;수행할&nbsp;재품이&nbsp;한&nbsp;개&nbsp;이상&nbsp;있어야함.<br />
&nbsp;&nbsp;IF&nbsp;lt_index_rows&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;한&nbsp;개&nbsp;이상의&nbsp;행을&nbsp;선택해주세요.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;i420(zcb_msg)&nbsp;DISPLAY&nbsp;LIKE&nbsp;'W'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;RETURN.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;"&nbsp;승인되지&nbsp;않은&nbsp;생산계획이&nbsp;선택된&nbsp;경우<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;lt_index_rows&nbsp;INTO&nbsp;ls_index_row.<br />
&nbsp;&nbsp;&nbsp;&nbsp;lv_index&nbsp;=&nbsp;ls_index_row-index.<br />
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_plaf&nbsp;INTO&nbsp;DATA(ls_plaf)&nbsp;INDEX&nbsp;lv_index.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;=&nbsp;0&nbsp;AND&nbsp;ls_plaf-approval&nbsp;&lt;&gt;&nbsp;'X'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;승인된&nbsp;생산계획만&nbsp;선택해주세요.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;i421(zcb_msg)&nbsp;DISPLAY&nbsp;LIKE&nbsp;'W'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;ENDLOOP.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;alv3_valid_check<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;MRP&nbsp;해더&nbsp;eidt&nbsp;값&nbsp;점검<br />
*&&nbsp;MRP&nbsp;대상&nbsp;제품의&nbsp;생산계획&nbsp;수량임으로<br />
*&&nbsp;음수&nbsp;입력&nbsp;불가,&nbsp;수량은&nbsp;1보다&nbsp;크게&nbsp;입력&nbsp;이&nbsp;되어야한다.<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM alv3_valid_check  USING   pr_data_changed TYPE REF TO cl_alv_changed_data_protocol.<br />
&nbsp;&nbsp;DATA:&nbsp;lt_good_cells&nbsp;TYPE&nbsp;lvc_t_modi,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_good_cell&nbsp;&nbsp;TYPE&nbsp;lvc_s_modi.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lv_gasmg&nbsp;TYPE&nbsp;zcb_gasmg.&nbsp;"&nbsp;mrp&nbsp;해더&nbsp;생산&nbsp;수량<br />
&nbsp;&nbsp;DATA:&nbsp;lv_meins&nbsp;TYPE&nbsp;zcb_meins.&nbsp;"&nbsp;단위<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lv_msg_flag&nbsp;TYPE&nbsp;c&nbsp;VALUE&nbsp;''.&nbsp;"&nbsp;경고&nbsp;메세지&nbsp;여부.<br />
<br />
&nbsp;&nbsp;lt_good_cells[]&nbsp;=&nbsp;pr_data_changed-&gt;mt_good_cells[].<br />
<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;lt_good_cells&nbsp;INTO&nbsp;ls_good_cell.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;ls_good_cell-fieldname&nbsp;=&nbsp;'GSMNG'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;불량갯수&nbsp;처리<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pr_data_changed-&gt;get_cell_value(<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_row_id&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_good_cell-row_id&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Row&nbsp;ID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_fieldname&nbsp;=&nbsp;'GSMNG'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Field&nbsp;Name<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e_value&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;lv_gasmg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Cell&nbsp;Content<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;).<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;lv_gasmg&nbsp;&lt;&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_msg_flag&nbsp;=&nbsp;'X'.&nbsp;"&nbsp;경고메세지&nbsp;플레그&nbsp;설정<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_gasmg&nbsp;=&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pr_data_changed-&gt;modify_cell(<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_row_id&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;ls_good_cell-row_id&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Row&nbsp;ID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_fieldname&nbsp;=&nbsp;&nbsp;&nbsp;'GSMNG'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Field&nbsp;Name<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_value&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;lv_gasmg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Value<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;).<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;IF&nbsp;lv_msg_flag&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;제품&nbsp;수량은&nbsp;1보다&nbsp;커야&nbsp;합니다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;i422(zcb_msg)&nbsp;DISPLAY&nbsp;LIKE&nbsp;'W'.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;alv4_valid_check<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;MRP&nbsp;아이탬&nbsp;&nbsp;eidt&nbsp;값&nbsp;점검<br />
*&&nbsp;MRP&nbsp;대상&nbsp;자재의&nbsp;발주예정&nbsp;수량임으로<br />
*&&nbsp;수량은&nbsp;0보다&nbsp;크게&nbsp;입력&nbsp;이&nbsp;되어야한다.<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM alv4_valid_check  USING    pr_data_changed TYPE REF TO cl_alv_changed_data_protocol.<br />
&nbsp;&nbsp;DATA:&nbsp;lt_good_cells&nbsp;TYPE&nbsp;lvc_t_modi,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_good_cell&nbsp;&nbsp;TYPE&nbsp;lvc_s_modi.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lv_sqmng&nbsp;TYPE&nbsp;zcb_sqmng.&nbsp;"&nbsp;부족수량&nbsp;&nbsp;수량<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lv_msg_flag&nbsp;TYPE&nbsp;c&nbsp;VALUE&nbsp;''.&nbsp;"&nbsp;경고&nbsp;메세지&nbsp;여부.<br />
<br />
&nbsp;&nbsp;lt_good_cells[]&nbsp;=&nbsp;pr_data_changed-&gt;mt_good_cells[].<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;lt_good_cells&nbsp;INTO&nbsp;ls_good_cell.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;ls_good_cell-fieldname&nbsp;=&nbsp;'SQMNG'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;불량갯수&nbsp;처리<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pr_data_changed-&gt;get_cell_value(<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_row_id&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_good_cell-row_id&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Row&nbsp;ID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_fieldname&nbsp;=&nbsp;'SQMNG'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Field&nbsp;Name<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e_value&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;lv_sqmng&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Cell&nbsp;Content<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;).<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;lv_sqmng&nbsp;&lt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_msg_flag&nbsp;=&nbsp;'X'.&nbsp;"&nbsp;경고메세지&nbsp;플레그&nbsp;설정<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_sqmng&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pr_data_changed-&gt;modify_cell(<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_row_id&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;ls_good_cell-row_id&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Row&nbsp;ID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_fieldname&nbsp;=&nbsp;&nbsp;&nbsp;'SQMNG'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Field&nbsp;Name<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_value&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;lv_sqmng&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Value<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;).<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;IF&nbsp;lv_msg_flag&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;부족수량은&nbsp;&nbsp;0보다&nbsp;커야&nbsp;합니다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;i423(zcb_msg)&nbsp;DISPLAY&nbsp;LIKE&nbsp;'W'.<br />
<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;alv0110_valid_check<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;구매&nbsp;및&nbsp;생산&nbsp;요청&nbsp;점검<br />
*&&nbsp;ALV&nbsp;에서&nbsp;변경된&nbsp;월~일&nbsp;요일&nbsp;합산&nbsp;값을.&nbsp;발주요청&nbsp;합산&nbsp;수량&nbsp;필드에&nbsp;수정값으로&nbsp;넣는다.<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM alv0110_valid_check  USING    pr_data_changed TYPE REF TO cl_alv_changed_data_protocol.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lt_good_cells&nbsp;TYPE&nbsp;lvc_t_modi,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_good_cell&nbsp;&nbsp;TYPE&nbsp;lvc_s_modi.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lv_sum&nbsp;&nbsp;TYPE&nbsp;zcb_sqmng,&nbsp;&nbsp;&nbsp;"&nbsp;요일&nbsp;주문&nbsp;합<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_temp&nbsp;TYPE&nbsp;zcb_sqmng.&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;요일별&nbsp;값을&nbsp;위한&nbsp;값<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lt_days&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;fieldname,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_day&nbsp;&nbsp;TYPE&nbsp;fieldname.<br />
<br />
&nbsp;&nbsp;APPEND&nbsp;'MON'&nbsp;TO&nbsp;lt_days.<br />
&nbsp;&nbsp;APPEND&nbsp;'TUE'&nbsp;TO&nbsp;lt_days.<br />
&nbsp;&nbsp;APPEND&nbsp;'WED'&nbsp;TO&nbsp;lt_days.<br />
&nbsp;&nbsp;APPEND&nbsp;'THU'&nbsp;TO&nbsp;lt_days.<br />
&nbsp;&nbsp;APPEND&nbsp;'FRI'&nbsp;TO&nbsp;lt_days.<br />
&nbsp;&nbsp;APPEND&nbsp;'SAT'&nbsp;TO&nbsp;lt_days.<br />
&nbsp;&nbsp;APPEND&nbsp;'SUN'&nbsp;TO&nbsp;lt_days.<br />
<br />
<br />
&nbsp;&nbsp;lt_good_cells[]&nbsp;=&nbsp;pr_data_changed-&gt;mt_good_cells[].<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;lt_good_cells&nbsp;INTO&nbsp;ls_good_cell.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;lv_sum.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;lt_days&nbsp;INTO&nbsp;lv_day.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;lv_temp.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pr_data_changed-&gt;get_cell_value(<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_row_id&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_good_cell-row_id<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_fieldname&nbsp;=&nbsp;lv_day<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e_value&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lv_temp<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_sum&nbsp;=&nbsp;lv_sum&nbsp;+&nbsp;lv_temp.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;pr_data_changed-&gt;modify_cell(<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_row_id&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_good_cell-row_id<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_fieldname&nbsp;=&nbsp;'SUM_WEEKDAYS'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_value&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lv_sum<br />
&nbsp;&nbsp;&nbsp;&nbsp;).<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;수정한&nbsp;필드값&nbsp;반영<br />
&nbsp;&nbsp;&nbsp;&nbsp;pr_data_changed-&gt;modify_cell(<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_row_id&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_good_cell-row_id<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_fieldname&nbsp;=&nbsp;lv_day<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_value&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lv_temp<br />
&nbsp;&nbsp;&nbsp;&nbsp;).<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;check_alv1_row_select<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;ALV1&nbsp;선택&nbsp;ROW&nbsp;값&nbsp;검증<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM check_alv1_row_select  USING    p_row_flog.<br />
&nbsp;&nbsp;DATA:&nbsp;lt_index_rows&nbsp;TYPE&nbsp;lvc_t_row,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_index&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;sy-tabix,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_index_row&nbsp;&nbsp;TYPE&nbsp;lvc_s_row.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;go_alv_grid1-&gt;get_selected_rows(<br />
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;et_index_rows&nbsp;=&nbsp;lt_index_rows&nbsp;).<br />
<br />
&nbsp;&nbsp;"MRP&nbsp;를&nbsp;수행할&nbsp;재품이&nbsp;한&nbsp;개&nbsp;이상&nbsp;있어야함.<br />
&nbsp;&nbsp;IF&nbsp;lt_index_rows&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;p_row_flog&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;한&nbsp;개&nbsp;이상의&nbsp;행을&nbsp;선택해주세요.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;i420(zcb_msg)&nbsp;DISPLAY&nbsp;LIKE&nbsp;'W'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;RETURN.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;"&nbsp;승인되지&nbsp;않은&nbsp;생산계획이&nbsp;선택된&nbsp;경우<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;lt_index_rows&nbsp;INTO&nbsp;ls_index_row.<br />
&nbsp;&nbsp;&nbsp;&nbsp;lv_index&nbsp;=&nbsp;ls_index_row-index.<br />
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_plaf&nbsp;INTO&nbsp;DATA(ls_plaf)&nbsp;INDEX&nbsp;lv_index.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;=&nbsp;0&nbsp;AND&nbsp;ls_plaf-approval&nbsp;&lt;&gt;&nbsp;'X'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p_row_flog&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;승인된&nbsp;생산계획만&nbsp;선택해주세요.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;i421(zcb_msg)&nbsp;DISPLAY&nbsp;LIKE&nbsp;'W'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;chagne_container_size<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;split&nbsp;alv&nbsp;사이즈&nbsp;설정<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM chagne_splitalv_container_size  USING p_size TYPE i.<br />
&nbsp;&nbsp;go_split-&gt;set_column_width(<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;id&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;width&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;p_size<br />
&nbsp;&nbsp;).<br />
&nbsp;&nbsp;CHECK&nbsp;sy-subrc&nbsp;=&nbsp;0.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;clear_day_check_by_all<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;요일&nbsp;버튼&nbsp;초기화&nbsp;(전체&nbsp;요일&nbsp;누름)<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM clear_day_check_by_all .<br />
&nbsp;&nbsp;CLEAR:&nbsp;gv_check1,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gv_check2,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gv_check3,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gv_check4,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gv_check5,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gv_check6,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gv_check7.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;order_dialog_approve<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;구매&nbsp;및&nbsp;생산요청&nbsp;수락&nbsp;버튼&nbsp;누름<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM order_dialog_approve .<br />
&nbsp;&nbsp;DATA(lv_answer)&nbsp;=&nbsp;''.<br />
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'POPUP_TO_CONFIRM'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;titlebar&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'요청&nbsp;생성'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text_question&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'구매&nbsp;및&nbsp;생산&nbsp;요청은&nbsp;진행하겠습니까?'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text_button_1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'확인'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text_button_2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'취소'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;default_button&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'2'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;display_cancel_button&nbsp;=&nbsp;'&nbsp;'<br />
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;answer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lv_answer.<br />
<br />
&nbsp;&nbsp;IF&nbsp;lv_answer&nbsp;&lt;&gt;&nbsp;'1'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;REFRESH:&nbsp;gt_order_qty,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_order_split.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gv_flag_order&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;RETURN.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="codeComment">
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEAVE&nbsp;TO&nbsp;SCREEN&nbsp;0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;현재&nbsp;프로그램을&nbsp;종료<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REFRESH:&nbsp;gt_order_qty,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_order_split.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gv_flag_order&nbsp;=&nbsp;'X'.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;DATA:&nbsp;ls_submit_tab&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;zcb_pp_date.<br />
<br />
&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;gt_order_split&nbsp;TO&nbsp;ls_submit_tab.<br />
<br />
&nbsp;&nbsp;"&nbsp;구매&nbsp;및&nbsp;생산&nbsp;요청을&nbsp;위해&nbsp;Table&nbsp;을&nbsp;SAP&nbsp;Memory&nbsp;로&nbsp;전달<br />
&nbsp;&nbsp;EXPORT&nbsp;ls_submit_tab<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TO&nbsp;MEMORY&nbsp;ID&nbsp;'ZPP060'.<br />
<br />
&nbsp;&nbsp;"&nbsp;ZBC_PP090&nbsp;구매&nbsp;및&nbsp;생산요청&nbsp;프로그램으로&nbsp;이동<br />
&nbsp;&nbsp;SUBMIT&nbsp;zcb_pp090&nbsp;AND&nbsp;RETURN.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;set_filter_red<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;재고가&nbsp;없는&nbsp;재품만&nbsp;보여줌&nbsp;(&nbsp;재고수량&nbsp;&lt;&nbsp;필요수량&nbsp;&nbsp;)<br />
*&---------------------------------------------------------------------*<br />
<br />
   </div>
   <div class="code">
FORM set_filter_red .<br />
&nbsp;&nbsp;CLEAR:&nbsp;gt_filt4,&nbsp;gs_filt4.<br />
<br />
&nbsp;&nbsp;gs_filt4-fieldname&nbsp;=&nbsp;'ROWCOLOR'.<br />
&nbsp;&nbsp;gs_filt4-sign&nbsp;=&nbsp;'I'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;포함,&nbsp;불포함&nbsp;조건<br />
&nbsp;&nbsp;gs_filt4-option&nbsp;=&nbsp;'EQ'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;필터&nbsp;조건&nbsp;,&nbsp;&gt;&nbsp;,&nbsp;&lt;&nbsp;,&nbsp;=&nbsp;등등<br />
&nbsp;&nbsp;gs_filt4-low&nbsp;=&nbsp;gc_color_red1.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_filt4&nbsp;TO&nbsp;gt_filt4.<br />
<br />
&nbsp;&nbsp;go_alv_grid4-&gt;set_filter_criteria(<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it_filter&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;gt_filt4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Filter&nbsp;Conditions<br />
&nbsp;&nbsp;).<br />
<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'FILTER&nbsp;설정에&nbsp;실패하였습니다.'(e02)&nbsp;TYPE&nbsp;'I'&nbsp;DISPLAY&nbsp;LIKE&nbsp;'E'.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
&nbsp;&nbsp;PERFORM&nbsp;alv_refresh_0100_filter&nbsp;USING&nbsp;go_alv_grid4.<br />
<br />
<br />
ENDFORM.<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;set_filter_yellow<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;재고가&nbsp;경고인&nbsp;재품만&nbsp;보여줌&nbsp;(&nbsp;재고수량&nbsp;&lt;&nbsp;2&nbsp;*&nbsp;필요수량&nbsp;&nbsp;)<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM set_filter_yellow .<br />
&nbsp;&nbsp;CLEAR:&nbsp;gt_filt4,&nbsp;gs_filt4.<br />
<br />
&nbsp;&nbsp;gs_filt4-fieldname&nbsp;=&nbsp;'ROWCOLOR'.<br />
&nbsp;&nbsp;gs_filt4-sign&nbsp;=&nbsp;'I'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;포함,&nbsp;불포함&nbsp;조건<br />
&nbsp;&nbsp;gs_filt4-option&nbsp;=&nbsp;'EQ'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;필터&nbsp;조건&nbsp;,&nbsp;&gt;&nbsp;,&nbsp;&lt;&nbsp;,&nbsp;=&nbsp;등등<br />
&nbsp;&nbsp;gs_filt4-low&nbsp;=&nbsp;gc_color_yellow2.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_filt4&nbsp;TO&nbsp;gt_filt4.<br />
<br />
&nbsp;&nbsp;go_alv_grid4-&gt;set_filter_criteria(<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it_filter&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;gt_filt4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Filter&nbsp;Conditions<br />
&nbsp;&nbsp;).<br />
<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'FILTER&nbsp;설정에&nbsp;실패하였습니다.'(e02)&nbsp;TYPE&nbsp;'I'&nbsp;DISPLAY&nbsp;LIKE&nbsp;'E'.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
&nbsp;&nbsp;PERFORM&nbsp;alv_refresh_0100_filter&nbsp;USING&nbsp;go_alv_grid4.<br />
<br />
<br />
ENDFORM.<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;set_filter_green<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;전체&nbsp;재고&nbsp;보여줌<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM set_filter_green .<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;gt_filt4,&nbsp;gs_filt4.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;gs_filt4-fieldname&nbsp;=&nbsp;'ROWCOLOR'.<br />
*&nbsp;&nbsp;gs_filt4-sign&nbsp;=&nbsp;'I'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;포함,&nbsp;불포함&nbsp;조건<br />
*&nbsp;&nbsp;gs_filt4-option&nbsp;=&nbsp;'NE'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;필터&nbsp;조건&nbsp;,&nbsp;&gt;&nbsp;,&nbsp;&lt;&nbsp;,&nbsp;=&nbsp;등등<br />
*&nbsp;&nbsp;gs_filt4-low&nbsp;=&nbsp;'X'.<br />
*&nbsp;&nbsp;APPEND&nbsp;gs_filt4&nbsp;TO&nbsp;gt_filt4.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;go_alv_grid4-&gt;set_filter_criteria(<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it_filter&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;gt_filt4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Filter&nbsp;Conditions<br />
&nbsp;&nbsp;).<br />
<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'FILTER&nbsp;설정에&nbsp;실패하였습니다.'(e02)&nbsp;TYPE&nbsp;'I'&nbsp;DISPLAY&nbsp;LIKE&nbsp;'E'.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
&nbsp;&nbsp;PERFORM&nbsp;alv_refresh_0100_filter&nbsp;USING&nbsp;go_alv_grid4.<br />
<br />
<br />
ENDFORM.<br />
            </div>
          </td>
        </tr>
      </table>
      </td>
      </tr>
   <tr>
<td class="footer">Extracted by Mass Download version 1.5.5 - E.G.Mellodew. 1998-2025. Sap Release 758</td>
   </tr>
</table>
</body>
</html>
