<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=utf-8" />
<title>ZCB_PP040_F01</title>
<style type="text/css">
.code{ font-family:"Courier New", Courier, monospace; color:#000; font-size:14px; background-color:#F2F4F7 }
  .codeComment {font-family:"Courier New", Courier, monospace; color:#0000F0; font-size:14px; background-color:#F2F4F7 }
  .normalBold{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; font-weight:800 }
  .normalBoldLarge{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }
</style>
<style type="text/css">
  .normal{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px }
  .footer{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; text-align: center }
  h2{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }
  h3{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:14px; font-weight:800 }
  .outerTable{
   background-color:#E0E7ED;
   width:100%;
   border-top-width: thin;
   border-right-width: thin;
   border-right-width: thin;
   border-left-width: thin;
   border-top-style: solid;
   border-right-style: solid;
   border-bottom-style: solid;
   border-left-style: solid;
  }
  .innerTable{
   background-color:#F2F4F7;
   width:100%;
   border-top-width: thin;
   border-right-width: thin;
   border-bottom-width: thin;
   border-left-width: thin;
   border-top-style: solid;
   border-right-style: solid;
   border-bottom-style: solid;
   border-left-style: solid;
  }
</style>
</head>
<body>
<table class="outerTable">
  <tr class="normalBoldLarge">
     <td><h2>Code listing for: ZCB_PP040_F01</h2>
<h3> Description: 30 F01</h3></td>
   </tr>
  <tr>
     <td>
     <table class="innerTable">
       <tr>
          <td>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Include&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZCB_PP_030_F01<br />
*&---------------------------------------------------------------------*<br />
<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;ALV_REFRESH_0100<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM alv_refresh_0100.<br />
<br />
&nbsp;&nbsp;go_alv_gird-&gt;refresh_table_display(<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is_stable&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;With&nbsp;Stable&nbsp;Rows/Columns<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_soft_refresh&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Without&nbsp;Sort,&nbsp;Filter,&nbsp;etc.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;finished&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Display&nbsp;was&nbsp;Ended&nbsp;(by&nbsp;Export)<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;others&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2<br />
   </div>
   <div class="code">
&nbsp;&nbsp;).<br />
<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'ALV를&nbsp;초기화&nbsp;하는&nbsp;과정에서&nbsp;오류가&nbsp;발생하였습니다.'&nbsp;TYPE'A'.<br />
<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;go_alv_gird2-&gt;refresh_table_display(<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is_stable&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;With&nbsp;Stable&nbsp;Rows/Columns<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_soft_refresh&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Without&nbsp;Sort,&nbsp;Filter,&nbsp;etc.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;finished&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Display&nbsp;was&nbsp;Ended&nbsp;(by&nbsp;Export)<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;others&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2<br />
   </div>
   <div class="code">
).<br />
<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'ALV를&nbsp;초기화&nbsp;하는&nbsp;과정에서&nbsp;오류가&nbsp;발생하였습니다.'&nbsp;TYPE'A'.<br />
<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;go_alv_gird3-&gt;refresh_table_display(<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is_stable&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;With&nbsp;Stable&nbsp;Rows/Columns<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_soft_refresh&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Without&nbsp;Sort,&nbsp;Filter,&nbsp;etc.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;finished&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Display&nbsp;was&nbsp;Ended&nbsp;(by&nbsp;Export)<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;others&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2<br />
   </div>
   <div class="code">
).<br />
<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'ALV를&nbsp;초기화&nbsp;하는&nbsp;과정에서&nbsp;오류가&nbsp;발생하였습니다.'&nbsp;TYPE'A'.<br />
<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;get_factory_list<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM get_factory_list .<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gt_t001w.<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;werks&nbsp;vlfkz&nbsp;name1<br />
&nbsp;&nbsp;FROM&nbsp;zcb_t001w<br />
&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;gt_t001w<br />
&nbsp;&nbsp;WHERE&nbsp;vlfkz&nbsp;=&nbsp;'A'.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;set_listbox<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM set_listbox .<br />
&nbsp;&nbsp;call&nbsp;function&nbsp;<a&nbsp;href&nbsp;="zcb_pp_list_dropdown/zcb_pp_list_dropdown.html">'ZCB_PP_LIST_DROPDOWN'</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it_itab&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gt_t001w&nbsp;&nbsp;"&nbsp;listbow&nbsp;에&nbsp;사용할&nbsp;테이블<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_field_text&nbsp;&nbsp;=&nbsp;'NAME1'&nbsp;&nbsp;&nbsp;"&nbsp;사용할&nbsp;키&nbsp;값의&nbsp;설명&nbsp;필드<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_field_key&nbsp;&nbsp;&nbsp;=&nbsp;'WERKS'&nbsp;&nbsp;&nbsp;"&nbsp;사용할&nbsp;키&nbsp;필드<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_field_id&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'zcb_plko-werks'&nbsp;"&nbsp;리스트&nbsp;박스&nbsp;오브젝트&nbsp;이름<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;invalid_field&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.<br />
&nbsp;&nbsp;.<br />
&nbsp;&nbsp;CASE&nbsp;sy-subrc.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;성공<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'잘못된&nbsp;field&nbsp;값&nbsp;입력'&nbsp;TYPE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;2.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'알&nbsp;수&nbsp;없는&nbsp;오류&nbsp;발생'&nbsp;TYPE&nbsp;'E'.<br />
&nbsp;&nbsp;ENDCASE.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;set_alv_plko<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM set_alv_plko .<br />
&nbsp;&nbsp;call&nbsp;function&nbsp;<a&nbsp;href&nbsp;="zcb_pp_alv_create/zcb_pp_alv_create.html">'ZCB_PP_ALV_CREATE'</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iv_structure&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'ZCB_PLKO'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is_variant&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_variant<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iv_save&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gv_save<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is_layout&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_layo<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iv_ccon&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'CCON'<br />
&nbsp;&nbsp;&nbsp;&nbsp;CHANGING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ct_outtab&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gt_plko<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ct_fieldcat&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gt_fcat<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CT_FILTER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CT_SORT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;co_container&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;go_container<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;co_alv_grid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;go_alv_gird<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_grid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;program_error&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;invalid_parameter_combination&nbsp;=&nbsp;3<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;too_many_lines&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;4<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_container&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;5<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_alv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;6<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;7.<br />
&nbsp;&nbsp;CASE&nbsp;sy-subrc.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;성공<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'ALV&nbsp;그리드&nbsp;바인딩&nbsp;오류'&nbsp;TYPE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;2.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'ALV&nbsp;프로그램&nbsp;오류'&nbsp;TYPE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;3.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'ALV&nbsp;파라미터&nbsp;조합&nbsp;오류'&nbsp;TYPE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;4.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'ALV&nbsp;행&nbsp;수&nbsp;초과&nbsp;오류'&nbsp;TYPE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;5.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'컨테이너&nbsp;생성&nbsp;오류'&nbsp;TYPE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;6.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'ALV&nbsp;Grid&nbsp;생성&nbsp;오류'&nbsp;TYPE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;OTHERS.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'알&nbsp;수&nbsp;없는&nbsp;오류&nbsp;발생'&nbsp;TYPE&nbsp;'E'.<br />
&nbsp;&nbsp;ENDCASE.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;set_alv_crhd<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM set_alv_crhd .<br />
&nbsp;&nbsp;call&nbsp;function&nbsp;<a&nbsp;href&nbsp;="zcb_pp_alv_create/zcb_pp_alv_create.html">'ZCB_PP_ALV_CREATE'</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iv_structure&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'ZCB_CRHD'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is_variant&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_variant<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iv_save&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gv_save<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is_layout&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_layo<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iv_ccon&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'CCON2'<br />
&nbsp;&nbsp;&nbsp;&nbsp;CHANGING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ct_outtab&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gt_crhd<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ct_fieldcat&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gt_fcat2<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CT_FILTER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CT_SORT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;co_container&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;go_container2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;co_alv_grid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;go_alv_gird2<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_grid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;program_error&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;invalid_parameter_combination&nbsp;=&nbsp;3<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;too_many_lines&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;4<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_container&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;5<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_alv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;6<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;7.<br />
&nbsp;&nbsp;CASE&nbsp;sy-subrc.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;성공<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'ALV&nbsp;그리드&nbsp;바인딩&nbsp;오류'&nbsp;TYPE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;2.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'ALV&nbsp;프로그램&nbsp;오류'&nbsp;TYPE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;3.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'ALV&nbsp;파라미터&nbsp;조합&nbsp;오류'&nbsp;TYPE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;4.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'ALV&nbsp;행&nbsp;수&nbsp;초과&nbsp;오류'&nbsp;TYPE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;5.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'컨테이너&nbsp;생성&nbsp;오류'&nbsp;TYPE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;6.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'ALV&nbsp;Grid&nbsp;생성&nbsp;오류'&nbsp;TYPE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;OTHERS.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'알&nbsp;수&nbsp;없는&nbsp;오류&nbsp;발생'&nbsp;TYPE&nbsp;'E'.<br />
&nbsp;&nbsp;ENDCASE.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;set_alv_plpo<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM set_alv_plpo .<br />
&nbsp;&nbsp;call&nbsp;function&nbsp;<a&nbsp;href&nbsp;="zcb_pp_alv_create/zcb_pp_alv_create.html">'ZCB_PP_ALV_CREATE'</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iv_structure&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'ZCB_PLPO'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is_variant&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_variant<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iv_save&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gv_save<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is_layout&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_layo<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iv_ccon&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'CCON3'<br />
&nbsp;&nbsp;&nbsp;&nbsp;CHANGING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ct_outtab&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gt_plpo<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ct_fieldcat&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gt_fcat3<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CT_FILTER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CT_SORT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;co_container&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;go_container3<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;co_alv_grid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;go_alv_gird3<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_grid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;program_error&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;invalid_parameter_combination&nbsp;=&nbsp;3<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;too_many_lines&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;4<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_container&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;5<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_alv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;6<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;7.<br />
&nbsp;&nbsp;CASE&nbsp;sy-subrc.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;성공<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'ALV&nbsp;그리드&nbsp;바인딩&nbsp;오류'&nbsp;TYPE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;2.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'ALV&nbsp;프로그램&nbsp;오류'&nbsp;TYPE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;3.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'ALV&nbsp;파라미터&nbsp;조합&nbsp;오류'&nbsp;TYPE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;4.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'ALV&nbsp;행&nbsp;수&nbsp;초과&nbsp;오류'&nbsp;TYPE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;5.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'컨테이너&nbsp;생성&nbsp;오류'&nbsp;TYPE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;6.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'ALV&nbsp;Grid&nbsp;생성&nbsp;오류'&nbsp;TYPE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;OTHERS.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'알&nbsp;수&nbsp;없는&nbsp;오류&nbsp;발생'&nbsp;TYPE&nbsp;'E'.<br />
&nbsp;&nbsp;ENDCASE.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;get_routing_header_plant<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM get_routing_header_plant USING iv_werks TYPE zcb_werks_d.<br />
&nbsp;&nbsp;DATA:&nbsp;lv_number&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;char4,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_new_plnnr&nbsp;TYPE&nbsp;zcb_plnnr.&nbsp;"&nbsp;CHAR&nbsp;6&nbsp;타입&nbsp;추천&nbsp;(예:&nbsp;RT0001)<br />
<br />
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'NUMBER_GET_NEXT'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nr_range_nr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'01'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;object&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'ZCB_PLNNR'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;quantity&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;number&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lv_number<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;interval_not_found&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;number_range_not_intern&nbsp;=&nbsp;2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;object_not_found&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;3<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;quantity_is_0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;4<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;quantity_is_not_1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;5<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;interval_overflow&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;6<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buffer_overflow&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;7<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;8.<br />
<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'넘버레인지에서&nbsp;번호를&nbsp;가져오는&nbsp;데&nbsp;실패했습니다.'&nbsp;TYPE&nbsp;'S'&nbsp;DISPLAY&nbsp;LIKE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;RETURN.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;"&nbsp;라우팅&nbsp;RN&nbsp;부여<br />
&nbsp;&nbsp;lv_new_plnnr&nbsp;=&nbsp;|RT{&nbsp;lv_number&nbsp;}|.<br />
&nbsp;&nbsp;gs_plko-plnnr&nbsp;&nbsp;=&nbsp;lv_new_plnnr.<br />
<br />
&nbsp;&nbsp;gs_plko-werks&nbsp;=&nbsp;iv_werks.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;이건&nbsp;나중에&nbsp;생성&nbsp;버튼&nbsp;누를경우&nbsp;최종&nbsp;생성&nbsp;되도록<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;타임스탬프&nbsp;설정&nbsp;-&nbsp;생성&nbsp;모드&nbsp;('C')<br />
   </div>
   <div class="code">
&nbsp;&nbsp;call&nbsp;function&nbsp;<a&nbsp;href&nbsp;="zcb_pp_time_stamp/zcb_pp_time_stamp.html">'ZCB_PP_TIME_STAMP'</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_mode&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'<br />
&nbsp;&nbsp;&nbsp;&nbsp;CHANGING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cs_record&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_plko<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;invalid_mode&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;missing_record&nbsp;&nbsp;=&nbsp;2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;timestamp_error&nbsp;=&nbsp;3<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;4.<br />
<br />
<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'데이터&nbsp;저장에&nbsp;실패하였습니다.'&nbsp;TYPE&nbsp;'S'&nbsp;DISPLAY&nbsp;LIKE&nbsp;'E'.<br />
&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'데이터가&nbsp;저장되었습니다.'&nbsp;TYPE'S'.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;APPEND&nbsp;gs_plko&nbsp;TO&nbsp;gt_plko.<br />
<br />
<br />
<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;get_crhd_table<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM get_crhd_table USING i_meins TYPE zcb_plko-meins.<br />
<br />
&nbsp;&nbsp;REFRESH&nbsp;gt_crhd.<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_crhd.<br />
<br />
&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_plko&nbsp;INTO&nbsp;gs_plko&nbsp;INDEX&nbsp;1.<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;werks&nbsp;objid&nbsp;arbpl&nbsp;ltxa1&nbsp;meng&nbsp;mein<br />
&nbsp;&nbsp;FROM&nbsp;zcb_crhd<br />
&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;gt_crhd<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;lvorm&nbsp;=&nbsp;''<br />
&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;werks&nbsp;=&nbsp;gs_plko-werks<br />
&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;mein&nbsp;=&nbsp;i_meins<br />
&nbsp;&nbsp;&nbsp;&nbsp;ORDER&nbsp;BY&nbsp;objid.<br />
<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;set_alv_layo<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM set_alv_layo .<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;gs_layo,&nbsp;gs_variant.<br />
<br />
&nbsp;&nbsp;gs_variant-report&nbsp;=&nbsp;sy-cprog.<br />
&nbsp;&nbsp;gv_save&nbsp;=&nbsp;'A'.<br />
<br />
&nbsp;&nbsp;gs_layo-sel_mode&nbsp;=&nbsp;'B'.&nbsp;"&nbsp;한줄만<br />
&nbsp;&nbsp;gs_layo-zebra&nbsp;=&nbsp;abap_on.&nbsp;"&nbsp;얼룩처리<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;gs_layo-cwidth_opt&nbsp;=&nbsp;abap_on.&nbsp;"&nbsp;열넓이&nbsp;최적화&nbsp;샐&nbsp;넓이가&nbsp;고정이&nbsp;되어버림&nbsp;최적으로<br />
<br />
*&nbsp;&nbsp;gs_layo-edit&nbsp;=&nbsp;''.&nbsp;"&nbsp;수정모드&nbsp;전체&nbsp;필드가&nbsp;수정&nbsp;가능하게&nbsp;되어짐<br />
<br />
   </div>
   <div class="code">
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;SET_ALV_FCAT_0100<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM set_alv_fcat_plkp_0100 USING iv_edit_flag TYPE c.<br />
<br />
<br />
<br />
&nbsp;&nbsp;"&nbsp;허용&nbsp;값만&nbsp;필터링<br />
&nbsp;&nbsp;IF&nbsp;iv_edit_flag&nbsp;&lt;&gt;&nbsp;'X'&nbsp;AND&nbsp;iv_edit_flag&nbsp;&lt;&gt;&nbsp;''.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'iv_edit_flag&nbsp;값은&nbsp;''X''&nbsp;또는&nbsp;''만&nbsp;허용됩니다.'&nbsp;TYPE&nbsp;'S'&nbsp;DISPLAY&nbsp;LIKE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;RETURN.<br />
&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;REFRESH&nbsp;gt_fcat.<br />
<br />
&nbsp;&nbsp;"&nbsp;안쓸&nbsp;필드들&nbsp;no&nbsp;out&nbsp;처리<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat.<br />
&nbsp;&nbsp;gs_fcat-fieldname&nbsp;=&nbsp;'ERDAT'.<br />
&nbsp;&nbsp;gs_fcat-no_out&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat&nbsp;TO&nbsp;gt_fcat.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat.<br />
&nbsp;&nbsp;gs_fcat-fieldname&nbsp;=&nbsp;'ERZET'.<br />
&nbsp;&nbsp;gs_fcat-no_out&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat&nbsp;TO&nbsp;gt_fcat.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat.<br />
&nbsp;&nbsp;gs_fcat-fieldname&nbsp;=&nbsp;'ERNAM'.<br />
&nbsp;&nbsp;gs_fcat-no_out&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat&nbsp;TO&nbsp;gt_fcat.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat.<br />
&nbsp;&nbsp;gs_fcat-fieldname&nbsp;=&nbsp;'AEDAT'.<br />
&nbsp;&nbsp;gs_fcat-no_out&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat&nbsp;TO&nbsp;gt_fcat.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat.<br />
&nbsp;&nbsp;gs_fcat-fieldname&nbsp;=&nbsp;'AEZET'.<br />
&nbsp;&nbsp;gs_fcat-no_out&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat&nbsp;TO&nbsp;gt_fcat.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat.<br />
&nbsp;&nbsp;gs_fcat-fieldname&nbsp;=&nbsp;'AENAM'.<br />
&nbsp;&nbsp;gs_fcat-no_out&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat&nbsp;TO&nbsp;gt_fcat.<br />
<br />
&nbsp;&nbsp;"&nbsp;사용할&nbsp;필드들<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat.<br />
&nbsp;&nbsp;gs_fcat-fieldname&nbsp;=&nbsp;'PLNNR'.<br />
&nbsp;&nbsp;gs_fcat-coltext&nbsp;=&nbsp;'공정ID'.<br />
&nbsp;&nbsp;gs_fcat-outputlen&nbsp;&nbsp;=&nbsp;6.<br />
&nbsp;&nbsp;gs_fcat-hotspot&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat&nbsp;TO&nbsp;gt_fcat.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat.<br />
&nbsp;&nbsp;gs_fcat-fieldname&nbsp;=&nbsp;'WERKS'.<br />
&nbsp;&nbsp;gs_fcat-coltext&nbsp;=&nbsp;'플랜트&nbsp;ID'.<br />
&nbsp;&nbsp;gs_fcat-outputlen&nbsp;&nbsp;=&nbsp;6.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat&nbsp;TO&nbsp;gt_fcat.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat.<br />
&nbsp;&nbsp;gs_fcat-fieldname&nbsp;=&nbsp;'DATUB'.<br />
&nbsp;&nbsp;gs_fcat-coltext&nbsp;=&nbsp;'유효&nbsp;종료일'.<br />
&nbsp;&nbsp;gs_fcat-outputlen&nbsp;&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;gs_fcat-edit&nbsp;=&nbsp;iv_edit_flag.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat&nbsp;TO&nbsp;gt_fcat.<br />
<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat.<br />
&nbsp;&nbsp;gs_fcat-fieldname&nbsp;=&nbsp;'DATUV'.<br />
&nbsp;&nbsp;gs_fcat-coltext&nbsp;=&nbsp;'유효&nbsp;시작일'.<br />
&nbsp;&nbsp;gs_fcat-outputlen&nbsp;&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;gs_fcat-edit&nbsp;=&nbsp;iv_edit_flag.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat&nbsp;TO&nbsp;gt_fcat.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat.<br />
&nbsp;&nbsp;gs_fcat-fieldname&nbsp;=&nbsp;'LVORM'.<br />
&nbsp;&nbsp;gs_fcat-coltext&nbsp;=&nbsp;'삭제여부'.<br />
&nbsp;&nbsp;gs_fcat-outputlen&nbsp;&nbsp;=&nbsp;5.<br />
&nbsp;&nbsp;gs_fcat-checkbox&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat&nbsp;TO&nbsp;gt_fcat.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat.<br />
&nbsp;&nbsp;gs_fcat-fieldname&nbsp;=&nbsp;'LOSVN'.<br />
&nbsp;&nbsp;gs_fcat-coltext&nbsp;=&nbsp;'최소&nbsp;로트&nbsp;크기'.<br />
&nbsp;&nbsp;gs_fcat-outputlen&nbsp;&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;gs_fcat-edit&nbsp;=&nbsp;iv_edit_flag.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat&nbsp;TO&nbsp;gt_fcat.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat.<br />
&nbsp;&nbsp;gs_fcat-fieldname&nbsp;=&nbsp;'LOSBS'.<br />
&nbsp;&nbsp;gs_fcat-coltext&nbsp;=&nbsp;'최대&nbsp;로트&nbsp;크기'.<br />
&nbsp;&nbsp;gs_fcat-outputlen&nbsp;&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;gs_fcat-edit&nbsp;=&nbsp;iv_edit_flag.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat&nbsp;TO&nbsp;gt_fcat.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat.<br />
&nbsp;&nbsp;gs_fcat-fieldname&nbsp;=&nbsp;'BMSCH'.<br />
&nbsp;&nbsp;gs_fcat-coltext&nbsp;=&nbsp;'공정&nbsp;생성&nbsp;수량'.<br />
&nbsp;&nbsp;gs_fcat-outputlen&nbsp;&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;gs_fcat-edit&nbsp;=&nbsp;iv_edit_flag.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat&nbsp;TO&nbsp;gt_fcat.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat.<br />
&nbsp;&nbsp;gs_fcat-fieldname&nbsp;=&nbsp;'AUSSS'.<br />
&nbsp;&nbsp;gs_fcat-coltext&nbsp;=&nbsp;'불량률(%)'.<br />
&nbsp;&nbsp;gs_fcat-outputlen&nbsp;&nbsp;=&nbsp;6.<br />
&nbsp;&nbsp;gs_fcat-edit&nbsp;=&nbsp;iv_edit_flag.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat&nbsp;TO&nbsp;gt_fcat.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat.<br />
&nbsp;&nbsp;gs_fcat-fieldname&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;gs_fcat-coltext&nbsp;=&nbsp;'단위'.<br />
&nbsp;&nbsp;gs_fcat-outputlen&nbsp;&nbsp;=&nbsp;4.<br />
&nbsp;&nbsp;gs_fcat-edit&nbsp;=&nbsp;iv_edit_flag.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat&nbsp;TO&nbsp;gt_fcat.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat.<br />
&nbsp;&nbsp;gs_fcat-fieldname&nbsp;=&nbsp;'LTXA1'.<br />
&nbsp;&nbsp;gs_fcat-coltext&nbsp;=&nbsp;'공정설명'.<br />
&nbsp;&nbsp;gs_fcat-outputlen&nbsp;&nbsp;=&nbsp;16.<br />
&nbsp;&nbsp;gs_fcat-edit&nbsp;=&nbsp;iv_edit_flag.<br />
&nbsp;&nbsp;gs_fcat-col_pos&nbsp;=&nbsp;99.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat&nbsp;TO&nbsp;gt_fcat.<br />
<br />
ENDFORM.<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;set_alv_fcat_crhd_0100<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM set_alv_fcat_crhd_0100 .<br />
&nbsp;&nbsp;REFRESH&nbsp;gt_fcat2.<br />
<br />
&nbsp;&nbsp;"&nbsp;안쓸&nbsp;필드들&nbsp;no&nbsp;out&nbsp;처리<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat2.<br />
&nbsp;&nbsp;gs_fcat2-fieldname&nbsp;=&nbsp;'LVORM'.<br />
&nbsp;&nbsp;gs_fcat2-no_out&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat2&nbsp;TO&nbsp;gt_fcat2.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat2.<br />
&nbsp;&nbsp;gs_fcat2-fieldname&nbsp;=&nbsp;'ERDAT'.<br />
&nbsp;&nbsp;gs_fcat2-no_out&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat2&nbsp;TO&nbsp;gt_fcat2.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat2.<br />
&nbsp;&nbsp;gs_fcat2-fieldname&nbsp;=&nbsp;'ERZET'.<br />
&nbsp;&nbsp;gs_fcat2-no_out&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat2&nbsp;TO&nbsp;gt_fcat2.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat2.<br />
&nbsp;&nbsp;gs_fcat2-fieldname&nbsp;=&nbsp;'ERNAM'.<br />
&nbsp;&nbsp;gs_fcat2-no_out&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat2&nbsp;TO&nbsp;gt_fcat2.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat2.<br />
&nbsp;&nbsp;gs_fcat2-fieldname&nbsp;=&nbsp;'AEDAT'.<br />
&nbsp;&nbsp;gs_fcat2-no_out&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat2&nbsp;TO&nbsp;gt_fcat2.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat2.<br />
&nbsp;&nbsp;gs_fcat2-fieldname&nbsp;=&nbsp;'AEZET'.<br />
&nbsp;&nbsp;gs_fcat2-no_out&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat2&nbsp;TO&nbsp;gt_fcat2.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat2.<br />
&nbsp;&nbsp;gs_fcat2-fieldname&nbsp;=&nbsp;'AENAM'.<br />
&nbsp;&nbsp;gs_fcat2-no_out&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat2&nbsp;TO&nbsp;gt_fcat2.<br />
<br />
&nbsp;&nbsp;"&nbsp;사용할&nbsp;필드들<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat2.<br />
&nbsp;&nbsp;gs_fcat2-fieldname&nbsp;=&nbsp;'OBJID'.<br />
&nbsp;&nbsp;gs_fcat2-no_out&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat2&nbsp;TO&nbsp;gt_fcat2.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat2.<br />
&nbsp;&nbsp;gs_fcat2-fieldname&nbsp;=&nbsp;'WERKS'.<br />
&nbsp;&nbsp;gs_fcat2-no_out&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat2&nbsp;TO&nbsp;gt_fcat2.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat2.<br />
&nbsp;&nbsp;gs_fcat2-fieldname&nbsp;=&nbsp;'LVORM'.<br />
&nbsp;&nbsp;gs_fcat2-no_out&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat2&nbsp;TO&nbsp;gt_fcat2.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat2.<br />
&nbsp;&nbsp;gs_fcat2-fieldname&nbsp;=&nbsp;'ARBPL'.<br />
&nbsp;&nbsp;gs_fcat2-coltext&nbsp;=&nbsp;'작업장&nbsp;이름'.<br />
&nbsp;&nbsp;gs_fcat2-outputlen&nbsp;&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat2&nbsp;TO&nbsp;gt_fcat2.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat2.<br />
&nbsp;&nbsp;gs_fcat2-fieldname&nbsp;=&nbsp;'LTXA1'.<br />
&nbsp;&nbsp;gs_fcat2-coltext&nbsp;=&nbsp;'작업장&nbsp;설명'.<br />
&nbsp;&nbsp;gs_fcat2-outputlen&nbsp;&nbsp;=&nbsp;16.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat2&nbsp;TO&nbsp;gt_fcat2.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat2.<br />
&nbsp;&nbsp;gs_fcat2-fieldname&nbsp;=&nbsp;'MENG'.<br />
&nbsp;&nbsp;gs_fcat2-coltext&nbsp;=&nbsp;'작업용량'.<br />
&nbsp;&nbsp;gs_fcat2-outputlen&nbsp;&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat2&nbsp;TO&nbsp;gt_fcat2.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat2.<br />
&nbsp;&nbsp;gs_fcat2-fieldname&nbsp;=&nbsp;'MEIN'.<br />
&nbsp;&nbsp;gs_fcat2-coltext&nbsp;=&nbsp;'단위'.<br />
&nbsp;&nbsp;gs_fcat2-outputlen&nbsp;&nbsp;=&nbsp;4.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat2&nbsp;TO&nbsp;gt_fcat2.<br />
<br />
<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;set_alv_fcat_plpo_0100<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM set_alv_fcat_plpo_0100 USING iv_edit_flag TYPE c.<br />
<br />
<br />
<br />
&nbsp;&nbsp;"&nbsp;허용&nbsp;값만&nbsp;필터링<br />
&nbsp;&nbsp;IF&nbsp;iv_edit_flag&nbsp;&lt;&gt;&nbsp;'X'&nbsp;AND&nbsp;iv_edit_flag&nbsp;&lt;&gt;&nbsp;''.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'iv_edit_flag&nbsp;값은&nbsp;''X''&nbsp;또는&nbsp;''만&nbsp;허용됩니다.'&nbsp;TYPE&nbsp;'S'&nbsp;DISPLAY&nbsp;LIKE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;RETURN.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
&nbsp;&nbsp;REFRESH&nbsp;gt_fcat3.<br />
<br />
&nbsp;&nbsp;"&nbsp;안쓸&nbsp;필드들&nbsp;no&nbsp;out&nbsp;처리<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat3.<br />
&nbsp;&nbsp;gs_fcat3-fieldname&nbsp;=&nbsp;'ERDAT'.<br />
&nbsp;&nbsp;gs_fcat3-no_out&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat3&nbsp;TO&nbsp;gt_fcat3.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat3.<br />
&nbsp;&nbsp;gs_fcat3-fieldname&nbsp;=&nbsp;'ERZET'.<br />
&nbsp;&nbsp;gs_fcat3-no_out&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat3&nbsp;TO&nbsp;gt_fcat3.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat3.<br />
&nbsp;&nbsp;gs_fcat3-fieldname&nbsp;=&nbsp;'ERNAM'.<br />
&nbsp;&nbsp;gs_fcat3-no_out&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat3&nbsp;TO&nbsp;gt_fcat3.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat3.<br />
&nbsp;&nbsp;gs_fcat3-fieldname&nbsp;=&nbsp;'AEDAT'.<br />
&nbsp;&nbsp;gs_fcat3-no_out&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat3&nbsp;TO&nbsp;gt_fcat3.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat3.<br />
&nbsp;&nbsp;gs_fcat3-fieldname&nbsp;=&nbsp;'AEZET'.<br />
&nbsp;&nbsp;gs_fcat3-no_out&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat3&nbsp;TO&nbsp;gt_fcat3.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat3.<br />
&nbsp;&nbsp;gs_fcat3-fieldname&nbsp;=&nbsp;'AENAM'.<br />
&nbsp;&nbsp;gs_fcat3-no_out&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat3&nbsp;TO&nbsp;gt_fcat3.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat3.<br />
&nbsp;&nbsp;gs_fcat3-fieldname&nbsp;=&nbsp;'PLNNR'.<br />
&nbsp;&nbsp;gs_fcat3-coltext&nbsp;=&nbsp;'공정ID'.<br />
&nbsp;&nbsp;gs_fcat3-outputlen&nbsp;&nbsp;=&nbsp;6.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat3&nbsp;TO&nbsp;gt_fcat3.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat3.<br />
&nbsp;&nbsp;gs_fcat3-fieldname&nbsp;=&nbsp;'PLNKN'.<br />
&nbsp;&nbsp;gs_fcat3-coltext&nbsp;=&nbsp;'공정단계'.<br />
&nbsp;&nbsp;gs_fcat3-outputlen&nbsp;&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat3&nbsp;TO&nbsp;gt_fcat3.<br />
<br />
&nbsp;&nbsp;"&nbsp;사용할&nbsp;필드들<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat3.<br />
&nbsp;&nbsp;gs_fcat3-fieldname&nbsp;=&nbsp;'ARBPL'.<br />
&nbsp;&nbsp;gs_fcat3-coltext&nbsp;=&nbsp;'작업장&nbsp;이름'.<br />
&nbsp;&nbsp;gs_fcat3-outputlen&nbsp;&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat3&nbsp;TO&nbsp;gt_fcat3.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat3.<br />
&nbsp;&nbsp;gs_fcat3-fieldname&nbsp;=&nbsp;'LTXA1'.<br />
&nbsp;&nbsp;gs_fcat3-coltext&nbsp;=&nbsp;'작업장&nbsp;설명'.<br />
&nbsp;&nbsp;gs_fcat3-col_pos&nbsp;=&nbsp;5.<br />
&nbsp;&nbsp;gs_fcat3-outputlen&nbsp;=&nbsp;16.<br />
&nbsp;&nbsp;gs_fcat3-edit&nbsp;=&nbsp;iv_edit_flag.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat3&nbsp;TO&nbsp;gt_fcat3.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat3.<br />
&nbsp;&nbsp;gs_fcat3-fieldname&nbsp;=&nbsp;'DATUB'.<br />
&nbsp;&nbsp;gs_fcat3-coltext&nbsp;=&nbsp;'유효&nbsp;종료일'.<br />
&nbsp;&nbsp;gs_fcat3-outputlen&nbsp;&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;gs_fcat3-edit&nbsp;=&nbsp;iv_edit_flag.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat3&nbsp;TO&nbsp;gt_fcat3.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat3.<br />
&nbsp;&nbsp;gs_fcat3-fieldname&nbsp;=&nbsp;'DATUV'.<br />
&nbsp;&nbsp;gs_fcat3-coltext&nbsp;=&nbsp;'유효&nbsp;종료일'.<br />
&nbsp;&nbsp;gs_fcat3-outputlen&nbsp;&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;gs_fcat3-edit&nbsp;=&nbsp;iv_edit_flag.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat3&nbsp;TO&nbsp;gt_fcat3.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat3.<br />
&nbsp;&nbsp;gs_fcat3-fieldname&nbsp;=&nbsp;'LVORM'.<br />
&nbsp;&nbsp;gs_fcat3-coltext&nbsp;=&nbsp;'삭제여부'.<br />
&nbsp;&nbsp;gs_fcat3-outputlen&nbsp;&nbsp;=&nbsp;5.<br />
&nbsp;&nbsp;gs_fcat3-checkbox&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat3&nbsp;TO&nbsp;gt_fcat3.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat3.<br />
&nbsp;&nbsp;gs_fcat3-fieldname&nbsp;=&nbsp;'BMSCH'.<br />
&nbsp;&nbsp;gs_fcat3-coltext&nbsp;=&nbsp;'공정&nbsp;생산&nbsp;수량'.<br />
&nbsp;&nbsp;gs_fcat3-outputlen&nbsp;&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;gs_fcat3-edit&nbsp;=&nbsp;iv_edit_flag.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat3&nbsp;TO&nbsp;gt_fcat3.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fcat3.<br />
&nbsp;&nbsp;gs_fcat3-fieldname&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;gs_fcat3-coltext&nbsp;=&nbsp;'단위'.<br />
&nbsp;&nbsp;gs_fcat3-outputlen&nbsp;&nbsp;=&nbsp;4.<br />
&nbsp;&nbsp;gs_fcat3-edit&nbsp;=&nbsp;iv_edit_flag.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fcat3&nbsp;TO&nbsp;gt_fcat3.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;set_alv_event_0100<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM set_alv_event_0100  USING io_alv_grid TYPE REF TO cl_gui_alv_grid.<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;lcl_event_handler=&gt;on_toolbar&nbsp;FOR&nbsp;io_alv_grid.<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;lcl_event_handler=&gt;on_user_command&nbsp;FOR&nbsp;io_alv_grid.<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;lcl_event_handler=&gt;on_data_changed&nbsp;FOR&nbsp;io_alv_grid.<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;lcl_event_handler=&gt;on_hotspot_click&nbsp;FOR&nbsp;io_alv_grid.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;assign_plpo_plnkn<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM assign_plpo_plnkn .<br />
&nbsp;&nbsp;"&nbsp;작업장&nbsp;변경&nbsp;추가에&nbsp;따른&nbsp;공정단계&nbsp;자동&nbsp;계산&nbsp;및&nbsp;부여<br />
&nbsp;&nbsp;DATA:&nbsp;lv_plnkn&nbsp;TYPE&nbsp;i&nbsp;VALUE&nbsp;10,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_idx&nbsp;&nbsp;&nbsp;TYPE&nbsp;sy-tabix.<br />
<br />
&nbsp;&nbsp;"&nbsp;삭제플레그&nbsp;없는&nbsp;값들만&nbsp;plko&nbsp;기준&nbsp;자동&nbsp;값&nbsp;반영.<br />
&nbsp;&nbsp;"&nbsp;공정번호에&nbsp;+10식&nbsp;자동부여<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_plpo&nbsp;INTO&nbsp;DATA(ls_plpo)&nbsp;WHERE&nbsp;lvorm&nbsp;=&nbsp;''.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;ls_plpo-plnkn.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_plpo-plnkn&nbsp;=&nbsp;lv_plnkn.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_plpo-plnnr&nbsp;=&nbsp;gv_hotspot_plnnr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_plpo-datub&nbsp;=&nbsp;gs_hotspot_plko-datub.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_plpo-datuv&nbsp;=&nbsp;gs_hotspot_plko-datuv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_plpo-bmsch&nbsp;=&nbsp;gs_hotspot_plko-bmsch.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_plpo-meins&nbsp;=&nbsp;gs_hotspot_plko-meins.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;gt_plpo&nbsp;FROM&nbsp;ls_plpo&nbsp;INDEX&nbsp;sy-tabix.<br />
&nbsp;&nbsp;&nbsp;&nbsp;lv_plnkn&nbsp;+=&nbsp;10.<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;reset_alv_fcat_0100<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM reset_alv_fcat_0100 .<br />
&nbsp;&nbsp;go_alv_gird-&gt;set_frontend_fieldcatalog(<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it_fieldcatalog&nbsp;=&nbsp;gt_fcat<br />
&nbsp;&nbsp;&nbsp;&nbsp;).<br />
<br />
&nbsp;&nbsp;go_alv_gird3-&gt;set_frontend_fieldcatalog(<br />
&nbsp;&nbsp;&nbsp;&nbsp;it_fieldcatalog&nbsp;=&nbsp;gt_fcat3<br />
&nbsp;&nbsp;).<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;alv_itab_change<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM alv_itab_change  USING io_alv_grid TYPE REF TO cl_gui_alv_grid.<br />
&nbsp;&nbsp;io_alv_grid-&gt;check_changed_data(&nbsp;).<br />
<br />
ENDFORM.<br />
            </div>
          </td>
        </tr>
      </table>
      </td>
      </tr>
   <tr>
<td class="footer">Extracted by Mass Download version 1.5.5 - E.G.Mellodew. 1998-2025. Sap Release 758</td>
   </tr>
</table>
</body>
</html>
